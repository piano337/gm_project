(function(){
'use strict';var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.getGlobal=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var n=0;n<e.length;++n){var H=e[n];if(H&&H.Math==Math)return H}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.checkEs6ConformanceViaProxy=function(){try{var e={},n=Object.create(new $jscomp.global.Proxy(e,{get:function(H,u,m){return H==e&&"q"==u&&m==n}}));return!0===n.q}catch(H){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.arrayIteratorImpl=function(e){var n=0;return function(){return n<e.length?{done:!1,value:e[n++]}:{done:!0}}};$jscomp.arrayIterator=function(e){return{next:$jscomp.arrayIteratorImpl(e)}};
$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(e,n,H){if(e==Array.prototype||e==Object.prototype)return e;e[n]=H.value;return e};
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(e,n){var H=$jscomp.propertyToPolyfillSymbol[n];if(null==H)return e[n];H=e[H];return void 0!==H?H:e[n]};
$jscomp.polyfill=function(e,n,H,u){n&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(e,n,H,u):$jscomp.polyfillUnisolated(e,n,H,u))};$jscomp.polyfillUnisolated=function(e,n,H,u){H=$jscomp.global;e=e.split(".");for(u=0;u<e.length-1;u++){var m=e[u];if(!(m in H))return;H=H[m]}e=e[e.length-1];u=H[e];n=n(u);n!=u&&null!=n&&$jscomp.defineProperty(H,e,{configurable:!0,writable:!0,value:n})};
$jscomp.polyfillIsolated=function(e,n,H,u){var m=e.split(".");e=1===m.length;u=m[0];u=!e&&u in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var r=0;r<m.length-1;r++){var p=m[r];if(!(p in u))return;u=u[p]}m=m[m.length-1];H=$jscomp.IS_SYMBOL_NATIVE&&"es6"===H?u[m]:null;n=n(H);null!=n&&(e?$jscomp.defineProperty($jscomp.polyfills,m,{configurable:!0,writable:!0,value:n}):n!==H&&(void 0===$jscomp.propertyToPolyfillSymbol[m]&&($jscomp.propertyToPolyfillSymbol[m]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(m):
$jscomp.POLYFILL_PREFIX+m),$jscomp.defineProperty(u,$jscomp.propertyToPolyfillSymbol[m],{configurable:!0,writable:!0,value:n})))};$jscomp.initSymbol=function(){};
$jscomp.polyfill("Symbol",function(e){if(e)return e;var n=function(m,r){this.$jscomp$symbol$id_=m;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:r})};n.prototype.toString=function(){return this.$jscomp$symbol$id_};var H=0,u=function(m){if(this instanceof u)throw new TypeError("Symbol is not a constructor");return new n("jscomp_symbol_"+(m||"")+"_"+H++,m)};return u},"es6","es3");
$jscomp.polyfill("Symbol.iterator",function(e){if(e)return e;e=Symbol("Symbol.iterator");for(var n="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),H=0;H<n.length;H++){var u=$jscomp.global[n[H]];"function"===typeof u&&"function"!=typeof u.prototype[e]&&$jscomp.defineProperty(u.prototype,e,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}})}return e},"es6",
"es3");$jscomp.iteratorPrototype=function(e){e={next:e};e[Symbol.iterator]=function(){return this};return e};$jscomp.makeIterator=function(e){var n="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];return n?n.call(e):$jscomp.arrayIterator(e)};$jscomp.owns=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)};
$jscomp.polyfill("WeakMap",function(e){function n(){if(!e||!Object.seal)return!1;try{var M=Object.seal({}),E=Object.seal({}),w=new e([[M,2],[E,3]]);if(2!=w.get(M)||3!=w.get(E))return!1;w.delete(M);w.set(E,4);return!w.has(M)&&4==w.get(E)}catch(N){return!1}}function H(){}function u(M){var E=typeof M;return"object"===E&&null!==M||"function"===E}function m(M){if(!$jscomp.owns(M,p)){var E=new H;$jscomp.defineProperty(M,p,{value:E})}}function r(M){if(!$jscomp.ISOLATE_POLYFILLS){var E=Object[M];E&&(Object[M]=
function(w){if(w instanceof H)return w;Object.isExtensible(w)&&m(w);return E(w)})}}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(e&&$jscomp.ES6_CONFORMANCE)return e}else if(n())return e;var p="$jscomp_hidden_"+Math.random();r("freeze");r("preventExtensions");r("seal");var G=0,v=function(M){this.id_=(G+=Math.random()+1).toString();if(M){M=$jscomp.makeIterator(M);for(var E;!(E=M.next()).done;)E=E.value,this.set(E[0],E[1])}};v.prototype.set=function(M,E){if(!u(M))throw Error("Invalid WeakMap key");
m(M);if(!$jscomp.owns(M,p))throw Error("WeakMap key fail: "+M);M[p][this.id_]=E;return this};v.prototype.get=function(M){return u(M)&&$jscomp.owns(M,p)?M[p][this.id_]:void 0};v.prototype.has=function(M){return u(M)&&$jscomp.owns(M,p)&&$jscomp.owns(M[p],this.id_)};v.prototype.delete=function(M){return u(M)&&$jscomp.owns(M,p)&&$jscomp.owns(M[p],this.id_)?delete M[p][this.id_]:!1};return v},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(e){function n(){if($jscomp.ASSUME_NO_NATIVE_MAP||!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var v=Object.seal({x:4}),M=new e($jscomp.makeIterator([[v,"s"]]));if("s"!=M.get(v)||1!=M.size||M.get({x:4})||M.set({x:4},"t")!=M||2!=M.size)return!1;var E=M.entries(),w=E.next();if(w.done||w.value[0]!=v||"s"!=w.value[1])return!1;w=E.next();return w.done||4!=w.value[0].x||"t"!=w.value[1]||!E.next().done?!1:!0}catch(N){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(e&&$jscomp.ES6_CONFORMANCE)return e}else if(n())return e;var H=new WeakMap,u=function(v){this.data_={};this.head_=p();this.size=0;if(v){v=$jscomp.makeIterator(v);for(var M;!(M=v.next()).done;)M=M.value,this.set(M[0],M[1])}};u.prototype.set=function(v,M){v=0===v?0:v;var E=m(this,v);E.list||(E.list=this.data_[E.id]=[]);E.entry?E.entry.value=M:(E.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:v,value:M},E.list.push(E.entry),
this.head_.previous.next=E.entry,this.head_.previous=E.entry,this.size++);return this};u.prototype.delete=function(v){v=m(this,v);return v.entry&&v.list?(v.list.splice(v.index,1),v.list.length||delete this.data_[v.id],v.entry.previous.next=v.entry.next,v.entry.next.previous=v.entry.previous,v.entry.head=null,this.size--,!0):!1};u.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=p();this.size=0};u.prototype.has=function(v){return!!m(this,v).entry};u.prototype.get=function(v){return(v=
m(this,v).entry)&&v.value};u.prototype.entries=function(){return r(this,function(v){return[v.key,v.value]})};u.prototype.keys=function(){return r(this,function(v){return v.key})};u.prototype.values=function(){return r(this,function(v){return v.value})};u.prototype.forEach=function(v,M){for(var E=this.entries(),w;!(w=E.next()).done;)w=w.value,v.call(M,w[1],w[0],this)};u.prototype[Symbol.iterator]=u.prototype.entries;var m=function(v,M){var E=M&&typeof M;"object"==E||"function"==E?H.has(M)?E=H.get(M):
(E=""+ ++G,H.set(M,E)):E="p_"+M;var w=v.data_[E];if(w&&$jscomp.owns(v.data_,E))for(v=0;v<w.length;v++){var N=w[v];if(M!==M&&N.key!==N.key||M===N.key)return{id:E,list:w,index:v,entry:N}}return{id:E,list:w,index:-1,entry:void 0}},r=function(v,M){var E=v.head_;return $jscomp.iteratorPrototype(function(){if(E){for(;E.head!=v.head_;)E=E.previous;for(;E.next!=E.head;)return E=E.next,{done:!1,value:M(E)};E=null}return{done:!0,value:void 0}})},p=function(){var v={};return v.previous=v.next=v.head=v},G=0;
return u},"es6","es3");$jscomp.polyfill("Number.isNaN",function(e){return e?e:function(n){return"number"===typeof n&&isNaN(n)}},"es6","es3");$jscomp.iteratorFromArray=function(e,n){e instanceof String&&(e+="");var H=0,u=!1,m={next:function(){if(!u&&H<e.length){var r=H++;return{value:n(r,e[r]),done:!1}}u=!0;return{done:!0,value:void 0}}};m[Symbol.iterator]=function(){return m};return m};
$jscomp.polyfill("Array.prototype.keys",function(e){return e?e:function(){return $jscomp.iteratorFromArray(this,function(n){return n})}},"es6","es3");
$jscomp.polyfill("Promise",function(e){function n(){this.batch_=null}function H(p){return p instanceof m?p:new m(function(G,v){G(p)})}if(e&&(!($jscomp.FORCE_POLYFILL_PROMISE||$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION&&"undefined"===typeof $jscomp.global.PromiseRejectionEvent)||!$jscomp.global.Promise||-1===$jscomp.global.Promise.toString().indexOf("[native code]")))return e;n.prototype.asyncExecute=function(p){if(null==this.batch_){this.batch_=[];var G=this;this.asyncExecuteFunction(function(){G.executeBatch_()})}this.batch_.push(p)};
var u=$jscomp.global.setTimeout;n.prototype.asyncExecuteFunction=function(p){u(p,0)};n.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var p=this.batch_;this.batch_=[];for(var G=0;G<p.length;++G){var v=p[G];p[G]=null;try{v()}catch(M){this.asyncThrow_(M)}}}this.batch_=null};n.prototype.asyncThrow_=function(p){this.asyncExecuteFunction(function(){throw p;})};var m=function(p){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];this.isRejectionHandled_=!1;var G=this.createResolveAndReject_();
try{p(G.resolve,G.reject)}catch(v){G.reject(v)}};m.prototype.createResolveAndReject_=function(){function p(M){return function(E){v||(v=!0,M.call(G,E))}}var G=this,v=!1;return{resolve:p(this.resolveTo_),reject:p(this.reject_)}};m.prototype.resolveTo_=function(p){if(p===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(p instanceof m)this.settleSameAsPromise_(p);else{a:switch(typeof p){case "object":var G=null!=p;break a;case "function":G=!0;break a;default:G=!1}G?this.resolveToNonPromiseObj_(p):
this.fulfill_(p)}};m.prototype.resolveToNonPromiseObj_=function(p){var G=void 0;try{G=p.then}catch(v){this.reject_(v);return}"function"==typeof G?this.settleSameAsThenable_(G,p):this.fulfill_(p)};m.prototype.reject_=function(p){this.settle_(2,p)};m.prototype.fulfill_=function(p){this.settle_(1,p)};m.prototype.settle_=function(p,G){if(0!=this.state_)throw Error("Cannot settle("+p+", "+G+"): Promise already settled in state"+this.state_);this.state_=p;this.result_=G;2===this.state_&&this.scheduleUnhandledRejectionCheck_();
this.executeOnSettledCallbacks_()};m.prototype.scheduleUnhandledRejectionCheck_=function(){var p=this;u(function(){if(p.notifyUnhandledRejection_()){var G=$jscomp.global.console;"undefined"!==typeof G&&G.error(p.result_)}},1)};m.prototype.notifyUnhandledRejection_=function(){if(this.isRejectionHandled_)return!1;var p=$jscomp.global.CustomEvent,G=$jscomp.global.Event,v=$jscomp.global.dispatchEvent;if("undefined"===typeof v)return!0;"function"===typeof p?p=new p("unhandledrejection",{cancelable:!0}):
"function"===typeof G?p=new G("unhandledrejection",{cancelable:!0}):(p=$jscomp.global.document.createEvent("CustomEvent"),p.initCustomEvent("unhandledrejection",!1,!0,p));p.promise=this;p.reason=this.result_;return v(p)};m.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var p=0;p<this.onSettledCallbacks_.length;++p)r.asyncExecute(this.onSettledCallbacks_[p]);this.onSettledCallbacks_=null}};var r=new n;m.prototype.settleSameAsPromise_=function(p){var G=this.createResolveAndReject_();
p.callWhenSettled_(G.resolve,G.reject)};m.prototype.settleSameAsThenable_=function(p,G){var v=this.createResolveAndReject_();try{p.call(G,v.resolve,v.reject)}catch(M){v.reject(M)}};m.prototype.then=function(p,G){function v(N,R){return"function"==typeof N?function(I){try{M(N(I))}catch(B){E(B)}}:R}var M,E,w=new m(function(N,R){M=N;E=R});this.callWhenSettled_(v(p,M),v(G,E));return w};m.prototype.catch=function(p){return this.then(void 0,p)};m.prototype.callWhenSettled_=function(p,G){function v(){switch(M.state_){case 1:p(M.result_);
break;case 2:G(M.result_);break;default:throw Error("Unexpected state: "+M.state_);}}var M=this;null==this.onSettledCallbacks_?r.asyncExecute(v):this.onSettledCallbacks_.push(v);this.isRejectionHandled_=!0};m.resolve=H;m.reject=function(p){return new m(function(G,v){v(p)})};m.race=function(p){return new m(function(G,v){for(var M=$jscomp.makeIterator(p),E=M.next();!E.done;E=M.next())H(E.value).callWhenSettled_(G,v)})};m.all=function(p){var G=$jscomp.makeIterator(p),v=G.next();return v.done?H([]):new m(function(M,
E){function w(I){return function(B){N[I]=B;R--;0==R&&M(N)}}var N=[],R=0;do N.push(void 0),R++,H(v.value).callWhenSettled_(w(N.length-1),E),v=G.next();while(!v.done)})};return m},"es6","es3");
$jscomp.polyfill("Set",function(e){function n(){if($jscomp.ASSUME_NO_NATIVE_SET||!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var u=Object.seal({x:4}),m=new e($jscomp.makeIterator([u]));if(!m.has(u)||1!=m.size||m.add(u)!=m||1!=m.size||m.add({x:4})!=m||2!=m.size)return!1;var r=m.entries(),p=r.next();if(p.done||p.value[0]!=u||p.value[1]!=u)return!1;p=r.next();return p.done||p.value[0]==u||4!=p.value[0].x||p.value[1]!=p.value[0]?!1:r.next().done}catch(G){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(e&&$jscomp.ES6_CONFORMANCE)return e}else if(n())return e;var H=function(u){this.map_=new Map;if(u){u=$jscomp.makeIterator(u);for(var m;!(m=u.next()).done;)this.add(m.value)}this.size=this.map_.size};H.prototype.add=function(u){u=0===u?0:u;this.map_.set(u,u);this.size=this.map_.size;return this};H.prototype.delete=function(u){u=this.map_.delete(u);this.size=this.map_.size;return u};H.prototype.clear=function(){this.map_.clear();this.size=0};H.prototype.has=
function(u){return this.map_.has(u)};H.prototype.entries=function(){return this.map_.entries()};H.prototype.values=function(){return this.map_.values()};H.prototype.keys=H.prototype.values;H.prototype[Symbol.iterator]=H.prototype.values;H.prototype.forEach=function(u,m){var r=this;this.map_.forEach(function(p){return u.call(m,p,p,r)})};return H},"es6","es3");
$jscomp.polyfill("Array.prototype.values",function(e){return e?e:function(){return $jscomp.iteratorFromArray(this,function(n,H){return H})}},"es8","es3");
var coerce={toList:function(e,n){n=void 0===n?null:n;return"list"!==e.ctype?(console.log("argument is not a list"),n):e.value},toHomog:function(e,n,H){n=void 0===n?[0,0,0,0]:n;H=void 0===H?3:H;e=coerce.toList(e);if(null===e)return n;n=e.map(coerce.toReal);n.length>H+1&&(console.log("Coordinate vector too long."),n=n.slice(0,H+1));for(;n.length<H;)n.push(0);n.length===H&&n.push(1);return n},toDirection:function(e,n){n=void 0===n?[0,0,0]:n;e=coerce.toList(e);if(null===e)return n;n=e.map(coerce.toReal);
3<n.length&&(console.log("Coordinate vector too long."),n=n.slice(0,3));for(;3>n.length;)n.push(0);return n},toDirectionPoint:function(e,n){n=void 0===n?[0,0,0,0]:n;e=coerce.toDirection(e,n);e!==n&&(e[3]=0);return e},toColor:function(e,n){n=void 0===n?[.5,.5,.5]:n;if("number"===e.ctype){var H=coerce.toInterval(0,1,e);if(!isNaN(H))return[H,H,H]}e=coerce.toList(e);return null===e?n:3!=e.length?(console.log("Not an RGB color vector"),n):e.map(function(u){return coerce.toInterval(0,1,u)})},toReal:function(e,
n){n=void 0===n?Number.NaN:n;if("number"!==e.ctype)return console.log("argument is not a number"),n;e=e.value;n=e.real;0!==e.imag&&console.log("complex number is not real");return n},toInt:function(e,n){n=void 0===n?Number.NaN:n;if("number"!==e.ctype)return console.log("argument is not a number"),n;n=e.value;e=n.real;n=n.imag;0!==n&&console.log("complex number is not real");n=Math.round(e);n!==e&&console.log("number is not an integer");return n},clamp:function(e,n,H){return H<e?e:H>n?n:H},toInterval:function(e,
n,H,u){u=void 0===u?Number.NaN:u;return coerce.clamp(e,n,coerce.toReal(H,u))},toString:function(e,n){n=void 0===n?null:n;if("string"===e.ctype)return e.value;console.log("argument is not a string");return n},toEnum:function(e,n,H){H=void 0===H?null:H;n=coerce.toString(n,H);if(n!==H&&-1!==e.indexOf(n))return n;console.log("argument is not one of "+e.join(", "));return H},toBool:function(e,n){if("boolean"===e.ctype)return e.value;console.log("argument is not boolean");return n}};function norm3(e){var n=e[0],H=e[1];e=e[2];return Math.sqrt(n*n+H*H+e*e)}function normalized3(e){var n=e[0],H=e[1];e=e[2];var u=1/Math.sqrt(n*n+H*H+e*e);return[u*n,u*H,u*e]}function dehom3(e){var n=1/e[3];return[n*e[0],n*e[1],n*e[2]]}function scale3(e,n){return[e*n[0],e*n[1],e*n[2]]}function transpose3(e){return[e[0],e[3],e[6],e[1],e[4],e[7],e[2],e[5],e[8]]}function transpose4(e){return[e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14],e[3],e[7],e[11],e[15]]}
function adj3(e){return[e[4]*e[8]-e[5]*e[7],e[2]*e[7]-e[1]*e[8],e[1]*e[5]-e[2]*e[4],e[5]*e[6]-e[3]*e[8],e[0]*e[8]-e[2]*e[6],e[2]*e[3]-e[0]*e[5],e[3]*e[7]-e[4]*e[6],e[1]*e[6]-e[0]*e[7],e[0]*e[4]-e[1]*e[3]]}function sub3(e,n){return[e[0]-n[0],e[1]-n[1],e[2]-n[2]]}function add3(e,n){return[e[0]+n[0],e[1]+n[1],e[2]+n[2]]}function add4(e,n){return[e[0]+n[0],e[1]+n[1],e[2]+n[2],e[3]+n[3]]}function cross3(e,n){return[e[1]*n[2]-e[2]*n[1],e[2]*n[0]-e[0]*n[2],e[0]*n[1]-e[1]*n[0]]}
function mul4mm(e,n){return[e[0]*n[0]+e[1]*n[4]+e[2]*n[8]+e[3]*n[12],e[0]*n[1]+e[1]*n[5]+e[2]*n[9]+e[3]*n[13],e[0]*n[2]+e[1]*n[6]+e[2]*n[10]+e[3]*n[14],e[0]*n[3]+e[1]*n[7]+e[2]*n[11]+e[3]*n[15],e[4]*n[0]+e[5]*n[4]+e[6]*n[8]+e[7]*n[12],e[4]*n[1]+e[5]*n[5]+e[6]*n[9]+e[7]*n[13],e[4]*n[2]+e[5]*n[6]+e[6]*n[10]+e[7]*n[14],e[4]*n[3]+e[5]*n[7]+e[6]*n[11]+e[7]*n[15],e[8]*n[0]+e[9]*n[4]+e[10]*n[8]+e[11]*n[12],e[8]*n[1]+e[9]*n[5]+e[10]*n[9]+e[11]*n[13],e[8]*n[2]+e[9]*n[6]+e[10]*n[10]+e[11]*n[14],e[8]*n[3]+e[9]*
n[7]+e[10]*n[11]+e[11]*n[15],e[12]*n[0]+e[13]*n[4]+e[14]*n[8]+e[15]*n[12],e[12]*n[1]+e[13]*n[5]+e[14]*n[9]+e[15]*n[13],e[12]*n[2]+e[13]*n[6]+e[14]*n[10]+e[15]*n[14],e[12]*n[3]+e[13]*n[7]+e[14]*n[11]+e[15]*n[15]]}function mul3mv(e,n){return[e[0]*n[0]+e[1]*n[1]+e[2]*n[2],e[3]*n[0]+e[4]*n[1]+e[5]*n[2],e[6]*n[0]+e[7]*n[1]+e[8]*n[2]]}
function mul4mv(e,n){return[e[0]*n[0]+e[1]*n[1]+e[2]*n[2]+e[3]*n[3],e[4]*n[0]+e[5]*n[1]+e[6]*n[2]+e[7]*n[3],e[8]*n[0]+e[9]*n[1]+e[10]*n[2]+e[11]*n[3],e[12]*n[0]+e[13]*n[1]+e[14]*n[2]+e[15]*n[3]]}function transform4to3(e,n){var H=1/(e[12]*n[0]+e[13]*n[1]+e[14]*n[2]+e[15]*n[3]);return[(e[0]*n[0]+e[1]*n[1]+e[2]*n[2]+e[3]*n[3])*H,(e[4]*n[0]+e[5]*n[1]+e[6]*n[2]+e[7]*n[3])*H,(e[8]*n[0]+e[9]*n[1]+e[10]*n[2]+e[11]*n[3])*H]}
function triangleNormal(e,n,H){e=dehom3(e);n=sub3(dehom3(n),e);H=sub3(dehom3(H),e);return normalized3(cross3(n,H))};function nestedArrayToCSList(e){return Array.isArray(e)?{ctype:"list",value:e.map(function(n){return nestedArrayToCSList(n)})}:{ctype:"number",value:{real:e,imag:0}}}
function convertObjectToCindyDict(e,n,H){if(e instanceof Object&&H.has(e))return H.get(e);if(Array.isArray(e)){var u=[];e.forEach(function(v){v=convertObjectToCindyDict(v,n,H);null!=v&&u.push(v)});return{ctype:"list",value:u}}if("string"===typeof e||e instanceof String)return{ctype:"string",value:e};if("number"===typeof e&&isFinite(e))return{ctype:"number",value:{real:e,imag:0}};if("boolean"===typeof e)return{ctype:"boolean",value:e};if(null===e||"undefined"===typeof e||"function"===typeof e)return null;
var m={},r=new Map(H);r.set(e,m);for(var p in e)if(!n.has(p)&&e.hasOwnProperty(p)){var G=convertObjectToCindyDict(e[p],n,r);m[p]=G}return{ctype:"JSON",value:m}};(function(e){"object"===typeof exports&&"undefined"!==typeof module?module.exports=e():"function"===typeof define&&define.amd?define([],e):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).Leap=e()})(function(){return function(){function e(n,H,u){function m(G,v){if(!H[G]){if(!n[G]){var M="function"==typeof require&&require;if(!v&&M)return M(G,!0);if(r)return r(G,!0);v=Error("Cannot find module '"+G+"'");throw v.code="MODULE_NOT_FOUND",v;}v=
H[G]={exports:{}};n[G][0].call(v.exports,function(E){return m(n[G][1][E]||E)},v,v.exports,e,n,H,u)}return H[G].exports}for(var r="function"==typeof require&&require,p=0;p<u.length;p++)m(u[p]);return m}return e}()({1:[function(e,n,H){function u(){u.init.call(this)}function m(a){if("function"!==typeof a)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof a);}function r(a,b,d,f){m(d);var g=a._events;if(void 0===g)g=a._events=Object.create(null),a._eventsCount=
0;else{void 0!==g.newListener&&(a.emit("newListener",b,d.listener?d.listener:d),g=a._events);var l=g[b]}void 0===l?(g[b]=d,++a._eventsCount):("function"===typeof l?l=g[b]=f?[d,l]:[l,d]:f?l.unshift(d):l.push(d),d=void 0===a._maxListeners?u.defaultMaxListeners:a._maxListeners,0<d&&l.length>d&&!l.warned&&(l.warned=!0,d=Error("Possible EventEmitter memory leak detected. "+l.length+" "+String(b)+" listeners added. Use emitter.setMaxListeners() to increase limit"),d.name="MaxListenersExceededWarning",d.emitter=
a,d.type=b,d.count=l.length,console&&console.warn&&console.warn(d)));return a}function p(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function G(a,b,d){a={fired:!1,wrapFn:void 0,target:a,type:b,listener:d};b=p.bind(a);b.listener=d;return a.wrapFn=b}function v(a,b,d){a=a._events;if(void 0===a)return[];b=a[b];if(void 0===b)return[];if("function"===typeof b)return d?
[b.listener||b]:[b];if(d)for(d=Array(b.length),a=0;a<d.length;++a)d[a]=b[a].listener||b[a];else d=E(b,b.length);return d}function M(a){var b=this._events;if(void 0!==b){a=b[a];if("function"===typeof a)return 1;if(void 0!==a)return a.length}return 0}function E(a,b){for(var d=Array(b),f=0;f<b;++f)d[f]=a[f];return d}function w(a,b,d){"function"===typeof a.on&&N(a,"error",b,d)}function N(a,b,d,f){if("function"===typeof a.on)if(f.once)a.once(b,d);else a.on(b,d);else if("function"===typeof a.addEventListener)a.addEventListener(b,
function A(l){f.once&&a.removeEventListener(b,A);d(l)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof a);}var R=(e="object"===typeof Reflect?Reflect:null)&&"function"===typeof e.apply?e.apply:function(a,b,d){return Function.prototype.apply.call(a,b,d)};var I=e&&"function"===typeof e.ownKeys?e.ownKeys:Object.getOwnPropertySymbols?function(a){return Object.getOwnPropertyNames(a).concat(Object.getOwnPropertySymbols(a))}:function(a){return Object.getOwnPropertyNames(a)};
var B=Number.isNaN||function(a){return a!==a};n.exports=u;n.exports.once=function(a,b){return new Promise(function(d,f){function g(A){a.removeListener(b,l);f(A)}function l(){"function"===typeof a.removeListener&&a.removeListener("error",g);d([].slice.call(arguments))}N(a,b,l,{once:!0});"error"!==b&&w(a,g,{once:!0})})};u.EventEmitter=u;u.prototype._events=void 0;u.prototype._eventsCount=0;u.prototype._maxListeners=void 0;var c=10;Object.defineProperty(u,"defaultMaxListeners",{enumerable:!0,get:function(){return c},
set:function(a){if("number"!==typeof a||0>a||B(a))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+a+".");c=a}});u.init=function(){if(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)this._events=Object.create(null),this._eventsCount=0;this._maxListeners=this._maxListeners||void 0};u.prototype.setMaxListeners=function(a){if("number"!==typeof a||0>a||B(a))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+
a+".");this._maxListeners=a;return this};u.prototype.getMaxListeners=function(){return void 0===this._maxListeners?u.defaultMaxListeners:this._maxListeners};u.prototype.emit=function(a){for(var b=[],d=1;d<arguments.length;d++)b.push(arguments[d]);d="error"===a;var f=this._events;if(void 0!==f)d=d&&void 0===f.error;else if(!d)return!1;if(d){var g;0<b.length&&(g=b[0]);if(g instanceof Error)throw g;b=Error("Unhandled error."+(g?" ("+g.message+")":""));b.context=g;throw b;}d=f[a];if(void 0===d)return!1;
if("function"===typeof d)R(d,this,b);else for(g=d.length,f=E(d,g),d=0;d<g;++d)R(f[d],this,b);return!0};u.prototype.addListener=function(a,b){return r(this,a,b,!1)};u.prototype.on=u.prototype.addListener;u.prototype.prependListener=function(a,b){return r(this,a,b,!0)};u.prototype.once=function(a,b){m(b);this.on(a,G(this,a,b));return this};u.prototype.prependOnceListener=function(a,b){m(b);this.prependListener(a,G(this,a,b));return this};u.prototype.removeListener=function(a,b){var d;m(b);var f=this._events;
if(void 0===f)return this;var g=f[a];if(void 0===g)return this;if(g===b||g.listener===b)0===--this._eventsCount?this._events=Object.create(null):(delete f[a],f.removeListener&&this.emit("removeListener",a,g.listener||b));else if("function"!==typeof g){var l=-1;for(d=g.length-1;0<=d;d--)if(g[d]===b||g[d].listener===b){var A=g[d].listener;l=d;break}if(0>l)return this;if(0===l)g.shift();else{for(;l+1<g.length;l++)g[l]=g[l+1];g.pop()}1===g.length&&(f[a]=g[0]);void 0!==f.removeListener&&this.emit("removeListener",
a,A||b)}return this};u.prototype.off=u.prototype.removeListener;u.prototype.removeAllListeners=function(a){var b=this._events;if(void 0===b)return this;if(void 0===b.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==b[a]&&(0===--this._eventsCount?this._events=Object.create(null):delete b[a]),this;if(0===arguments.length){var d=Object.keys(b);for(b=0;b<d.length;++b){var f=d[b];"removeListener"!==f&&this.removeAllListeners(f)}this.removeAllListeners("removeListener");
this._events=Object.create(null);this._eventsCount=0;return this}d=b[a];if("function"===typeof d)this.removeListener(a,d);else if(void 0!==d)for(b=d.length-1;0<=b;b--)this.removeListener(a,d[b]);return this};u.prototype.listeners=function(a){return v(this,a,!0)};u.prototype.rawListeners=function(a){return v(this,a,!1)};u.listenerCount=function(a,b){return"function"===typeof a.listenerCount?a.listenerCount(b):M.call(a,b)};u.prototype.listenerCount=M;u.prototype.eventNames=function(){return 0<this._eventsCount?
I(this._events):[]}},{}],2:[function(e,n,H){e("./pointable");H=e("gl-matrix");var u=H.vec3,m=H.mat3,r=H.mat4;e("underscore");e=n.exports=function(p,G){this.finger=p;this._matrix=this._center=null;this.type=G.type;this.prevJoint=G.prevJoint;this.nextJoint=G.nextJoint;this.width=G.width;p=Array(3);u.sub(p,G.nextJoint,G.prevJoint);this.length=u.length(p);this.basis=G.basis};e.prototype.left=function(){return this._left?this._left:this._left=0>m.determinant(this.basis[0].concat(this.basis[1]).concat(this.basis[2]))};
e.prototype.matrix=function(){if(this._matrix)return this._matrix;var p=this.basis,G=this._matrix=r.create();G[0]=p[0][0];G[1]=p[0][1];G[2]=p[0][2];G[4]=p[1][0];G[5]=p[1][1];G[6]=p[1][2];G[8]=p[2][0];G[9]=p[2][1];G[10]=p[2][2];G[3]=this.center()[0];G[7]=this.center()[1];G[11]=this.center()[2];this.left()&&(G[0]*=-1,G[1]*=-1,G[2]*=-1);return this._matrix};e.prototype.lerp=function(p,G){u.lerp(p,this.prevJoint,this.nextJoint,G)};e.prototype.center=function(){if(this._center)return this._center;var p=
u.create();this.lerp(p,.5);return this._center=p};e.prototype.direction=function(){return[-1*this.basis[2][0],-1*this.basis[2][1],-1*this.basis[2][2]]}},{"./pointable":16,"gl-matrix":22,underscore:24}],3:[function(e,n,H){e=n.exports=function(u){this.pos=0;this._buf=[];this.size=u};e.prototype.get=function(u){void 0==u&&(u=0);if(!(u>=this.size||u>=this._buf.length))return this._buf[(this.pos-u-1)%this.size]};e.prototype.push=function(u){this._buf[this.pos%this.size]=u;return this.pos++}},{}],4:[function(e,
n,H){var u=e("../protocol").chooseProtocol;H=e("events").EventEmitter;var m=e("underscore"),r=n.exports=function(p){this.opts=m.defaults(p||{},{host:"127.0.0.1",enableGestures:!1,scheme:this.getScheme(),port:this.getPort(),background:!1,optimizeHMD:!1,requestProtocolVersion:r.defaultProtocolVersion});this.host=this.opts.host;this.port=this.opts.port;this.scheme=this.opts.scheme;this.protocolVersionVerified=!1;this.optimizeHMD=this.background=null;this.on("ready",function(){this.enableGestures(this.opts.enableGestures);
this.setBackground(this.opts.background);this.setOptimizeHMD(this.opts.optimizeHMD);this.opts.optimizeHMD?console.log("Optimized for head mounted display usage."):console.log("Optimized for desktop usage.")})};r.defaultProtocolVersion=6;r.prototype.getUrl=function(){return this.scheme+"//"+this.host+":"+this.port+"/v"+this.opts.requestProtocolVersion+".json"};r.prototype.getScheme=function(){return"ws:"};r.prototype.getPort=function(){return 6437};r.prototype.setBackground=function(p){this.opts.background=
p;this.protocol&&this.protocol.sendBackground&&this.background!==this.opts.background&&(this.background=this.opts.background,this.protocol.sendBackground(this,this.opts.background))};r.prototype.setOptimizeHMD=function(p){this.opts.optimizeHMD=p;this.protocol&&this.protocol.sendOptimizeHMD&&this.optimizeHMD!==this.opts.optimizeHMD&&(this.optimizeHMD=this.opts.optimizeHMD,this.protocol.sendOptimizeHMD(this,this.opts.optimizeHMD))};r.prototype.handleOpen=function(){this.connected||(this.connected=!0,
this.emit("connect"))};r.prototype.enableGestures=function(p){this.gesturesEnabled=p?!0:!1;this.send(this.protocol.encode({enableGestures:this.gesturesEnabled}))};r.prototype.handleClose=function(p,G){this.connected&&(this.disconnect(),1001===p&&1<this.opts.requestProtocolVersion&&(this.protocolVersionVerified?this.protocolVersionVerified=!1:this.opts.requestProtocolVersion--),this.startReconnection())};r.prototype.startReconnection=function(){var p=this;this.reconnectionTimer||(this.reconnectionTimer=
setInterval(function(){p.reconnect()},500))};r.prototype.stopReconnection=function(){this.reconnectionTimer=clearInterval(this.reconnectionTimer)};r.prototype.disconnect=function(p){p||this.stopReconnection();if(this.socket)return this.socket.close(),delete this.socket,delete this.protocol,delete this.background,delete this.optimizeHMD,delete this.focusedState,this.connected&&(this.connected=!1,this.emit("disconnect")),!0};r.prototype.reconnect=function(){this.connected?this.stopReconnection():(this.disconnect(!0),
this.connect())};r.prototype.handleData=function(p){p=JSON.parse(p);void 0===this.protocol?(p=this.protocol=u(p),this.protocolVersionVerified=!0,this.emit("ready")):p=this.protocol(p);this.emit(p.type,p)};r.prototype.connect=function(){if(!this.socket)return this.socket=this.setupSocket(),!0};r.prototype.send=function(p){this.socket.send(p)};r.prototype.reportFocus=function(p){this.connected&&this.focusedState!==p&&(this.focusedState=p,this.emit(this.focusedState?"focus":"blur"),this.protocol&&this.protocol.sendFocused&&
this.protocol.sendFocused(this,this.focusedState))};m.extend(r.prototype,H.prototype)},{"../protocol":17,events:1,underscore:24}],5:[function(e,n,H){var u=n.exports=e("./base");e=e("underscore");n=n.exports=function(m){u.call(this,m);var r=this;this.on("ready",function(){r.startFocusLoop()});this.on("disconnect",function(){r.stopFocusLoop()})};e.extend(n.prototype,u.prototype);n.__proto__=u;n.prototype.useSecure=function(){return"https:"===location.protocol};n.prototype.getScheme=function(){return this.useSecure()?
"wss:":"ws:"};n.prototype.getPort=function(){return this.useSecure()?6436:6437};n.prototype.setupSocket=function(){var m=this,r=new WebSocket(this.getUrl());r.onopen=function(){m.handleOpen()};r.onclose=function(p){m.handleClose(p.code,p.reason)};r.onmessage=function(p){m.handleData(p.data)};r.onerror=function(p){m.useSecure()&&"wss:"===m.scheme&&(m.scheme="ws:",m.port=6437,m.disconnect(),m.connect())};return r};n.prototype.startFocusLoop=function(){if(!this.focusDetectorTimer){var m=this,r=null;
r="undefined"!==typeof document.hidden?"hidden":"undefined"!==typeof document.mozHidden?"mozHidden":"undefined"!==typeof document.msHidden?"msHidden":"undefined"!==typeof document.webkitHidden?"webkitHidden":void 0;void 0===m.windowVisible&&(m.windowVisible=void 0===r?!0:!1===document[r]);var p=window.addEventListener("focus",function(M){m.windowVisible=!0;v()}),G=window.addEventListener("blur",function(M){m.windowVisible=!1;v()});this.on("disconnect",function(){window.removeEventListener("focus",
p);window.removeEventListener("blur",G)});var v=function(){m.reportFocus((void 0===r?!0:!1===document[r])&&m.windowVisible)};v();this.focusDetectorTimer=setInterval(v,100)}};n.prototype.stopFocusLoop=function(){this.focusDetectorTimer&&(clearTimeout(this.focusDetectorTimer),delete this.focusDetectorTimer)}},{"./base":4,underscore:24}],6:[function(e,n,H){var u=e("ws"),m=e("./base");e=e("underscore");n=n.exports=function(r){m.call(this,r);var p=this;this.on("ready",function(){p.reportFocus(!0)})};e.extend(n.prototype,
m.prototype);n.__proto__=m;n.prototype.setupSocket=function(){var r=this,p=new u(this.getUrl());p.on("open",function(){r.handleOpen()});p.on("message",function(G){r.handleData(G)});p.on("close",function(G,v){r.handleClose(G,v)});p.on("error",function(){r.startReconnection()});return p}},{"./base":4,underscore:24,ws:25}],7:[function(e,n,H){(function(u){(function(){var m=e("./frame"),r=e("./hand"),p=e("./pointable"),G=e("./finger"),v=e("./circular_buffer"),M=e("./pipeline"),E=e("events").EventEmitter,
w=e("./gesture").gestureListener,N=e("./dialog"),R=e("underscore"),I=n.exports=function(B){var c=this;B=R.defaults(B||{},{inNode:"undefined"!==typeof u&&u.versions&&u.versions.node});this.inNode=B.inNode;B=R.defaults(B||{},{frameEventName:this.useAnimationLoop()?"animationFrame":"deviceFrame",suppressAnimationLoop:!this.useAnimationLoop(),loopWhileDisconnected:!0,useAllPlugins:!1,checkVersion:!0});this.animationFrameRequested=!1;this.onAnimationFrame=function(a){c.lastConnectionFrame.valid&&c.emit("animationFrame",
c.lastConnectionFrame);c.emit("frameEnd",a);c.loopWhileDisconnected&&(!1!==c.connection.focusedState||c.connection.opts.background)?window.requestAnimationFrame(c.onAnimationFrame):c.animationFrameRequested=!1};this.suppressAnimationLoop=B.suppressAnimationLoop;this.loopWhileDisconnected=B.loopWhileDisconnected;this.frameEventName=B.frameEventName;this.useAllPlugins=B.useAllPlugins;this.history=new v(200);this.lastConnectionFrame=this.lastValidFrame=this.lastFrame=m.Invalid;this.accumulatedGestures=
[];this.checkVersion=B.checkVersion;this.connectionType=void 0===B.connectionType?this.inBrowser()?e("./connection/browser"):e("./connection/node"):B.connectionType;this.connection=new this.connectionType(B);this.streamingCount=0;this.devices={};this.plugins={};this._pluginPipelineSteps={};this._pluginExtendedMethods={};B.useAllPlugins&&this.useRegisteredPlugins();this.setupFrameEvents(B);this.setupConnectionEvents();this.startAnimationLoop()};I.prototype.gesture=function(B,c){B=w(this,B);void 0!==
c&&B.stop(c);return B};I.prototype.setBackground=function(B){this.connection.setBackground(B);return this};I.prototype.setOptimizeHMD=function(B){this.connection.setOptimizeHMD(B);return this};I.prototype.inBrowser=function(){return!this.inNode};I.prototype.useAnimationLoop=function(){return this.inBrowser()&&!this.inBackgroundPage()};I.prototype.inBackgroundPage=function(){return"undefined"!==typeof chrome&&chrome.extension&&chrome.extension.getBackgroundPage&&chrome.extension.getBackgroundPage()===
window};I.prototype.connect=function(){this.connection.connect();return this};I.prototype.streaming=function(){return 0<this.streamingCount};I.prototype.connected=function(){return!!this.connection.connected};I.prototype.startAnimationLoop=function(){this.suppressAnimationLoop||this.animationFrameRequested||(this.animationFrameRequested=!0,window.requestAnimationFrame(this.onAnimationFrame))};I.prototype.disconnect=function(){this.connection.disconnect();return this};I.prototype.frame=function(B){return this.history.get(B)||
m.Invalid};I.prototype.loop=function(B){if(B)if("function"===typeof B)this.on(this.frameEventName,B);else this.setupFrameEvents(B);return this.connect()};I.prototype.addStep=function(B){this.pipeline||(this.pipeline=new M(this));this.pipeline.addStep(B)};I.prototype.processFrame=function(B){B.gestures&&(this.accumulatedGestures=this.accumulatedGestures.concat(B.gestures));this.lastConnectionFrame=B;this.startAnimationLoop();this.emit("deviceFrame",B)};I.prototype.processFinishedFrame=function(B){this.lastFrame=
B;B.valid&&(this.lastValidFrame=B);B.controller=this;B.historyIdx=this.history.push(B);if(B.gestures){B.gestures=this.accumulatedGestures;this.accumulatedGestures=[];for(var c=0;c!=B.gestures.length;c++)this.emit("gesture",B.gestures[c],B)}this.pipeline&&(B=this.pipeline.run(B),B||(B=m.Invalid));this.emit("frame",B);this.emitHandEvents(B)};I.prototype.emitHandEvents=function(B){for(var c=0;c<B.hands.length;c++)this.emit("hand",B.hands[c])};I.prototype.setupFrameEvents=function(B){if(B.frame)this.on("frame",
B.frame);if(B.hand)this.on("hand",B.hand)};I.prototype.setupConnectionEvents=function(){var B=this;this.connection.on("frame",function(b){B.processFrame(b)});this.on(this.frameEventName,function(b){B.processFinishedFrame(b)});var c=function(){if(5>B.connection.opts.requestProtocolVersion&&0==B.streamingCount){B.streamingCount=1;var b={attached:!0,streaming:!0,type:"unknown",id:"Lx00000000000"};B.devices[b.id]=b;B.emit("deviceAttached",b);B.emit("deviceStreaming",b);B.emit("streamingStarted",b);B.connection.removeListener("frame",
c)}},a=function(){if(0<B.streamingCount){for(var b in B.devices)B.emit("deviceStopped",B.devices[b]),B.emit("deviceRemoved",B.devices[b]);B.emit("streamingStopped",B.devices[b]);B.streamingCount=0;for(b in B.devices)delete B.devices[b]}};this.connection.on("focus",function(){B.loopWhileDisconnected&&B.startAnimationLoop();B.emit("focus")});this.connection.on("blur",function(){B.emit("blur")});this.connection.on("protocol",function(b){b.on("beforeFrameCreated",function(d){B.emit("beforeFrameCreated",
d)});b.on("afterFrameCreated",function(d,f){B.emit("afterFrameCreated",d,f)});B.emit("protocol",b)});this.connection.on("ready",function(){B.checkVersion&&!B.inNode&&B.checkOutOfDate();B.emit("ready")});this.connection.on("connect",function(){B.emit("connect");B.connection.removeListener("frame",c);B.connection.on("frame",c)});this.connection.on("disconnect",function(){B.emit("disconnect");a()});this.connection.on("deviceConnect",function(b){b.state?(B.emit("deviceConnected"),B.connection.removeListener("frame",
c),B.connection.on("frame",c)):(B.emit("deviceDisconnected"),a())});this.connection.on("deviceEvent",function(b){b=b.state;var d=B.devices[b.id],f={},g;for(g in b)d&&d.hasOwnProperty(g)&&d[g]==b[g]||(f[g]=!0);B.devices[b.id]=b;f.attached&&B.emit(b.attached?"deviceAttached":"deviceRemoved",b);f.streaming&&(b.streaming?(B.streamingCount++,B.emit("deviceStreaming",b),1==B.streamingCount&&B.emit("streamingStarted",b),f.attached||B.emit("deviceConnected")):f.attached&&b.attached||(B.streamingCount--,B.emit("deviceStopped",
b),0==B.streamingCount&&B.emit("streamingStopped",b),B.emit("deviceDisconnected")))});this.on("newListener",function(b,d){"deviceConnected"!=b&&"deviceDisconnected"!=b||console.warn(b+" events are depricated.  Consider using 'streamingStarted/streamingStopped' or 'deviceStreaming/deviceStopped' instead")})};I.prototype.checkOutOfDate=function(){console.assert(this.connection&&this.connection.protocol);var B=this.connection.protocol.serviceVersion,c=this.connection.protocol.version,a=this.connectionType.defaultProtocolVersion;
return a>c?(console.warn("Your Protocol Version is v"+c+", this app was designed for v"+a),N.warnOutOfDate({sV:B,pV:c}),!0):!1};I._pluginFactories={};I.plugin=function(B,c){this._pluginFactories[B]&&console.warn('Plugin "'+B+'" already registered');return this._pluginFactories[B]=c};I.plugins=function(){return R.keys(this._pluginFactories)};I.prototype.use=function(B,c){var a;var b="function"==typeof B?B:I._pluginFactories[B];if(!b)throw"Leap Plugin "+B+" not found.";c||(c={});if(this.plugins[B])return R.extend(this.plugins[B],
c),this;this.plugins[B]=c;c=b.call(this,c);for(a in c)if(b=c[a],"function"===typeof b){var d=B,f=a;if(-1!=["beforeFrameCreated","afterFrameCreated"].indexOf(f))this.on(f,b);else this.pipeline||(this.pipeline=new M(this)),this._pluginPipelineSteps[d]||(this._pluginPipelineSteps[d]=[]),this._pluginPipelineSteps[d].push(this.pipeline.addWrappedStep(f,b))}else{d=B;f=a;this._pluginExtendedMethods[d]||(this._pluginExtendedMethods[d]=[]);switch(f){case "frame":f=m;break;case "hand":f=r;break;case "pointable":f=
p;R.extend(G.prototype,b);R.extend(G.Invalid,b);break;case "finger":f=G;break;default:throw d+' specifies invalid object type "'+f+'" for prototypical extension';}R.extend(f.prototype,b);R.extend(f.Invalid,b);this._pluginExtendedMethods[d].push([f,b])}return this};I.prototype.stopUsing=function(B){var c=this._pluginPipelineSteps[B],a=this._pluginExtendedMethods[B],b;if(this.plugins[B]){if(c)for(b=0;b<c.length;b++)this.pipeline.removeStep(c[b]);if(a)for(b=0;b<a.length;b++){c=a[b][0];var d=a[b][1];
for(var f in d)delete c.prototype[f],delete c.Invalid[f]}delete this.plugins[B];return this}};I.prototype.useRegisteredPlugins=function(){for(var B in I._pluginFactories)this.use(B)};R.extend(I.prototype,E.prototype)}).call(this)}).call(this,e("_process"))},{"./circular_buffer":3,"./connection/browser":5,"./connection/node":6,"./dialog":8,"./finger":9,"./frame":10,"./gesture":11,"./hand":12,"./pipeline":15,"./pointable":16,_process:23,events:1,underscore:24}],8:[function(e,n,H){(function(u){(function(){var m=
n.exports=function(r,p){this.options=p||{};this.message=r;this.createElement()};m.prototype.createElement=function(){this.element=document.createElement("div");this.element.className="leapjs-dialog";this.element.style.position="fixed";this.element.style.top="8px";this.element.style.left=0;this.element.style.right=0;this.element.style.textAlign="center";this.element.style.zIndex=1E3;var r=document.createElement("div");this.element.appendChild(r);r.style.className="leapjs-dialog";r.style.display="inline-block";
r.style.margin="auto";r.style.padding="8px";r.style.color="#222";r.style.background="#eee";r.style.borderRadius="4px";r.style.border="1px solid #999";r.style.textAlign="left";r.style.cursor="pointer";r.style.whiteSpace="nowrap";r.style.transition="box-shadow 1s linear";r.innerHTML=this.message;this.options.onclick&&r.addEventListener("click",this.options.onclick);this.options.onmouseover&&r.addEventListener("mouseover",this.options.onmouseover);this.options.onmouseout&&r.addEventListener("mouseout",
this.options.onmouseout);this.options.onmousemove&&r.addEventListener("mousemove",this.options.onmousemove)};m.prototype.show=function(){document.body.appendChild(this.element);return this};m.prototype.hide=function(){document.body.removeChild(this.element);return this};m.warnOutOfDate=function(r){r||(r={});var p="http://developer.leapmotion.com?";r.returnTo=window.location.href;for(var G in r)p+=G+"="+encodeURIComponent(r[G])+"&";var v=new m("This site requires Leap Motion Tracking V2.<button id='leapjs-accept-upgrade'  style='color: #444; transition: box-shadow 100ms linear; cursor: pointer; vertical-align: baseline; margin-left: 16px;'>Upgrade</button><button id='leapjs-decline-upgrade' style='color: #444; transition: box-shadow 100ms linear; cursor: pointer; vertical-align: baseline; margin-left: 8px; '>Not Now</button>",
{onclick:function(M){"leapjs-decline-upgrade"!=M.target.id&&(M=window.open(p,"_blank","height=800,width=1000,location=1,menubar=1,resizable=1,status=1,toolbar=1,scrollbars=1"),window.focus&&M.focus());v.hide();return!0},onmousemove:function(M){M.target==document.getElementById("leapjs-decline-upgrade")?(document.getElementById("leapjs-decline-upgrade").style.color="#000",document.getElementById("leapjs-decline-upgrade").style.boxShadow="0px 0px 2px #5daa00",document.getElementById("leapjs-accept-upgrade").style.color=
"#444",document.getElementById("leapjs-accept-upgrade").style.boxShadow="none"):(document.getElementById("leapjs-accept-upgrade").style.color="#000",document.getElementById("leapjs-accept-upgrade").style.boxShadow="0px 0px 2px #5daa00",document.getElementById("leapjs-decline-upgrade").style.color="#444",document.getElementById("leapjs-decline-upgrade").style.boxShadow="none")},onmouseout:function(){document.getElementById("leapjs-decline-upgrade").style.color="#444";document.getElementById("leapjs-decline-upgrade").style.boxShadow=
"none";document.getElementById("leapjs-accept-upgrade").style.color="#444";document.getElementById("leapjs-accept-upgrade").style.boxShadow="none"}});return v.show()};m.hasWarnedBones=!1;m.warnBones=function(){this.hasWarnedBones||(this.hasWarnedBones=!0,console.warn("Your Leap Service is out of date"),"undefined"!==typeof u&&u.versions&&u.versions.node||this.warnOutOfDate({reason:"bones"}))}}).call(this)}).call(this,e("_process"))},{_process:23}],9:[function(e,n,H){var u=e("./pointable"),m=e("./bone"),
r=e("./dialog");e=e("underscore");n=n.exports=function(p){u.call(this,p);this.dipPosition=p.dipPosition;this.pipPosition=p.pipPosition;this.mcpPosition=p.mcpPosition;this.carpPosition=p.carpPosition;this.extended=p.extended;this.type=p.type;this.finger=!0;this.positions=[this.carpPosition,this.mcpPosition,this.pipPosition,this.dipPosition,this.tipPosition];p.bases?this.addBones(p):r.warnBones()};e.extend(n.prototype,u.prototype);n.prototype.addBones=function(p){this.metacarpal=new m(this,{type:0,
width:this.width,prevJoint:this.carpPosition,nextJoint:this.mcpPosition,basis:p.bases[0]});this.proximal=new m(this,{type:1,width:this.width,prevJoint:this.mcpPosition,nextJoint:this.pipPosition,basis:p.bases[1]});this.medial=new m(this,{type:2,width:this.width,prevJoint:this.pipPosition,nextJoint:this.dipPosition,basis:p.bases[2]});this.distal=new m(this,{type:3,width:this.width,prevJoint:this.dipPosition,nextJoint:p.btipPosition,basis:p.bases[3]});this.bones=[this.metacarpal,this.proximal,this.medial,
this.distal]};n.prototype.toString=function(){return"Finger [ id:"+this.id+" "+this.length+"mmx | width:"+this.width+"mm | direction:"+this.direction+" ]"};n.Invalid={valid:!1}},{"./bone":2,"./dialog":8,"./pointable":16,underscore:24}],10:[function(e,n,H){var u=e("./hand"),m=e("./pointable"),r=e("./gesture").createGesture;H=e("gl-matrix");var p=H.mat3,G=H.vec3,v=e("./interaction_box"),M=e("./finger"),E=e("underscore");e=n.exports=function(w){this.valid=!0;this.id=w.id;this.timestamp=w.timestamp;this.hands=
[];this.handsMap={};this.pointables=[];this.tools=[];this.fingers=[];w.interactionBox&&(this.interactionBox=new v(w.interactionBox));this.gestures=[];this.pointablesMap={};this._translation=w.t;this._rotation=E.flatten(w.r);this._scaleFactor=w.s;this.data=w;this.type="frame";this.currentFrameRate=w.currentFrameRate;if(w.gestures)for(var N=0,R=w.gestures.length;N!=R;N++)this.gestures.push(r(w.gestures[N]));this.postprocessData(w)};e.prototype.postprocessData=function(w){w||(w=this.data);for(var N=
0,R=w.hands.length;N!=R;N++){var I=new u(w.hands[N]);I.frame=this;this.hands.push(I);this.handsMap[I.id]=I}w.pointables=E.sortBy(w.pointables,function(B){return B.id});N=0;for(R=w.pointables.length;N!=R;N++)I=w.pointables[N],I=I.dipPosition?new M(I):new m(I),I.frame=this,this.addPointable(I)};e.prototype.addPointable=function(w){this.pointables.push(w);this.pointablesMap[w.id]=w;(w.tool?this.tools:this.fingers).push(w);if(void 0!==w.handId&&this.handsMap.hasOwnProperty(w.handId)){var N=this.handsMap[w.handId];
N.pointables.push(w);(w.tool?N.tools:N.fingers).push(w);switch(w.type){case 0:N.thumb=w;break;case 1:N.indexFinger=w;break;case 2:N.middleFinger=w;break;case 3:N.ringFinger=w;break;case 4:N.pinky=w}}};e.prototype.tool=function(w){w=this.pointable(w);return w.tool?w:m.Invalid};e.prototype.pointable=function(w){return this.pointablesMap[w]||m.Invalid};e.prototype.finger=function(w){w=this.pointable(w);return w.tool?m.Invalid:w};e.prototype.hand=function(w){return this.handsMap[w]||u.Invalid};e.prototype.rotationAngle=
function(w,N){if(!this.valid||!w.valid)return 0;var R=this.rotationMatrix(w);R=Math.acos(.5*(R[0]+R[4]+R[8]-1));R=isNaN(R)?0:R;void 0!==N&&(w=this.rotationAxis(w),R*=G.dot(w,G.normalize(G.create(),N)));return R};e.prototype.rotationAxis=function(w){return this.valid&&w.valid?G.normalize(G.create(),[this._rotation[7]-w._rotation[5],this._rotation[2]-w._rotation[6],this._rotation[3]-w._rotation[1]]):G.create()};e.prototype.rotationMatrix=function(w){if(!this.valid||!w.valid)return p.create();var N=
p.transpose(p.create(),this._rotation);return p.multiply(p.create(),w._rotation,N)};e.prototype.scaleFactor=function(w){return this.valid&&w.valid?Math.exp(this._scaleFactor-w._scaleFactor):1};e.prototype.translation=function(w){return this.valid&&w.valid?G.subtract(G.create(),this._translation,w._translation):G.create()};e.prototype.toString=function(){var w="Frame [ id:"+this.id+" | timestamp:"+this.timestamp+" | Hand count:("+this.hands.length+") | Pointable count:("+this.pointables.length+")";
this.gestures&&(w+=" | Gesture count:("+this.gestures.length+")");return w+" ]"};e.prototype.dump=function(){var w="Frame Info:<br/>"+this.toString();w+="<br/><br/>Hands:<br/>";for(var N=0,R=this.hands.length;N!=R;N++)w+="  "+this.hands[N].toString()+"<br/>";w+="<br/><br/>Pointables:<br/>";N=0;for(R=this.pointables.length;N!=R;N++)w+="  "+this.pointables[N].toString()+"<br/>";if(this.gestures)for(w+="<br/><br/>Gestures:<br/>",N=0,R=this.gestures.length;N!=R;N++)w+="  "+this.gestures[N].toString()+
"<br/>";return w=w+"<br/><br/>Raw JSON:<br/>"+JSON.stringify(this.data)};e.Invalid={valid:!1,hands:[],fingers:[],tools:[],gestures:[],pointables:[],pointable:function(){return m.Invalid},finger:function(){return m.Invalid},hand:function(){return u.Invalid},toString:function(){return"invalid frame"},dump:function(){return this.toString()},rotationAngle:function(){return 0},rotationMatrix:function(){return p.create()},rotationAxis:function(){return G.create()},scaleFactor:function(){return 1},translation:function(){return G.create()}}},
{"./finger":9,"./gesture":11,"./hand":12,"./interaction_box":14,"./pointable":16,"gl-matrix":22,underscore:24}],11:[function(e,n,H){var u=e("gl-matrix").vec3;n=e("events").EventEmitter;var m=e("underscore");H.createGesture=function(E){switch(E.type){case "circle":var w=new p(E);break;case "swipe":w=new G(E);break;case "screenTap":w=new v(E);break;case "keyTap":w=new M(E);break;default:throw"unknown gesture type";}w.id=E.id;w.handIds=E.handIds.slice();w.pointableIds=E.pointableIds.slice();w.duration=
E.duration;w.state=E.state;w.type=E.type;return w};H.gestureListener=function(E,w){var N={},R={};E.on("gesture",function(B,c){if(B.type==w){if(("start"==B.state||"stop"==B.state)&&void 0===R[B.id]){var a=new r(B,c);R[B.id]=a;m.each(N,function(b,d){a.on(d,b)})}R[B.id].update(B,c);"stop"==B.state&&delete R[B.id]}});var I={start:function(B){N.start=B;return I},stop:function(B){N.stop=B;return I},complete:function(B){N.stop=B;return I},update:function(B){N.update=B;return I}};return I};var r=H.Gesture=
function(E,w){this.gestures=[E];this.frames=[w]};r.prototype.update=function(E,w){this.lastGesture=E;this.lastFrame=w;this.gestures.push(E);this.frames.push(w);this.emit(E.state,this)};r.prototype.translation=function(){return u.subtract(u.create(),this.lastGesture.startPosition,this.lastGesture.position)};m.extend(r.prototype,n.prototype);var p=function(E){this.center=E.center;this.normal=E.normal;this.progress=E.progress;this.radius=E.radius};p.prototype.toString=function(){return"CircleGesture ["+
JSON.stringify(this)+"]"};var G=function(E){this.startPosition=E.startPosition;this.position=E.position;this.direction=E.direction;this.speed=E.speed};G.prototype.toString=function(){return"SwipeGesture ["+JSON.stringify(this)+"]"};var v=function(E){this.position=E.position;this.direction=E.direction;this.progress=E.progress};v.prototype.toString=function(){return"ScreenTapGesture ["+JSON.stringify(this)+"]"};var M=function(E){this.position=E.position;this.direction=E.direction;this.progress=E.progress};
M.prototype.toString=function(){return"KeyTapGesture ["+JSON.stringify(this)+"]"}},{events:1,"gl-matrix":22,underscore:24}],12:[function(e,n,H){var u=e("./pointable"),m=e("./bone");H=e("gl-matrix");var r=H.mat3,p=H.vec3,G=e("underscore");e=n.exports=function(v){this.id=v.id;this.palmPosition=v.palmPosition;this.direction=v.direction;this.palmVelocity=v.palmVelocity;this.palmNormal=v.palmNormal;this.sphereCenter=v.sphereCenter;this.sphereRadius=v.sphereRadius;this.valid=!0;this.pointables=[];this.fingers=
[];this.arm=v.armBasis?new m(this,{type:4,width:v.armWidth,prevJoint:v.elbow,nextJoint:v.wrist,basis:v.armBasis}):null;this.tools=[];this._translation=v.t;this._rotation=G.flatten(v.r);this._scaleFactor=v.s;this.timeVisible=v.timeVisible;this.stabilizedPalmPosition=v.stabilizedPalmPosition;this.type=v.type;this.grabStrength=v.grabStrength;this.pinchStrength=v.pinchStrength;this.confidence=v.confidence};e.prototype.finger=function(v){return(v=this.frame.finger(v))&&v.handId==this.id?v:u.Invalid};e.prototype.rotationAngle=
function(v,M){if(!this.valid||!v.valid||!v.hand(this.id).valid)return 0;var E=this.rotationMatrix(v);E=Math.acos(.5*(E[0]+E[4]+E[8]-1));E=isNaN(E)?0:E;void 0!==M&&(v=this.rotationAxis(v),E*=p.dot(v,p.normalize(p.create(),M)));return E};e.prototype.rotationAxis=function(v){if(!this.valid||!v.valid)return p.create();v=v.hand(this.id);return v.valid?p.normalize(p.create(),[this._rotation[7]-v._rotation[5],this._rotation[2]-v._rotation[6],this._rotation[3]-v._rotation[1]]):p.create()};e.prototype.rotationMatrix=
function(v){if(!this.valid||!v.valid)return r.create();v=v.hand(this.id);if(!v.valid)return r.create();var M=r.transpose(r.create(),this._rotation);return r.multiply(r.create(),v._rotation,M)};e.prototype.scaleFactor=function(v){if(!this.valid||!v.valid)return 1;v=v.hand(this.id);return v.valid?Math.exp(this._scaleFactor-v._scaleFactor):1};e.prototype.translation=function(v){if(!this.valid||!v.valid)return p.create();v=v.hand(this.id);return v.valid?[this._translation[0]-v._translation[0],this._translation[1]-
v._translation[1],this._translation[2]-v._translation[2]]:p.create()};e.prototype.toString=function(){return"Hand ("+this.type+") [ id: "+this.id+" | palm velocity:"+this.palmVelocity+" | sphere center:"+this.sphereCenter+" ] "};e.prototype.pitch=function(){return Math.atan2(this.direction[1],-this.direction[2])};e.prototype.yaw=function(){return Math.atan2(this.direction[0],-this.direction[2])};e.prototype.roll=function(){return Math.atan2(this.palmNormal[0],-this.palmNormal[1])};e.Invalid={valid:!1,
fingers:[],tools:[],pointables:[],left:!1,pointable:function(){return u.Invalid},finger:function(){return u.Invalid},toString:function(){return"invalid frame"},dump:function(){return this.toString()},rotationAngle:function(){return 0},rotationMatrix:function(){return r.create()},rotationAxis:function(){return p.create()},scaleFactor:function(){return 1},translation:function(){return p.create()}}},{"./bone":2,"./pointable":16,"gl-matrix":22,underscore:24}],13:[function(e,n,H){n.exports={Controller:e("./controller"),
Frame:e("./frame"),Gesture:e("./gesture"),Hand:e("./hand"),Pointable:e("./pointable"),Finger:e("./finger"),InteractionBox:e("./interaction_box"),CircularBuffer:e("./circular_buffer"),UI:e("./ui"),JSONProtocol:e("./protocol").JSONProtocol,glMatrix:e("gl-matrix"),mat3:e("gl-matrix").mat3,vec3:e("gl-matrix").vec3,loopController:void 0,version:e("./version.js"),_:e("underscore"),EventEmitter:e("events").EventEmitter,loop:function(u,m){u&&void 0===m&&"[object Function]"==={}.toString.call(u)&&(m=u,u={});
this.loopController?u&&this.loopController.setupFrameEvents(u):this.loopController=new this.Controller(u);this.loopController.loop(m);return this.loopController},plugin:function(u,m){this.Controller.plugin(u,m)}}},{"./circular_buffer":3,"./controller":7,"./finger":9,"./frame":10,"./gesture":11,"./hand":12,"./interaction_box":14,"./pointable":16,"./protocol":17,"./ui":18,"./version.js":21,events:1,"gl-matrix":22,underscore:24}],14:[function(e,n,H){var u=e("gl-matrix").vec3;e=n.exports=function(m){this.valid=
!0;this.center=m.center;this.size=m.size;this.width=m.size[0];this.height=m.size[1];this.depth=m.size[2]};e.prototype.denormalizePoint=function(m){return u.fromValues((m[0]-.5)*this.size[0]+this.center[0],(m[1]-.5)*this.size[1]+this.center[1],(m[2]-.5)*this.size[2]+this.center[2])};e.prototype.normalizePoint=function(m,r){m=u.fromValues((m[0]-this.center[0])/this.size[0]+.5,(m[1]-this.center[1])/this.size[1]+.5,(m[2]-this.center[2])/this.size[2]+.5);r&&(m[0]=Math.min(Math.max(m[0],0),1),m[1]=Math.min(Math.max(m[1],
0),1),m[2]=Math.min(Math.max(m[2],0),1));return m};e.prototype.toString=function(){return"InteractionBox [ width:"+this.width+" | height:"+this.height+" | depth:"+this.depth+" ]"};e.Invalid={valid:!1}},{"gl-matrix":22}],15:[function(e,n,H){e=n.exports=function(u){this.steps=[];this.controller=u};e.prototype.addStep=function(u){this.steps.push(u)};e.prototype.run=function(u){for(var m=this.steps.length,r=0;r!=m&&u;r++)u=this.steps[r](u);return u};e.prototype.removeStep=function(u){u=this.steps.indexOf(u);
if(-1===u)throw"Step not found in pipeline";this.steps.splice(u,1)};e.prototype.addWrappedStep=function(u,m){var r=this.controller,p=function(G){var v;var M="frame"==u?[G]:G[u+"s"]||[];var E=0;for(v=M.length;E<v;E++)m.call(r,M[E]);return G};this.addStep(p);return p}},{}],16:[function(e,n,H){e("gl-matrix");e=n.exports=function(u){this.valid=!0;this.id=u.id;this.handId=u.handId;this.length=u.length;this.tool=u.tool;this.width=u.width;this.direction=u.direction;this.stabilizedTipPosition=u.stabilizedTipPosition;
this.tipPosition=u.tipPosition;this.tipVelocity=u.tipVelocity;this.touchZone=u.touchZone;this.touchDistance=u.touchDistance;this.timeVisible=u.timeVisible};e.prototype.toString=function(){return"Pointable [ id:"+this.id+" "+this.length+"mmx | width:"+this.width+"mm | direction:"+this.direction+" ]"};e.prototype.hand=function(){return this.frame.hand(this.handId)};e.Invalid={valid:!1}},{"gl-matrix":22}],17:[function(e,n,H){var u=e("./frame");e("./hand");e("./pointable");e("./finger");var m=e("underscore"),
r=e("events").EventEmitter,p=function(v){this.type=v.type;this.state=v.state};H.chooseProtocol=function(v){switch(v.version){case 1:case 2:case 3:case 4:case 5:case 6:var M=G(v);M.sendBackground=function(E,w){E.send(M.encode({background:w}))};M.sendFocused=function(E,w){E.send(M.encode({focused:w}))};M.sendOptimizeHMD=function(E,w){E.send(M.encode({optimizeHMD:w}))};break;default:throw"unrecognized version";}return M};var G=H.JSONProtocol=function(v){var M=function(E){if(E.event)return new p(E.event);
M.emit("beforeFrameCreated",E);var w=new u(E);M.emit("afterFrameCreated",w,E);return w};M.encode=function(E){return JSON.stringify(E)};M.version=v.version;M.serviceVersion=v.serviceVersion;M.versionLong="Version "+v.version;M.type="protocol";m.extend(M,r.prototype);return M}},{"./finger":9,"./frame":10,"./hand":12,"./pointable":16,events:1,underscore:24}],18:[function(e,n,H){H.UI={Region:e("./ui/region"),Cursor:e("./ui/cursor")}},{"./ui/cursor":19,"./ui/region":20}],19:[function(e,n,H){n.exports=
function(){return function(u){var m=u.pointables.sort(function(r,p){return r.z-p.z})[0];m&&m.valid&&(u.cursorPosition=m.tipPosition);return u}}},{}],20:[function(e,n,H){H=e("events").EventEmitter;e=e("underscore");var u=n.exports=function(m,r){this.start=new Vector(m);this.end=new Vector(r);this.enteredFrame=null};u.prototype.hasPointables=function(m){for(var r=0;r!=m.pointables.length;r++){var p=m.pointables[r].tipPosition;if(p.x>=this.start.x&&p.x<=this.end.x&&p.y>=this.start.y&&p.y<=this.end.y&&
p.z>=this.start.z&&p.z<=this.end.z)return!0}return!1};u.prototype.listener=function(m){var r=this;m&&m.nearThreshold&&this.setupNearRegion(m.nearThreshold);return function(p){return r.updatePosition(p)}};u.prototype.clipper=function(){var m=this;return function(r){m.updatePosition(r);return m.enteredFrame?r:null}};u.prototype.setupNearRegion=function(m){m=this.nearRegion=new u([this.start.x-m,this.start.y-m,this.start.z-m],[this.end.x+m,this.end.y+m,this.end.z+m]);var r=this;m.on("enter",function(p){r.emit("near",
p)});m.on("exit",function(p){r.emit("far",p)});r.on("exit",function(p){r.emit("near",p)})};u.prototype.updatePosition=function(m){this.nearRegion&&this.nearRegion.updatePosition(m);this.hasPointables(m)&&null==this.enteredFrame?(this.enteredFrame=m,this.emit("enter",this.enteredFrame)):this.hasPointables(m)||null==this.enteredFrame||(this.enteredFrame=null,this.emit("exit",this.enteredFrame));return m};u.prototype.normalize=function(m){return new Vector([(m.x-this.start.x)/(this.end.x-this.start.x),
(m.y-this.start.y)/(this.end.y-this.start.y),(m.z-this.start.z)/(this.end.z-this.start.z)])};u.prototype.mapToXY=function(m,r,p){m=this.normalize(m);var G=m.x,v=m.y;1<G?G=1:-1>G&&(G=-1);1<v?v=1:-1>v&&(v=-1);return[(G+1)/2*r,(1-v)/2*p,m.z]};e.extend(u.prototype,H.prototype)},{events:1,underscore:24}],21:[function(e,n,H){n.exports={full:"0.6.4",major:0,minor:6,dot:4}},{}],22:[function(e,n,H){(function(u){(function(m){if(!r)var r=1E-6;if(!p)var p="undefined"!==typeof Float32Array?Float32Array:Array;
if(!G)var G=Math.random;var v={setMatrixArrayType:function(c){p=c}};"undefined"!==typeof m&&(m.glMatrix=v);var M=Math.PI/180;v.toRadian=function(c){return c*M};var E={create:function(){var c=new p(2);c[0]=0;c[1]=0;return c},clone:function(c){var a=new p(2);a[0]=c[0];a[1]=c[1];return a},fromValues:function(c,a){var b=new p(2);b[0]=c;b[1]=a;return b},copy:function(c,a){c[0]=a[0];c[1]=a[1];return c},set:function(c,a,b){c[0]=a;c[1]=b;return c},add:function(c,a,b){c[0]=a[0]+b[0];c[1]=a[1]+b[1];return c},
subtract:function(c,a,b){c[0]=a[0]-b[0];c[1]=a[1]-b[1];return c}};E.sub=E.subtract;E.multiply=function(c,a,b){c[0]=a[0]*b[0];c[1]=a[1]*b[1];return c};E.mul=E.multiply;E.divide=function(c,a,b){c[0]=a[0]/b[0];c[1]=a[1]/b[1];return c};E.div=E.divide;E.min=function(c,a,b){c[0]=Math.min(a[0],b[0]);c[1]=Math.min(a[1],b[1]);return c};E.max=function(c,a,b){c[0]=Math.max(a[0],b[0]);c[1]=Math.max(a[1],b[1]);return c};E.scale=function(c,a,b){c[0]=a[0]*b;c[1]=a[1]*b;return c};E.scaleAndAdd=function(c,a,b,d){c[0]=
a[0]+b[0]*d;c[1]=a[1]+b[1]*d;return c};E.distance=function(c,a){var b=a[0]-c[0];c=a[1]-c[1];return Math.sqrt(b*b+c*c)};E.dist=E.distance;E.squaredDistance=function(c,a){var b=a[0]-c[0];c=a[1]-c[1];return b*b+c*c};E.sqrDist=E.squaredDistance;E.length=function(c){var a=c[0];c=c[1];return Math.sqrt(a*a+c*c)};E.len=E.length;E.squaredLength=function(c){var a=c[0];c=c[1];return a*a+c*c};E.sqrLen=E.squaredLength;E.negate=function(c,a){c[0]=-a[0];c[1]=-a[1];return c};E.normalize=function(c,a){var b=a[0],
d=a[1];b=b*b+d*d;0<b&&(b=1/Math.sqrt(b),c[0]=a[0]*b,c[1]=a[1]*b);return c};E.dot=function(c,a){return c[0]*a[0]+c[1]*a[1]};E.cross=function(c,a,b){a=a[0]*b[1]-a[1]*b[0];c[0]=c[1]=0;c[2]=a;return c};E.lerp=function(c,a,b,d){var f=a[0];a=a[1];c[0]=f+d*(b[0]-f);c[1]=a+d*(b[1]-a);return c};E.random=function(c,a){a=a||1;var b=2*G()*Math.PI;c[0]=Math.cos(b)*a;c[1]=Math.sin(b)*a;return c};E.transformMat2=function(c,a,b){var d=a[0];a=a[1];c[0]=b[0]*d+b[2]*a;c[1]=b[1]*d+b[3]*a;return c};E.transformMat2d=function(c,
a,b){var d=a[0];a=a[1];c[0]=b[0]*d+b[2]*a+b[4];c[1]=b[1]*d+b[3]*a+b[5];return c};E.transformMat3=function(c,a,b){var d=a[0];a=a[1];c[0]=b[0]*d+b[3]*a+b[6];c[1]=b[1]*d+b[4]*a+b[7];return c};E.transformMat4=function(c,a,b){var d=a[0];a=a[1];c[0]=b[0]*d+b[4]*a+b[12];c[1]=b[1]*d+b[5]*a+b[13];return c};E.forEach=function(){var c=E.create();return function(a,b,d,f,g,l){b||(b=2);d||(d=0);for(f=f?Math.min(f*b+d,a.length):a.length;d<f;d+=b)c[0]=a[d],c[1]=a[d+1],g(c,c,l),a[d]=c[0],a[d+1]=c[1];return a}}();
E.str=function(c){return"vec2("+c[0]+", "+c[1]+")"};"undefined"!==typeof m&&(m.vec2=E);var w={create:function(){var c=new p(3);c[0]=0;c[1]=0;c[2]=0;return c},clone:function(c){var a=new p(3);a[0]=c[0];a[1]=c[1];a[2]=c[2];return a},fromValues:function(c,a,b){var d=new p(3);d[0]=c;d[1]=a;d[2]=b;return d},copy:function(c,a){c[0]=a[0];c[1]=a[1];c[2]=a[2];return c},set:function(c,a,b,d){c[0]=a;c[1]=b;c[2]=d;return c},add:function(c,a,b){c[0]=a[0]+b[0];c[1]=a[1]+b[1];c[2]=a[2]+b[2];return c},subtract:function(c,
a,b){c[0]=a[0]-b[0];c[1]=a[1]-b[1];c[2]=a[2]-b[2];return c}};w.sub=w.subtract;w.multiply=function(c,a,b){c[0]=a[0]*b[0];c[1]=a[1]*b[1];c[2]=a[2]*b[2];return c};w.mul=w.multiply;w.divide=function(c,a,b){c[0]=a[0]/b[0];c[1]=a[1]/b[1];c[2]=a[2]/b[2];return c};w.div=w.divide;w.min=function(c,a,b){c[0]=Math.min(a[0],b[0]);c[1]=Math.min(a[1],b[1]);c[2]=Math.min(a[2],b[2]);return c};w.max=function(c,a,b){c[0]=Math.max(a[0],b[0]);c[1]=Math.max(a[1],b[1]);c[2]=Math.max(a[2],b[2]);return c};w.scale=function(c,
a,b){c[0]=a[0]*b;c[1]=a[1]*b;c[2]=a[2]*b;return c};w.scaleAndAdd=function(c,a,b,d){c[0]=a[0]+b[0]*d;c[1]=a[1]+b[1]*d;c[2]=a[2]+b[2]*d;return c};w.distance=function(c,a){var b=a[0]-c[0],d=a[1]-c[1];c=a[2]-c[2];return Math.sqrt(b*b+d*d+c*c)};w.dist=w.distance;w.squaredDistance=function(c,a){var b=a[0]-c[0],d=a[1]-c[1];c=a[2]-c[2];return b*b+d*d+c*c};w.sqrDist=w.squaredDistance;w.length=function(c){var a=c[0],b=c[1];c=c[2];return Math.sqrt(a*a+b*b+c*c)};w.len=w.length;w.squaredLength=function(c){var a=
c[0],b=c[1];c=c[2];return a*a+b*b+c*c};w.sqrLen=w.squaredLength;w.negate=function(c,a){c[0]=-a[0];c[1]=-a[1];c[2]=-a[2];return c};w.normalize=function(c,a){var b=a[0],d=a[1],f=a[2];b=b*b+d*d+f*f;0<b&&(b=1/Math.sqrt(b),c[0]=a[0]*b,c[1]=a[1]*b,c[2]=a[2]*b);return c};w.dot=function(c,a){return c[0]*a[0]+c[1]*a[1]+c[2]*a[2]};w.cross=function(c,a,b){var d=a[0],f=a[1];a=a[2];var g=b[0],l=b[1];b=b[2];c[0]=f*b-a*l;c[1]=a*g-d*b;c[2]=d*l-f*g;return c};w.lerp=function(c,a,b,d){var f=a[0],g=a[1];a=a[2];c[0]=
f+d*(b[0]-f);c[1]=g+d*(b[1]-g);c[2]=a+d*(b[2]-a);return c};w.random=function(c,a){a=a||1;var b=2*G()*Math.PI,d=2*G()-1,f=Math.sqrt(1-d*d)*a;c[0]=Math.cos(b)*f;c[1]=Math.sin(b)*f;c[2]=d*a;return c};w.transformMat4=function(c,a,b){var d=a[0],f=a[1];a=a[2];c[0]=b[0]*d+b[4]*f+b[8]*a+b[12];c[1]=b[1]*d+b[5]*f+b[9]*a+b[13];c[2]=b[2]*d+b[6]*f+b[10]*a+b[14];return c};w.transformMat3=function(c,a,b){var d=a[0],f=a[1];a=a[2];c[0]=d*b[0]+f*b[3]+a*b[6];c[1]=d*b[1]+f*b[4]+a*b[7];c[2]=d*b[2]+f*b[5]+a*b[8];return c};
w.transformQuat=function(c,a,b){var d=a[0],f=a[1],g=a[2];a=b[0];var l=b[1],A=b[2];b=b[3];var h=b*d+l*g-A*f,C=b*f+A*d-a*g,J=b*g+a*f-l*d;d=-a*d-l*f-A*g;c[0]=h*b+d*-a+C*-A-J*-l;c[1]=C*b+d*-l+J*-a-h*-A;c[2]=J*b+d*-A+h*-l-C*-a;return c};w.rotateX=function(c,a,b,d){var f=[],g=[];f[0]=a[0]-b[0];f[1]=a[1]-b[1];f[2]=a[2]-b[2];g[0]=f[0];g[1]=f[1]*Math.cos(d)-f[2]*Math.sin(d);g[2]=f[1]*Math.sin(d)+f[2]*Math.cos(d);c[0]=g[0]+b[0];c[1]=g[1]+b[1];c[2]=g[2]+b[2];return c};w.rotateY=function(c,a,b,d){var f=[],g=
[];f[0]=a[0]-b[0];f[1]=a[1]-b[1];f[2]=a[2]-b[2];g[0]=f[2]*Math.sin(d)+f[0]*Math.cos(d);g[1]=f[1];g[2]=f[2]*Math.cos(d)-f[0]*Math.sin(d);c[0]=g[0]+b[0];c[1]=g[1]+b[1];c[2]=g[2]+b[2];return c};w.rotateZ=function(c,a,b,d){var f=[],g=[];f[0]=a[0]-b[0];f[1]=a[1]-b[1];f[2]=a[2]-b[2];g[0]=f[0]*Math.cos(d)-f[1]*Math.sin(d);g[1]=f[0]*Math.sin(d)+f[1]*Math.cos(d);g[2]=f[2];c[0]=g[0]+b[0];c[1]=g[1]+b[1];c[2]=g[2]+b[2];return c};w.forEach=function(){var c=w.create();return function(a,b,d,f,g,l){b||(b=3);d||(d=
0);for(f=f?Math.min(f*b+d,a.length):a.length;d<f;d+=b)c[0]=a[d],c[1]=a[d+1],c[2]=a[d+2],g(c,c,l),a[d]=c[0],a[d+1]=c[1],a[d+2]=c[2];return a}}();w.str=function(c){return"vec3("+c[0]+", "+c[1]+", "+c[2]+")"};"undefined"!==typeof m&&(m.vec3=w);var N={create:function(){var c=new p(4);c[0]=0;c[1]=0;c[2]=0;c[3]=0;return c},clone:function(c){var a=new p(4);a[0]=c[0];a[1]=c[1];a[2]=c[2];a[3]=c[3];return a},fromValues:function(c,a,b,d){var f=new p(4);f[0]=c;f[1]=a;f[2]=b;f[3]=d;return f},copy:function(c,a){c[0]=
a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];return c},set:function(c,a,b,d,f){c[0]=a;c[1]=b;c[2]=d;c[3]=f;return c},add:function(c,a,b){c[0]=a[0]+b[0];c[1]=a[1]+b[1];c[2]=a[2]+b[2];c[3]=a[3]+b[3];return c},subtract:function(c,a,b){c[0]=a[0]-b[0];c[1]=a[1]-b[1];c[2]=a[2]-b[2];c[3]=a[3]-b[3];return c}};N.sub=N.subtract;N.multiply=function(c,a,b){c[0]=a[0]*b[0];c[1]=a[1]*b[1];c[2]=a[2]*b[2];c[3]=a[3]*b[3];return c};N.mul=N.multiply;N.divide=function(c,a,b){c[0]=a[0]/b[0];c[1]=a[1]/b[1];c[2]=a[2]/b[2];c[3]=a[3]/
b[3];return c};N.div=N.divide;N.min=function(c,a,b){c[0]=Math.min(a[0],b[0]);c[1]=Math.min(a[1],b[1]);c[2]=Math.min(a[2],b[2]);c[3]=Math.min(a[3],b[3]);return c};N.max=function(c,a,b){c[0]=Math.max(a[0],b[0]);c[1]=Math.max(a[1],b[1]);c[2]=Math.max(a[2],b[2]);c[3]=Math.max(a[3],b[3]);return c};N.scale=function(c,a,b){c[0]=a[0]*b;c[1]=a[1]*b;c[2]=a[2]*b;c[3]=a[3]*b;return c};N.scaleAndAdd=function(c,a,b,d){c[0]=a[0]+b[0]*d;c[1]=a[1]+b[1]*d;c[2]=a[2]+b[2]*d;c[3]=a[3]+b[3]*d;return c};N.distance=function(c,
a){var b=a[0]-c[0],d=a[1]-c[1],f=a[2]-c[2];c=a[3]-c[3];return Math.sqrt(b*b+d*d+f*f+c*c)};N.dist=N.distance;N.squaredDistance=function(c,a){var b=a[0]-c[0],d=a[1]-c[1],f=a[2]-c[2];c=a[3]-c[3];return b*b+d*d+f*f+c*c};N.sqrDist=N.squaredDistance;N.length=function(c){var a=c[0],b=c[1],d=c[2];c=c[3];return Math.sqrt(a*a+b*b+d*d+c*c)};N.len=N.length;N.squaredLength=function(c){var a=c[0],b=c[1],d=c[2];c=c[3];return a*a+b*b+d*d+c*c};N.sqrLen=N.squaredLength;N.negate=function(c,a){c[0]=-a[0];c[1]=-a[1];
c[2]=-a[2];c[3]=-a[3];return c};N.normalize=function(c,a){var b=a[0],d=a[1],f=a[2],g=a[3];b=b*b+d*d+f*f+g*g;0<b&&(b=1/Math.sqrt(b),c[0]=a[0]*b,c[1]=a[1]*b,c[2]=a[2]*b,c[3]=a[3]*b);return c};N.dot=function(c,a){return c[0]*a[0]+c[1]*a[1]+c[2]*a[2]+c[3]*a[3]};N.lerp=function(c,a,b,d){var f=a[0],g=a[1],l=a[2];a=a[3];c[0]=f+d*(b[0]-f);c[1]=g+d*(b[1]-g);c[2]=l+d*(b[2]-l);c[3]=a+d*(b[3]-a);return c};N.random=function(c,a){a=a||1;c[0]=G();c[1]=G();c[2]=G();c[3]=G();N.normalize(c,c);N.scale(c,c,a);return c};
N.transformMat4=function(c,a,b){var d=a[0],f=a[1],g=a[2];a=a[3];c[0]=b[0]*d+b[4]*f+b[8]*g+b[12]*a;c[1]=b[1]*d+b[5]*f+b[9]*g+b[13]*a;c[2]=b[2]*d+b[6]*f+b[10]*g+b[14]*a;c[3]=b[3]*d+b[7]*f+b[11]*g+b[15]*a;return c};N.transformQuat=function(c,a,b){var d=a[0],f=a[1],g=a[2];a=b[0];var l=b[1],A=b[2];b=b[3];var h=b*d+l*g-A*f,C=b*f+A*d-a*g,J=b*g+a*f-l*d;d=-a*d-l*f-A*g;c[0]=h*b+d*-a+C*-A-J*-l;c[1]=C*b+d*-l+J*-a-h*-A;c[2]=J*b+d*-A+h*-l-C*-a;return c};N.forEach=function(){var c=N.create();return function(a,b,
d,f,g,l){b||(b=4);d||(d=0);for(f=f?Math.min(f*b+d,a.length):a.length;d<f;d+=b)c[0]=a[d],c[1]=a[d+1],c[2]=a[d+2],c[3]=a[d+3],g(c,c,l),a[d]=c[0],a[d+1]=c[1],a[d+2]=c[2],a[d+3]=c[3];return a}}();N.str=function(c){return"vec4("+c[0]+", "+c[1]+", "+c[2]+", "+c[3]+")"};"undefined"!==typeof m&&(m.vec4=N);v={create:function(){var c=new p(4);c[0]=1;c[1]=0;c[2]=0;c[3]=1;return c},clone:function(c){var a=new p(4);a[0]=c[0];a[1]=c[1];a[2]=c[2];a[3]=c[3];return a},copy:function(c,a){c[0]=a[0];c[1]=a[1];c[2]=a[2];
c[3]=a[3];return c},identity:function(c){c[0]=1;c[1]=0;c[2]=0;c[3]=1;return c},transpose:function(c,a){if(c===a){var b=a[1];c[1]=a[2];c[2]=b}else c[0]=a[0],c[1]=a[2],c[2]=a[1],c[3]=a[3];return c},invert:function(c,a){var b=a[0],d=a[1],f=a[2];a=a[3];var g=b*a-f*d;if(!g)return null;g=1/g;c[0]=a*g;c[1]=-d*g;c[2]=-f*g;c[3]=b*g;return c},adjoint:function(c,a){var b=a[0];c[0]=a[3];c[1]=-a[1];c[2]=-a[2];c[3]=b;return c},determinant:function(c){return c[0]*c[3]-c[2]*c[1]},multiply:function(c,a,b){var d=a[0],
f=a[1],g=a[2];a=a[3];var l=b[0],A=b[1],h=b[2];b=b[3];c[0]=d*l+g*A;c[1]=f*l+a*A;c[2]=d*h+g*b;c[3]=f*h+a*b;return c}};v.mul=v.multiply;v.rotate=function(c,a,b){var d=a[0],f=a[1],g=a[2];a=a[3];var l=Math.sin(b);b=Math.cos(b);c[0]=d*b+g*l;c[1]=f*b+a*l;c[2]=d*-l+g*b;c[3]=f*-l+a*b;return c};v.scale=function(c,a,b){var d=a[1],f=a[2],g=a[3],l=b[0];b=b[1];c[0]=a[0]*l;c[1]=d*l;c[2]=f*b;c[3]=g*b;return c};v.str=function(c){return"mat2("+c[0]+", "+c[1]+", "+c[2]+", "+c[3]+")"};v.frob=function(c){return Math.sqrt(Math.pow(c[0],
2)+Math.pow(c[1],2)+Math.pow(c[2],2)+Math.pow(c[3],2))};v.LDU=function(c,a,b,d){c[2]=d[2]/d[0];b[0]=d[0];b[1]=d[1];b[3]=d[3]-c[2]*b[1];return[c,a,b]};"undefined"!==typeof m&&(m.mat2=v);v={create:function(){var c=new p(6);c[0]=1;c[1]=0;c[2]=0;c[3]=1;c[4]=0;c[5]=0;return c},clone:function(c){var a=new p(6);a[0]=c[0];a[1]=c[1];a[2]=c[2];a[3]=c[3];a[4]=c[4];a[5]=c[5];return a},copy:function(c,a){c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];return c},identity:function(c){c[0]=1;c[1]=0;c[2]=
0;c[3]=1;c[4]=0;c[5]=0;return c},invert:function(c,a){var b=a[0],d=a[1],f=a[2],g=a[3],l=a[4];a=a[5];var A=b*g-d*f;if(!A)return null;A=1/A;c[0]=g*A;c[1]=-d*A;c[2]=-f*A;c[3]=b*A;c[4]=(f*a-g*l)*A;c[5]=(d*l-b*a)*A;return c},determinant:function(c){return c[0]*c[3]-c[1]*c[2]},multiply:function(c,a,b){var d=a[0],f=a[1],g=a[2],l=a[3],A=a[4];a=a[5];var h=b[0],C=b[1],J=b[2],O=b[3],S=b[4];b=b[5];c[0]=d*h+g*C;c[1]=f*h+l*C;c[2]=d*J+g*O;c[3]=f*J+l*O;c[4]=d*S+g*b+A;c[5]=f*S+l*b+a;return c}};v.mul=v.multiply;v.rotate=
function(c,a,b){var d=a[0],f=a[1],g=a[2],l=a[3],A=a[4];a=a[5];var h=Math.sin(b);b=Math.cos(b);c[0]=d*b+g*h;c[1]=f*b+l*h;c[2]=d*-h+g*b;c[3]=f*-h+l*b;c[4]=A;c[5]=a;return c};v.scale=function(c,a,b){var d=a[1],f=a[2],g=a[3],l=a[4],A=a[5],h=b[0];b=b[1];c[0]=a[0]*h;c[1]=d*h;c[2]=f*b;c[3]=g*b;c[4]=l;c[5]=A;return c};v.translate=function(c,a,b){var d=a[0],f=a[1],g=a[2],l=a[3],A=a[4];a=a[5];var h=b[0];b=b[1];c[0]=d;c[1]=f;c[2]=g;c[3]=l;c[4]=d*h+g*b+A;c[5]=f*h+l*b+a;return c};v.str=function(c){return"mat2d("+
c[0]+", "+c[1]+", "+c[2]+", "+c[3]+", "+c[4]+", "+c[5]+")"};v.frob=function(c){return Math.sqrt(Math.pow(c[0],2)+Math.pow(c[1],2)+Math.pow(c[2],2)+Math.pow(c[3],2)+Math.pow(c[4],2)+Math.pow(c[5],2)+1)};"undefined"!==typeof m&&(m.mat2d=v);var R={create:function(){var c=new p(9);c[0]=1;c[1]=0;c[2]=0;c[3]=0;c[4]=1;c[5]=0;c[6]=0;c[7]=0;c[8]=1;return c},fromMat4:function(c,a){c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[4];c[4]=a[5];c[5]=a[6];c[6]=a[8];c[7]=a[9];c[8]=a[10];return c},clone:function(c){var a=new p(9);
a[0]=c[0];a[1]=c[1];a[2]=c[2];a[3]=c[3];a[4]=c[4];a[5]=c[5];a[6]=c[6];a[7]=c[7];a[8]=c[8];return a},copy:function(c,a){c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];return c},identity:function(c){c[0]=1;c[1]=0;c[2]=0;c[3]=0;c[4]=1;c[5]=0;c[6]=0;c[7]=0;c[8]=1;return c},transpose:function(c,a){if(c===a){var b=a[1],d=a[2],f=a[5];c[1]=a[3];c[2]=a[6];c[3]=b;c[5]=a[7];c[6]=d;c[7]=f}else c[0]=a[0],c[1]=a[3],c[2]=a[6],c[3]=a[1],c[4]=a[4],c[5]=a[7],c[6]=a[2],c[7]=
a[5],c[8]=a[8];return c},invert:function(c,a){var b=a[0],d=a[1],f=a[2],g=a[3],l=a[4],A=a[5],h=a[6],C=a[7];a=a[8];var J=a*l-A*C,O=-a*g+A*h,S=C*g-l*h,T=b*J+d*O+f*S;if(!T)return null;T=1/T;c[0]=J*T;c[1]=(-a*d+f*C)*T;c[2]=(A*d-f*l)*T;c[3]=O*T;c[4]=(a*b-f*h)*T;c[5]=(-A*b+f*g)*T;c[6]=S*T;c[7]=(-C*b+d*h)*T;c[8]=(l*b-d*g)*T;return c},adjoint:function(c,a){var b=a[0],d=a[1],f=a[2],g=a[3],l=a[4],A=a[5],h=a[6],C=a[7];a=a[8];c[0]=l*a-A*C;c[1]=f*C-d*a;c[2]=d*A-f*l;c[3]=A*h-g*a;c[4]=b*a-f*h;c[5]=f*g-b*A;c[6]=g*
C-l*h;c[7]=d*h-b*C;c[8]=b*l-d*g;return c},determinant:function(c){var a=c[3],b=c[4],d=c[5],f=c[6],g=c[7],l=c[8];return c[0]*(l*b-d*g)+c[1]*(-l*a+d*f)+c[2]*(g*a-b*f)},multiply:function(c,a,b){var d=a[0],f=a[1],g=a[2],l=a[3],A=a[4],h=a[5],C=a[6],J=a[7];a=a[8];var O=b[0],S=b[1],T=b[2],V=b[3],Z=b[4],Y=b[5],da=b[6],ia=b[7];b=b[8];c[0]=O*d+S*l+T*C;c[1]=O*f+S*A+T*J;c[2]=O*g+S*h+T*a;c[3]=V*d+Z*l+Y*C;c[4]=V*f+Z*A+Y*J;c[5]=V*g+Z*h+Y*a;c[6]=da*d+ia*l+b*C;c[7]=da*f+ia*A+b*J;c[8]=da*g+ia*h+b*a;return c}};R.mul=
R.multiply;R.translate=function(c,a,b){var d=a[0],f=a[1],g=a[2],l=a[3],A=a[4],h=a[5],C=a[6],J=a[7];a=a[8];var O=b[0];b=b[1];c[0]=d;c[1]=f;c[2]=g;c[3]=l;c[4]=A;c[5]=h;c[6]=O*d+b*l+C;c[7]=O*f+b*A+J;c[8]=O*g+b*h+a;return c};R.rotate=function(c,a,b){var d=a[0],f=a[1],g=a[2],l=a[3],A=a[4],h=a[5],C=a[6],J=a[7];a=a[8];var O=Math.sin(b);b=Math.cos(b);c[0]=b*d+O*l;c[1]=b*f+O*A;c[2]=b*g+O*h;c[3]=b*l-O*d;c[4]=b*A-O*f;c[5]=b*h-O*g;c[6]=C;c[7]=J;c[8]=a;return c};R.scale=function(c,a,b){var d=b[0];b=b[1];c[0]=
d*a[0];c[1]=d*a[1];c[2]=d*a[2];c[3]=b*a[3];c[4]=b*a[4];c[5]=b*a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];return c};R.fromMat2d=function(c,a){c[0]=a[0];c[1]=a[1];c[2]=0;c[3]=a[2];c[4]=a[3];c[5]=0;c[6]=a[4];c[7]=a[5];c[8]=1;return c};R.fromQuat=function(c,a){var b=a[0],d=a[1],f=a[2];a=a[3];var g=b+b,l=d+d,A=f+f;b*=g;var h=d*g;d*=l;var C=f*g,J=f*l;f*=A;g*=a;l*=a;a*=A;c[0]=1-d-f;c[3]=h-a;c[6]=C+l;c[1]=h+a;c[4]=1-b-f;c[7]=J-g;c[2]=C-l;c[5]=J+g;c[8]=1-b-d;return c};R.normalFromMat4=function(c,a){var b=a[0],d=a[1],
f=a[2],g=a[3],l=a[4],A=a[5],h=a[6],C=a[7],J=a[8],O=a[9],S=a[10],T=a[11],V=a[12],Z=a[13],Y=a[14];a=a[15];var da=b*A-d*l,ia=b*h-f*l,ba=b*C-g*l,ea=d*h-f*A,ca=d*C-g*A,q=f*C-g*h,F=J*Z-O*V,K=J*Y-S*V;J=J*a-T*V;var Q=O*Y-S*Z;O=O*a-T*Z;S=S*a-T*Y;T=da*S-ia*O+ba*Q+ea*J-ca*K+q*F;if(!T)return null;T=1/T;c[0]=(A*S-h*O+C*Q)*T;c[1]=(h*J-l*S-C*K)*T;c[2]=(l*O-A*J+C*F)*T;c[3]=(f*O-d*S-g*Q)*T;c[4]=(b*S-f*J+g*K)*T;c[5]=(d*J-b*O-g*F)*T;c[6]=(Z*q-Y*ca+a*ea)*T;c[7]=(Y*ba-V*q-a*ia)*T;c[8]=(V*ca-Z*ba+a*da)*T;return c};R.str=
function(c){return"mat3("+c[0]+", "+c[1]+", "+c[2]+", "+c[3]+", "+c[4]+", "+c[5]+", "+c[6]+", "+c[7]+", "+c[8]+")"};R.frob=function(c){return Math.sqrt(Math.pow(c[0],2)+Math.pow(c[1],2)+Math.pow(c[2],2)+Math.pow(c[3],2)+Math.pow(c[4],2)+Math.pow(c[5],2)+Math.pow(c[6],2)+Math.pow(c[7],2)+Math.pow(c[8],2))};"undefined"!==typeof m&&(m.mat3=R);var I={create:function(){var c=new p(16);c[0]=1;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=1;c[6]=0;c[7]=0;c[8]=0;c[9]=0;c[10]=1;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;
return c},clone:function(c){var a=new p(16);a[0]=c[0];a[1]=c[1];a[2]=c[2];a[3]=c[3];a[4]=c[4];a[5]=c[5];a[6]=c[6];a[7]=c[7];a[8]=c[8];a[9]=c[9];a[10]=c[10];a[11]=c[11];a[12]=c[12];a[13]=c[13];a[14]=c[14];a[15]=c[15];return a},copy:function(c,a){c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];c[9]=a[9];c[10]=a[10];c[11]=a[11];c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c},identity:function(c){c[0]=1;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=1;c[6]=0;c[7]=
0;c[8]=0;c[9]=0;c[10]=1;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c},transpose:function(c,a){if(c===a){var b=a[1],d=a[2],f=a[3],g=a[6],l=a[7],A=a[11];c[1]=a[4];c[2]=a[8];c[3]=a[12];c[4]=b;c[6]=a[9];c[7]=a[13];c[8]=d;c[9]=g;c[11]=a[14];c[12]=f;c[13]=l;c[14]=A}else c[0]=a[0],c[1]=a[4],c[2]=a[8],c[3]=a[12],c[4]=a[1],c[5]=a[5],c[6]=a[9],c[7]=a[13],c[8]=a[2],c[9]=a[6],c[10]=a[10],c[11]=a[14],c[12]=a[3],c[13]=a[7],c[14]=a[11],c[15]=a[15];return c},invert:function(c,a){var b=a[0],d=a[1],f=a[2],g=a[3],
l=a[4],A=a[5],h=a[6],C=a[7],J=a[8],O=a[9],S=a[10],T=a[11],V=a[12],Z=a[13],Y=a[14];a=a[15];var da=b*A-d*l,ia=b*h-f*l,ba=b*C-g*l,ea=d*h-f*A,ca=d*C-g*A,q=f*C-g*h,F=J*Z-O*V,K=J*Y-S*V,Q=J*a-T*V,W=O*Y-S*Z,X=O*a-T*Z,fa=S*a-T*Y,ja=da*fa-ia*X+ba*W+ea*Q-ca*K+q*F;if(!ja)return null;ja=1/ja;c[0]=(A*fa-h*X+C*W)*ja;c[1]=(f*X-d*fa-g*W)*ja;c[2]=(Z*q-Y*ca+a*ea)*ja;c[3]=(S*ca-O*q-T*ea)*ja;c[4]=(h*Q-l*fa-C*K)*ja;c[5]=(b*fa-f*Q+g*K)*ja;c[6]=(Y*ba-V*q-a*ia)*ja;c[7]=(J*q-S*ba+T*ia)*ja;c[8]=(l*X-A*Q+C*F)*ja;c[9]=(d*Q-b*
X-g*F)*ja;c[10]=(V*ca-Z*ba+a*da)*ja;c[11]=(O*ba-J*ca-T*da)*ja;c[12]=(A*K-l*W-h*F)*ja;c[13]=(b*W-d*K+f*F)*ja;c[14]=(Z*ia-V*ea-Y*da)*ja;c[15]=(J*ea-O*ia+S*da)*ja;return c},adjoint:function(c,a){var b=a[0],d=a[1],f=a[2],g=a[3],l=a[4],A=a[5],h=a[6],C=a[7],J=a[8],O=a[9],S=a[10],T=a[11],V=a[12],Z=a[13],Y=a[14];a=a[15];c[0]=A*(S*a-T*Y)-O*(h*a-C*Y)+Z*(h*T-C*S);c[1]=-(d*(S*a-T*Y)-O*(f*a-g*Y)+Z*(f*T-g*S));c[2]=d*(h*a-C*Y)-A*(f*a-g*Y)+Z*(f*C-g*h);c[3]=-(d*(h*T-C*S)-A*(f*T-g*S)+O*(f*C-g*h));c[4]=-(l*(S*a-T*Y)-
J*(h*a-C*Y)+V*(h*T-C*S));c[5]=b*(S*a-T*Y)-J*(f*a-g*Y)+V*(f*T-g*S);c[6]=-(b*(h*a-C*Y)-l*(f*a-g*Y)+V*(f*C-g*h));c[7]=b*(h*T-C*S)-l*(f*T-g*S)+J*(f*C-g*h);c[8]=l*(O*a-T*Z)-J*(A*a-C*Z)+V*(A*T-C*O);c[9]=-(b*(O*a-T*Z)-J*(d*a-g*Z)+V*(d*T-g*O));c[10]=b*(A*a-C*Z)-l*(d*a-g*Z)+V*(d*C-g*A);c[11]=-(b*(A*T-C*O)-l*(d*T-g*O)+J*(d*C-g*A));c[12]=-(l*(O*Y-S*Z)-J*(A*Y-h*Z)+V*(A*S-h*O));c[13]=b*(O*Y-S*Z)-J*(d*Y-f*Z)+V*(d*S-f*O);c[14]=-(b*(A*Y-h*Z)-l*(d*Y-f*Z)+V*(d*h-f*A));c[15]=b*(A*S-h*O)-l*(d*S-f*O)+J*(d*h-f*A);return c},
determinant:function(c){var a=c[0],b=c[1],d=c[2],f=c[3],g=c[4],l=c[5],A=c[6],h=c[7],C=c[8],J=c[9],O=c[10],S=c[11],T=c[12],V=c[13],Z=c[14];c=c[15];return(a*l-b*g)*(O*c-S*Z)-(a*A-d*g)*(J*c-S*V)+(a*h-f*g)*(J*Z-O*V)+(b*A-d*l)*(C*c-S*T)-(b*h-f*l)*(C*Z-O*T)+(d*h-f*A)*(C*V-J*T)},multiply:function(c,a,b){var d=a[0],f=a[1],g=a[2],l=a[3],A=a[4],h=a[5],C=a[6],J=a[7],O=a[8],S=a[9],T=a[10],V=a[11],Z=a[12],Y=a[13],da=a[14];a=a[15];var ia=b[0],ba=b[1],ea=b[2],ca=b[3];c[0]=ia*d+ba*A+ea*O+ca*Z;c[1]=ia*f+ba*h+ea*S+
ca*Y;c[2]=ia*g+ba*C+ea*T+ca*da;c[3]=ia*l+ba*J+ea*V+ca*a;ia=b[4];ba=b[5];ea=b[6];ca=b[7];c[4]=ia*d+ba*A+ea*O+ca*Z;c[5]=ia*f+ba*h+ea*S+ca*Y;c[6]=ia*g+ba*C+ea*T+ca*da;c[7]=ia*l+ba*J+ea*V+ca*a;ia=b[8];ba=b[9];ea=b[10];ca=b[11];c[8]=ia*d+ba*A+ea*O+ca*Z;c[9]=ia*f+ba*h+ea*S+ca*Y;c[10]=ia*g+ba*C+ea*T+ca*da;c[11]=ia*l+ba*J+ea*V+ca*a;ia=b[12];ba=b[13];ea=b[14];ca=b[15];c[12]=ia*d+ba*A+ea*O+ca*Z;c[13]=ia*f+ba*h+ea*S+ca*Y;c[14]=ia*g+ba*C+ea*T+ca*da;c[15]=ia*l+ba*J+ea*V+ca*a;return c}};I.mul=I.multiply;I.translate=
function(c,a,b){var d=b[0],f=b[1];b=b[2];if(a===c)c[12]=a[0]*d+a[4]*f+a[8]*b+a[12],c[13]=a[1]*d+a[5]*f+a[9]*b+a[13],c[14]=a[2]*d+a[6]*f+a[10]*b+a[14],c[15]=a[3]*d+a[7]*f+a[11]*b+a[15];else{var g=a[0];var l=a[1];var A=a[2];var h=a[3];var C=a[4];var J=a[5];var O=a[6];var S=a[7];var T=a[8];var V=a[9];var Z=a[10];var Y=a[11];c[0]=g;c[1]=l;c[2]=A;c[3]=h;c[4]=C;c[5]=J;c[6]=O;c[7]=S;c[8]=T;c[9]=V;c[10]=Z;c[11]=Y;c[12]=g*d+C*f+T*b+a[12];c[13]=l*d+J*f+V*b+a[13];c[14]=A*d+O*f+Z*b+a[14];c[15]=h*d+S*f+Y*b+a[15]}return c};
I.scale=function(c,a,b){var d=b[0],f=b[1];b=b[2];c[0]=a[0]*d;c[1]=a[1]*d;c[2]=a[2]*d;c[3]=a[3]*d;c[4]=a[4]*f;c[5]=a[5]*f;c[6]=a[6]*f;c[7]=a[7]*f;c[8]=a[8]*b;c[9]=a[9]*b;c[10]=a[10]*b;c[11]=a[11]*b;c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c};I.rotate=function(c,a,b,d){var f=d[0],g=d[1];d=d[2];var l=Math.sqrt(f*f+g*g+d*d);if(Math.abs(l)<r)return null;l=1/l;f*=l;g*=l;d*=l;var A=Math.sin(b);var h=Math.cos(b);var C=1-h;b=a[0];l=a[1];var J=a[2];var O=a[3];var S=a[4];var T=a[5];var V=a[6];
var Z=a[7];var Y=a[8];var da=a[9];var ia=a[10];var ba=a[11];var ea=f*f*C+h;var ca=g*f*C+d*A;var q=d*f*C-g*A;var F=f*g*C-d*A;var K=g*g*C+h;var Q=d*g*C+f*A;var W=f*d*C+g*A;f=g*d*C-f*A;g=d*d*C+h;c[0]=b*ea+S*ca+Y*q;c[1]=l*ea+T*ca+da*q;c[2]=J*ea+V*ca+ia*q;c[3]=O*ea+Z*ca+ba*q;c[4]=b*F+S*K+Y*Q;c[5]=l*F+T*K+da*Q;c[6]=J*F+V*K+ia*Q;c[7]=O*F+Z*K+ba*Q;c[8]=b*W+S*f+Y*g;c[9]=l*W+T*f+da*g;c[10]=J*W+V*f+ia*g;c[11]=O*W+Z*f+ba*g;a!==c&&(c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]);return c};I.rotateX=function(c,
a,b){var d=Math.sin(b);b=Math.cos(b);var f=a[4],g=a[5],l=a[6],A=a[7],h=a[8],C=a[9],J=a[10],O=a[11];a!==c&&(c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]);c[4]=f*b+h*d;c[5]=g*b+C*d;c[6]=l*b+J*d;c[7]=A*b+O*d;c[8]=h*b-f*d;c[9]=C*b-g*d;c[10]=J*b-l*d;c[11]=O*b-A*d;return c};I.rotateY=function(c,a,b){var d=Math.sin(b);b=Math.cos(b);var f=a[0],g=a[1],l=a[2],A=a[3],h=a[8],C=a[9],J=a[10],O=a[11];a!==c&&(c[4]=a[4],c[5]=a[5],c[6]=a[6],c[7]=a[7],c[12]=a[12],c[13]=a[13],
c[14]=a[14],c[15]=a[15]);c[0]=f*b-h*d;c[1]=g*b-C*d;c[2]=l*b-J*d;c[3]=A*b-O*d;c[8]=f*d+h*b;c[9]=g*d+C*b;c[10]=l*d+J*b;c[11]=A*d+O*b;return c};I.rotateZ=function(c,a,b){var d=Math.sin(b);b=Math.cos(b);var f=a[0],g=a[1],l=a[2],A=a[3],h=a[4],C=a[5],J=a[6],O=a[7];a!==c&&(c[8]=a[8],c[9]=a[9],c[10]=a[10],c[11]=a[11],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]);c[0]=f*b+h*d;c[1]=g*b+C*d;c[2]=l*b+J*d;c[3]=A*b+O*d;c[4]=h*b-f*d;c[5]=C*b-g*d;c[6]=J*b-l*d;c[7]=O*b-A*d;return c};I.fromRotationTranslation=function(c,
a,b){var d=a[0],f=a[1],g=a[2],l=a[3],A=d+d,h=f+f,C=g+g;a=d*A;var J=d*h;d*=C;var O=f*h;f*=C;g*=C;A*=l;h*=l;l*=C;c[0]=1-(O+g);c[1]=J+l;c[2]=d-h;c[3]=0;c[4]=J-l;c[5]=1-(a+g);c[6]=f+A;c[7]=0;c[8]=d+h;c[9]=f-A;c[10]=1-(a+O);c[11]=0;c[12]=b[0];c[13]=b[1];c[14]=b[2];c[15]=1;return c};I.fromQuat=function(c,a){var b=a[0],d=a[1],f=a[2];a=a[3];var g=b+b,l=d+d,A=f+f;b*=g;var h=d*g;d*=l;var C=f*g,J=f*l;f*=A;g*=a;l*=a;a*=A;c[0]=1-d-f;c[1]=h+a;c[2]=C-l;c[3]=0;c[4]=h-a;c[5]=1-b-f;c[6]=J+g;c[7]=0;c[8]=C+l;c[9]=J-
g;c[10]=1-b-d;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};I.frustum=function(c,a,b,d,f,g,l){var A=1/(b-a),h=1/(f-d),C=1/(g-l);c[0]=2*g*A;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=2*g*h;c[6]=0;c[7]=0;c[8]=(b+a)*A;c[9]=(f+d)*h;c[10]=(l+g)*C;c[11]=-1;c[12]=0;c[13]=0;c[14]=l*g*2*C;c[15]=0;return c};I.perspective=function(c,a,b,d,f){a=1/Math.tan(a/2);var g=1/(d-f);c[0]=a/b;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=a;c[6]=0;c[7]=0;c[8]=0;c[9]=0;c[10]=(f+d)*g;c[11]=-1;c[12]=0;c[13]=0;c[14]=2*f*d*g;c[15]=0;return c};
I.ortho=function(c,a,b,d,f,g,l){var A=1/(a-b),h=1/(d-f),C=1/(g-l);c[0]=-2*A;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=-2*h;c[6]=0;c[7]=0;c[8]=0;c[9]=0;c[10]=2*C;c[11]=0;c[12]=(a+b)*A;c[13]=(f+d)*h;c[14]=(l+g)*C;c[15]=1;return c};I.lookAt=function(c,a,b,d){var f=a[0],g=a[1];a=a[2];var l=d[0];var A=d[1];var h=d[2];var C=b[0];d=b[1];var J=b[2];if(Math.abs(f-C)<r&&Math.abs(g-d)<r&&Math.abs(a-J)<r)return I.identity(c);b=f-C;d=g-d;C=a-J;var O=1/Math.sqrt(b*b+d*d+C*C);b*=O;d*=O;C*=O;J=A*C-h*d;h=h*b-l*C;l=l*d-A*b;
(O=Math.sqrt(J*J+h*h+l*l))?(O=1/O,J*=O,h*=O,l*=O):l=h=J=0;A=d*l-C*h;var S=C*J-b*l;var T=b*h-d*J;(O=Math.sqrt(A*A+S*S+T*T))?(O=1/O,A*=O,S*=O,T*=O):T=S=A=0;c[0]=J;c[1]=A;c[2]=b;c[3]=0;c[4]=h;c[5]=S;c[6]=d;c[7]=0;c[8]=l;c[9]=T;c[10]=C;c[11]=0;c[12]=-(J*f+h*g+l*a);c[13]=-(A*f+S*g+T*a);c[14]=-(b*f+d*g+C*a);c[15]=1;return c};I.str=function(c){return"mat4("+c[0]+", "+c[1]+", "+c[2]+", "+c[3]+", "+c[4]+", "+c[5]+", "+c[6]+", "+c[7]+", "+c[8]+", "+c[9]+", "+c[10]+", "+c[11]+", "+c[12]+", "+c[13]+", "+c[14]+
", "+c[15]+")"};I.frob=function(c){return Math.sqrt(Math.pow(c[0],2)+Math.pow(c[1],2)+Math.pow(c[2],2)+Math.pow(c[3],2)+Math.pow(c[4],2)+Math.pow(c[5],2)+Math.pow(c[6],2)+Math.pow(c[6],2)+Math.pow(c[7],2)+Math.pow(c[8],2)+Math.pow(c[9],2)+Math.pow(c[10],2)+Math.pow(c[11],2)+Math.pow(c[12],2)+Math.pow(c[13],2)+Math.pow(c[14],2)+Math.pow(c[15],2))};"undefined"!==typeof m&&(m.mat4=I);var B={create:function(){var c=new p(4);c[0]=0;c[1]=0;c[2]=0;c[3]=1;return c}};B.rotationTo=function(){var c=w.create(),
a=w.fromValues(1,0,0),b=w.fromValues(0,1,0);return function(d,f,g){var l=w.dot(f,g);if(-.999999>l)return w.cross(c,a,f),1E-6>w.length(c)&&w.cross(c,b,f),w.normalize(c,c),B.setAxisAngle(d,c,Math.PI),d;if(.999999<l)return d[0]=0,d[1]=0,d[2]=0,d[3]=1,d;w.cross(c,f,g);d[0]=c[0];d[1]=c[1];d[2]=c[2];d[3]=1+l;return B.normalize(d,d)}}();B.setAxes=function(){var c=R.create();return function(a,b,d,f){c[0]=d[0];c[3]=d[1];c[6]=d[2];c[1]=f[0];c[4]=f[1];c[7]=f[2];c[2]=-b[0];c[5]=-b[1];c[8]=-b[2];return B.normalize(a,
B.fromMat3(a,c))}}();B.clone=N.clone;B.fromValues=N.fromValues;B.copy=N.copy;B.set=N.set;B.identity=function(c){c[0]=0;c[1]=0;c[2]=0;c[3]=1;return c};B.setAxisAngle=function(c,a,b){b*=.5;var d=Math.sin(b);c[0]=d*a[0];c[1]=d*a[1];c[2]=d*a[2];c[3]=Math.cos(b);return c};B.add=N.add;B.multiply=function(c,a,b){var d=a[0],f=a[1],g=a[2];a=a[3];var l=b[0],A=b[1],h=b[2];b=b[3];c[0]=d*b+a*l+f*h-g*A;c[1]=f*b+a*A+g*l-d*h;c[2]=g*b+a*h+d*A-f*l;c[3]=a*b-d*l-f*A-g*h;return c};B.mul=B.multiply;B.scale=N.scale;B.rotateX=
function(c,a,b){b*=.5;var d=a[0],f=a[1],g=a[2];a=a[3];var l=Math.sin(b);b=Math.cos(b);c[0]=d*b+a*l;c[1]=f*b+g*l;c[2]=g*b-f*l;c[3]=a*b-d*l;return c};B.rotateY=function(c,a,b){b*=.5;var d=a[0],f=a[1],g=a[2];a=a[3];var l=Math.sin(b);b=Math.cos(b);c[0]=d*b-g*l;c[1]=f*b+a*l;c[2]=g*b+d*l;c[3]=a*b-f*l;return c};B.rotateZ=function(c,a,b){b*=.5;var d=a[0],f=a[1],g=a[2];a=a[3];var l=Math.sin(b);b=Math.cos(b);c[0]=d*b+f*l;c[1]=f*b-d*l;c[2]=g*b+a*l;c[3]=a*b-g*l;return c};B.calculateW=function(c,a){var b=a[0],
d=a[1];a=a[2];c[0]=b;c[1]=d;c[2]=a;c[3]=-Math.sqrt(Math.abs(1-b*b-d*d-a*a));return c};B.dot=N.dot;B.lerp=N.lerp;B.slerp=function(c,a,b,d){var f=a[0],g=a[1],l=a[2];a=a[3];var A=b[0],h=b[1],C=b[2];b=b[3];var J=f*A+g*h+l*C+a*b;0>J&&(J=-J,A=-A,h=-h,C=-C,b=-b);if(1E-6<1-J){var O=Math.acos(J);var S=Math.sin(O);J=Math.sin((1-d)*O)/S;d=Math.sin(d*O)/S}else J=1-d;c[0]=J*f+d*A;c[1]=J*g+d*h;c[2]=J*l+d*C;c[3]=J*a+d*b;return c};B.invert=function(c,a){var b=a[0],d=a[1],f=a[2];a=a[3];var g=b*b+d*d+f*f+a*a;g=g?1/
g:0;c[0]=-b*g;c[1]=-d*g;c[2]=-f*g;c[3]=a*g;return c};B.conjugate=function(c,a){c[0]=-a[0];c[1]=-a[1];c[2]=-a[2];c[3]=a[3];return c};B.length=N.length;B.len=B.length;B.squaredLength=N.squaredLength;B.sqrLen=B.squaredLength;B.normalize=N.normalize;B.fromMat3=function(c,a){var b=a[0]+a[4]+a[8];if(0<b)b=Math.sqrt(b+1),c[3]=.5*b,b=.5/b,c[0]=(a[7]-a[5])*b,c[1]=(a[2]-a[6])*b,c[2]=(a[3]-a[1])*b;else{var d=0;a[4]>a[0]&&(d=1);a[8]>a[3*d+d]&&(d=2);var f=(d+1)%3,g=(d+2)%3;b=Math.sqrt(a[3*d+d]-a[3*f+f]-a[3*g+
g]+1);c[d]=.5*b;b=.5/b;c[3]=(a[3*g+f]-a[3*f+g])*b;c[f]=(a[3*f+d]+a[3*d+f])*b;c[g]=(a[3*g+d]+a[3*d+g])*b}return c};B.str=function(c){return"quat("+c[0]+", "+c[1]+", "+c[2]+", "+c[3]+")"};"undefined"!==typeof m&&(m.quat=B)})("undefined"===typeof H?"undefined"!==typeof window?window:u:H)})(this)},{}],23:[function(e,n,H){function u(){throw Error("setTimeout has not been defined");}function m(){throw Error("clearTimeout has not been defined");}function r(a){if(w===setTimeout)return setTimeout(a,0);if((w===
u||!w)&&setTimeout)return w=setTimeout,setTimeout(a,0);try{return w(a,0)}catch(b){try{return w.call(null,a,0)}catch(d){return w.call(this,a,0)}}}function p(a){if(N===clearTimeout)return clearTimeout(a);if((N===m||!N)&&clearTimeout)return N=clearTimeout,clearTimeout(a);try{return N(a)}catch(b){try{return N.call(null,a)}catch(d){return N.call(this,a)}}}function G(){I&&B&&(I=!1,B.length?R=B.concat(R):c=-1,R.length&&v())}function v(){if(!I){var a=r(G);I=!0;for(var b=R.length;b;){B=R;for(R=[];++c<b;)B&&
B[c].run();c=-1;b=R.length}B=null;I=!1;p(a)}}function M(a,b){this.fun=a;this.array=b}function E(){}e=n.exports={};try{var w="function"===typeof setTimeout?setTimeout:u}catch(a){w=u}try{var N="function"===typeof clearTimeout?clearTimeout:m}catch(a){N=m}var R=[],I=!1,B,c=-1;e.nextTick=function(a){var b=Array(arguments.length-1);if(1<arguments.length)for(var d=1;d<arguments.length;d++)b[d-1]=arguments[d];R.push(new M(a,b));1!==R.length||I||r(v)};M.prototype.run=function(){this.fun.apply(null,this.array)};
e.title="browser";e.browser=!0;e.env={};e.argv=[];e.version="";e.versions={};e.on=E;e.addListener=E;e.once=E;e.off=E;e.removeListener=E;e.removeAllListeners=E;e.emit=E;e.prependListener=E;e.prependOnceListener=E;e.listeners=function(a){return[]};e.binding=function(a){throw Error("process.binding is not supported");};e.cwd=function(){return"/"};e.chdir=function(a){throw Error("process.chdir is not supported");};e.umask=function(){return 0}},{}],24:[function(e,n,H){(function(u){(function(){(function(m,
r){"object"===typeof H&&"undefined"!==typeof n?n.exports=r():(m="undefined"!==typeof globalThis?globalThis:m||self,function(){var p=m._,G=m._=r();G.noConflict=function(){m._=p;return G}}())})(this,function(){function m(k,t){t=null==t?k.length-1:+t;return function(){for(var D=Math.max(arguments.length-t,0),L=Array(D),P=0;P<D;P++)L[P]=arguments[P+t];switch(t){case 0:return k.call(this,L);case 1:return k.call(this,arguments[0],L);case 2:return k.call(this,arguments[0],arguments[1],L)}D=Array(t+1);for(P=
0;P<t;P++)D[P]=arguments[P];D[t]=L;return k.apply(this,D)}}function r(k){var t=typeof k;return"function"===t||"object"===t&&!!k}function p(k){return void 0===k}function G(k){return!0===k||!1===k||"[object Boolean]"===za.call(k)}function v(k){var t="[object "+k+"]";return function(D){return za.call(D)===t}}function M(k){return null!=k&&oa(k.getInt8)&&ab(k.buffer)}function E(k,t){return null!=k&&Mb.call(k,t)}function w(k){return bb(k)&&Nb(k)}function N(k){return function(){return k}}function R(k){return function(t){t=
k(t);return"number"==typeof t&&0<=t&&t<=Ob}}function I(k){return function(t){return null==t?void 0:t[k]}}function B(k){return cb?cb(k)&&!Ea(k):Pb(k)&&Qb.test(za.call(k))}function c(k){for(var t={},D=k.length,L=0;L<D;++L)t[k[L]]=!0;return{contains:function(P){return t[P]},push:function(P){t[P]=!0;return k.push(P)}}}function a(k,t){t=c(t);var D=db.length,L=k.constructor;L=oa(L)&&L.prototype||Ka;var P="constructor";for(E(k,P)&&!t.contains(P)&&t.push(P);D--;)P=db[D],P in k&&k[P]!==L[P]&&!t.contains(P)&&
t.push(P)}function b(k){if(!r(k))return[];if(eb)return eb(k);var t=[],D;for(D in k)E(k,D)&&t.push(D);fb&&a(k,t);return t}function d(k,t){var D=b(t),L=D.length;if(null==k)return!L;k=Object(k);for(var P=0;P<L;P++){var U=D[P];if(t[U]!==k[U]||!(U in k))return!1}return!0}function f(k){if(k instanceof f)return k;if(!(this instanceof f))return new f(k);this._wrapped=k}function g(k,t,D,L){if(k===t)return 0!==k||1/k===1/t;if(null==k||null==t)return!1;if(k!==k)return t!==t;var P=typeof k;return"function"!==
P&&"object"!==P&&"object"!=typeof t?!1:l(k,t,D,L)}function l(k,t,D,L){k instanceof f&&(k=k._wrapped);t instanceof f&&(t=t._wrapped);var P=za.call(k);if(P!==za.call(t))return!1;if(gb&&"[object Object]"==P&&Ea(k)){if(!Ea(t))return!1;P="[object DataView]"}switch(P){case "[object RegExp]":case "[object String]":return""+k===""+t;case "[object Number]":return+k!==+k?+t!==+t:0===+k?1/+k===1/t:+k===+t;case "[object Date]":case "[object Boolean]":return+k===+t;case "[object Symbol]":return hb.valueOf.call(k)===
hb.valueOf.call(t);case "[object ArrayBuffer]":case "[object DataView]":return l(new Uint8Array(k.buffer||k,k.byteOffset||0,Aa(k)),new Uint8Array(t.buffer||t,t.byteOffset||0,Aa(t)),D,L)}P="[object Array]"===P;if(!P&&ib(k)){if(Aa(k)!==Aa(t))return!1;if(k.buffer===t.buffer&&k.byteOffset===t.byteOffset)return!0;P=!0}if(!P){if("object"!=typeof k||"object"!=typeof t)return!1;var U=k.constructor,aa=t.constructor;if(U!==aa&&!(oa(U)&&U instanceof U&&oa(aa)&&aa instanceof aa)&&"constructor"in k&&"constructor"in
t)return!1}D=D||[];L=L||[];for(U=D.length;U--;)if(D[U]===k)return L[U]===t;D.push(k);L.push(t);if(P){U=k.length;if(U!==t.length)return!1;for(;U--;)if(!g(k[U],t[U],D,L))return!1}else{P=b(k);U=P.length;if(b(t).length!==U)return!1;for(;U--;)if(aa=P[U],!E(t,aa)||!g(k[aa],t[aa],D,L))return!1}D.pop();L.pop();return!0}function A(k){if(!r(k))return[];var t=[],D;for(D in k)t.push(D);fb&&a(k,t);return t}function h(k){var t=qa(k);return function(D){if(null==D)return!1;var L=A(D);if(qa(L))return!1;for(L=0;L<
t;L++)if(!oa(D[k[L]]))return!1;return k!==jb||!oa(D[La])}}function C(k){for(var t=b(k),D=t.length,L=Array(D),P=0;P<D;P++)L[P]=k[t[P]];return L}function J(k){for(var t={},D=b(k),L=0,P=D.length;L<P;L++)t[k[D[L]]]=D[L];return t}function O(k){var t=[],D;for(D in k)oa(k[D])&&t.push(D);return t.sort()}function S(k,t){return function(D){var L=arguments.length;t&&(D=Object(D));if(2>L||null==D)return D;for(var P=1;P<L;P++)for(var U=arguments[P],aa=k(U),ha=aa.length,la=0;la<ha;la++){var na=aa[la];t&&void 0!==
D[na]||(D[na]=U[na])}return D}}function T(){return function(){}}function V(k){if(!r(k))return{};if(kb)return kb(k);var t=T();t.prototype=k;k=new t;t.prototype=null;return k}function Z(k){return r(k)?ua(k)?k.slice():lb({},k):k}function Y(k){return ua(k)?k:[k]}function da(k,t){for(var D=t.length,L=0;L<D;L++){if(null==k)return;k=k[t[L]]}return D?k:void 0}function ia(k,t,D){k=da(k,f.toPath(t));return p(k)?D:k}function ba(k){return k}function ea(k){k=Fa({},k);return function(t){return d(t,k)}}function ca(k){k=
f.toPath(k);return function(t){return da(t,k)}}function q(k,t,D){if(void 0===t)return k;switch(null==D?3:D){case 1:return function(L){return k.call(t,L)};case 3:return function(L,P,U){return k.call(t,L,P,U)};case 4:return function(L,P,U,aa){return k.call(t,L,P,U,aa)}}return function(){return k.apply(t,arguments)}}function F(k,t,D){return null==k?ba:oa(k)?q(k,t,D):r(k)&&!ua(k)?ea(k):ca(k)}function K(k,t){return F(k,t,Infinity)}function Q(k,t,D){return f.iteratee!==K?f.iteratee(k,t):F(k,t,D)}function W(){}
function X(k,t){null==t&&(t=k,k=0);return k+Math.floor(Math.random()*(t-k+1))}function fa(k){var t=function(U){return k[U]},D="(?:"+b(k).join("|")+")",L=RegExp(D),P=RegExp(D,"g");return function(U){U=null==U?"":""+U;return L.test(U)?U.replace(P,t):U}}function ja(k){return"\\"+Rb[k]}function ka(k,t,D,L,P){if(!(L instanceof t))return k.apply(D,P);t=V(k.prototype);k=k.apply(t,P);return r(k)?k:t}function pa(k,t,D,L){L=L||[];if(!t&&0!==t)t=Infinity;else if(0>=t)return L.concat(k);for(var P=L.length,U=
0,aa=qa(k);U<aa;U++){var ha=k[U];if(ra(ha)&&(ua(ha)||Ma(ha)))if(1<t)pa(ha,t-1,D,L),P=L.length;else for(var la=0,na=ha.length;la<na;)L[P++]=ha[la++];else D||(L[P++]=ha)}return L}function wa(k){return function(){return!k.apply(this,arguments)}}function Ba(k,t){var D;return function(){0<--k&&(D=t.apply(this,arguments));1>=k&&(t=null);return D}}function Ga(k,t,D){t=Q(t,D);D=b(k);for(var L,P=0,U=D.length;P<U;P++)if(L=D[P],t(k[L],L,k))return L}function mb(k){return function(t,D,L){D=Q(D,L);L=qa(t);for(var P=
0<k?0:L-1;0<=P&&P<L;P+=k)if(D(t[P],P,t))return P;return-1}}function nb(k,t,D,L){D=Q(D,L,1);t=D(t);L=0;for(var P=qa(k);L<P;){var U=Math.floor((L+P)/2);D(k[U])<t?L=U+1:P=U}return L}function ob(k,t,D){return function(L,P,U){var aa=0,ha=qa(L);if("number"==typeof U)0<k?aa=0<=U?U:Math.max(U+ha,aa):ha=0<=U?Math.min(U+1,ha):U+ha+1;else if(D&&U&&ha)return U=D(L,P),L[U]===P?U:-1;if(P!==P)return U=t(Ca.call(L,aa,ha),w),0<=U?U+aa:-1;for(U=0<k?aa:ha-1;0<=U&&U<ha;U+=k)if(L[U]===P)return U;return-1}}function Na(k,
t,D){t=(ra(k)?Oa:Ga)(k,t,D);if(void 0!==t&&-1!==t)return k[t]}function sa(k,t,D){t=q(t,D);var L;if(ra(k))for(D=0,L=k.length;D<L;D++)t(k[D],D,k);else{var P=b(k);D=0;for(L=P.length;D<L;D++)t(k[P[D]],P[D],k)}return k}function va(k,t,D){t=Q(t,D);D=!ra(k)&&b(k);for(var L=(D||k).length,P=Array(L),U=0;U<L;U++){var aa=D?D[U]:U;P[U]=t(k[aa],aa,k)}return P}function pb(k){return function(t,D,L,P){var U=3<=arguments.length,aa=q(D,P,4),ha=L,la=!ra(t)&&b(t),na=(la||t).length,ma=0<k?0:na-1;U||(ha=t[la?la[ma]:ma],
ma+=k);for(;0<=ma&&ma<na;ma+=k)U=la?la[ma]:ma,ha=aa(ha,t[U],U,t);return ha}}function xa(k,t,D){var L=[];t=Q(t,D);sa(k,function(P,U,aa){t(P,U,aa)&&L.push(P)});return L}function qb(k,t,D){t=Q(t,D);D=!ra(k)&&b(k);for(var L=(D||k).length,P=0;P<L;P++){var U=D?D[P]:P;if(!t(k[U],U,k))return!1}return!0}function rb(k,t,D){t=Q(t,D);D=!ra(k)&&b(k);for(var L=(D||k).length,P=0;P<L;P++){var U=D?D[P]:P;if(t(k[U],U,k))return!0}return!1}function ta(k,t,D,L){ra(k)||(k=C(k));if("number"!=typeof D||L)D=0;return 0<=sb(k,
t,D)}function Pa(k,t){return va(k,ca(t))}function tb(k,t,D){var L=-Infinity,P=-Infinity,U;if(null==t||"number"==typeof t&&"object"!=typeof k[0]&&null!=k){k=ra(k)?k:C(k);for(var aa=0,ha=k.length;aa<ha;aa++)D=k[aa],null!=D&&D>L&&(L=D)}else t=Q(t,D),sa(k,function(la,na,ma){U=t(la,na,ma);if(U>P||-Infinity===U&&-Infinity===L)L=la,P=U});return L}function ub(k,t,D){if(null==t||D)return ra(k)||(k=C(k)),k[X(k.length-1)];k=ra(k)?Z(k):C(k);D=qa(k);t=Math.max(Math.min(t,D),0);--D;for(var L=0;L<t;L++){var P=X(L,
D),U=k[L];k[L]=k[P];k[P]=U}return k.slice(0,t)}function Ha(k,t){return function(D,L,P){var U=t?[[],[]]:{};L=Q(L,P);sa(D,function(aa,ha){ha=L(aa,ha,D);k(U,aa,ha)});return U}}function Sb(k,t,D){return t in D}function vb(k,t,D){return Ca.call(k,0,Math.max(0,k.length-(null==t||D?1:t)))}function Qa(k,t,D){return null==k||1>k.length?null==t||D?void 0:[]:null==t||D?k[0]:vb(k,k.length-t)}function Ia(k,t,D){return Ca.call(k,null==t||D?1:t)}function Ra(k,t,D,L){G(t)||(L=D,D=t,t=!1);null!=D&&(D=Q(D,L));L=[];
for(var P=[],U=0,aa=qa(k);U<aa;U++){var ha=k[U],la=D?D(ha,U,k):ha;t&&!D?(U&&P===la||L.push(ha),P=la):D?ta(P,la)||(P.push(la),L.push(ha)):ta(L,ha)||L.push(ha)}return L}function Sa(k){for(var t=k&&tb(k,qa).length||0,D=Array(t),L=0;L<t;L++)D[L]=Pa(k,L);return D}function Ta(k,t){return k._chain?f(t).chain():t}function wb(k){sa(O(k),function(t){var D=f[t]=k[t];f.prototype[t]=function(){var L=[this._wrapped];Tb.apply(L,arguments);return Ta(this,D.apply(f,L))}});return f}var xb="object"==typeof self&&self.self===
self&&self||"object"==typeof u&&u.global===u&&u||Function("return this")()||{},Ja=Array.prototype,Ka=Object.prototype,hb="undefined"!==typeof Symbol?Symbol.prototype:null,Tb=Ja.push,Ca=Ja.slice,za=Ka.toString,Mb=Ka.hasOwnProperty,yb="undefined"!==typeof ArrayBuffer,Ub="undefined"!==typeof DataView,Vb=Array.isArray,eb=Object.keys,kb=Object.create,cb=yb&&ArrayBuffer.isView,Nb=isNaN,Wb=isFinite,fb=!{toString:null}.propertyIsEnumerable("toString"),db="valueOf isPrototypeOf toString propertyIsEnumerable hasOwnProperty toLocaleString".split(" "),
Ob=Math.pow(2,53)-1,Ua=v("String"),bb=v("Number"),Xb=v("Date"),Yb=v("RegExp"),Zb=v("Error"),zb=v("Symbol"),ab=v("ArrayBuffer"),Ab=v("Function"),$b=xb.document&&xb.document.childNodes;"function"!=typeof/./&&"object"!=typeof Int8Array&&"function"!=typeof $b&&(Ab=function(k){return"function"==typeof k||!1});var oa=Ab,Bb=v("Object"),gb=Ub&&Bb(new DataView(new ArrayBuffer(8))),Va="undefined"!==typeof Map&&Bb(new Map),ac=v("DataView"),Ea=gb?M:ac,ua=Vb||v("Array"),Wa=v("Arguments");(function(){Wa(arguments)||
(Wa=function(k){return E(k,"callee")})})();var Ma=Wa,Aa=I("byteLength"),Pb=R(Aa),Qb=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/,ib=yb?B:N(!1),qa=I("length");f.VERSION="1.13.1";f.prototype.value=function(){return this._wrapped};f.prototype.valueOf=f.prototype.toJSON=f.prototype.value;f.prototype.toString=function(){return String(this._wrapped)};var La="forEach",Xa=["clear","delete"],Cb=["get","has","set"],bc=Xa.concat(La,Cb),jb=Xa.concat(Cb),cc=["add"].concat(Xa,La,
"has"),dc=Va?h(bc):v("Map"),ec=Va?h(jb):v("WeakMap"),fc=Va?h(cc):v("Set"),gc=v("WeakSet"),lb=S(A),Fa=S(b),Db=S(A,!0);f.toPath=Y;f.iteratee=K;var Da=Date.now||function(){return(new Date).getTime()},Eb={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},hc=fa(Eb),ic=J(Eb),jc=fa(ic),kc=f.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},Ya=/(.)^/,Rb={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},lc=/\\|'|\r|\n|\u2028|\u2029/g,
mc=/^\s*(\w|\$)+\s*$/,nc=0,ya=m(function(k,t){var D=ya.placeholder,L=function(){for(var P=0,U=t.length,aa=Array(U),ha=0;ha<U;ha++)aa[ha]=t[ha]===D?arguments[P++]:t[ha];for(;P<arguments.length;)aa.push(arguments[P++]);return ka(k,L,this,this,aa)};return L});ya.placeholder=f;var Fb=m(function(k,t,D){if(!oa(k))throw new TypeError("Bind must be called on a function");var L=m(function(P){return ka(k,L,t,this,D.concat(P))});return L}),ra=R(qa),oc=m(function(k,t){t=pa(t,!1,!1);var D=t.length;if(1>D)throw Error("bindAll must be passed function names");
for(;D--;){var L=t[D];k[L]=Fb(k[L],k)}return k}),Gb=m(function(k,t,D){return setTimeout(function(){return k.apply(null,D)},t)}),pc=ya(Gb,f,1),qc=ya(Ba,2),Oa=mb(1),Hb=mb(-1),sb=ob(1,Oa,nb),rc=ob(-1,Hb),Za=pb(1),Ib=pb(-1),sc=m(function(k,t,D){if(oa(t))var L=t;else{t=f.toPath(t);var P=t.slice(0,-1);t=t[t.length-1]}return va(k,function(U){var aa=L;if(!aa){P&&P.length&&(U=da(U,P));if(null==U)return;aa=U[t]}return null==aa?aa:aa.apply(U,D)})}),tc=Ha(function(k,t,D){E(k,D)?k[D].push(t):k[D]=[t]}),uc=Ha(function(k,
t,D){k[D]=t}),vc=Ha(function(k,t,D){E(k,D)?k[D]++:k[D]=1}),wc=Ha(function(k,t,D){k[D?0:1].push(t)},!0),xc=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g,Jb=m(function(k,t){var D={},L=t[0];if(null==k)return D;oa(L)?(1<t.length&&(L=q(L,t[1])),t=A(k)):(L=Sb,t=pa(t,!1,!1),k=Object(k));for(var P=0,U=t.length;P<U;P++){var aa=t[P],ha=k[aa];L(ha,aa,k)&&(D[aa]=ha)}return D}),yc=m(function(k,t){var D=t[0],L;oa(D)?(D=wa(D),1<t.length&&(L=t[1])):(t=va(pa(t,!1,!1),String),D=function(P,U){return!ta(t,
U)});return Jb(k,D,L)}),Kb=m(function(k,t){t=pa(t,!0,!0);return xa(k,function(D){return!ta(t,D)})}),zc=m(function(k,t){return Kb(k,t)}),Ac=m(function(k){return Ra(pa(k,!0,!0))}),Bc=m(Sa);sa("pop push reverse shift sort splice unshift".split(" "),function(k){var t=Ja[k];f.prototype[k]=function(){var D=this._wrapped;null!=D&&(t.apply(D,arguments),"shift"!==k&&"splice"!==k||0!==D.length||delete D[0]);return Ta(this,D)}});sa(["concat","join","slice"],function(k){var t=Ja[k];f.prototype[k]=function(){var D=
this._wrapped;null!=D&&(D=t.apply(D,arguments));return Ta(this,D)}});var Lb=wb({__proto__:null,VERSION:"1.13.1",restArguments:m,isObject:r,isNull:function(k){return null===k},isUndefined:p,isBoolean:G,isElement:function(k){return!(!k||1!==k.nodeType)},isString:Ua,isNumber:bb,isDate:Xb,isRegExp:Yb,isError:Zb,isSymbol:zb,isArrayBuffer:ab,isDataView:Ea,isArray:ua,isFunction:oa,isArguments:Ma,isFinite:function(k){return!zb(k)&&Wb(k)&&!isNaN(parseFloat(k))},isNaN:w,isTypedArray:ib,isEmpty:function(k){if(null==
k)return!0;var t=qa(k);return"number"==typeof t&&(ua(k)||Ua(k)||Ma(k))?0===t:0===qa(b(k))},isMatch:d,isEqual:function(k,t){return g(k,t)},isMap:dc,isWeakMap:ec,isSet:fc,isWeakSet:gc,keys:b,allKeys:A,values:C,pairs:function(k){for(var t=b(k),D=t.length,L=Array(D),P=0;P<D;P++)L[P]=[t[P],k[t[P]]];return L},invert:J,functions:O,methods:O,extend:lb,extendOwn:Fa,assign:Fa,defaults:Db,create:function(k,t){k=V(k);t&&Fa(k,t);return k},clone:Z,tap:function(k,t){t(k);return k},get:ia,has:function(k,t){t=f.toPath(t);
for(var D=t.length,L=0;L<D;L++){var P=t[L];if(!E(k,P))return!1;k=k[P]}return!!D},mapObject:function(k,t,D){t=Q(t,D);D=b(k);for(var L=D.length,P={},U=0;U<L;U++){var aa=D[U];P[aa]=t(k[aa],aa,k)}return P},identity:ba,constant:N,noop:W,toPath:Y,property:ca,propertyOf:function(k){return null==k?W:function(t){return ia(k,t)}},matcher:ea,matches:ea,times:function(k,t,D){var L=Array(Math.max(0,k));t=q(t,D,1);for(D=0;D<k;D++)L[D]=t(D);return L},random:X,now:Da,escape:hc,unescape:jc,templateSettings:kc,template:function(k,
t,D){!t&&D&&(t=D);t=Db({},t,f.templateSettings);D=RegExp([(t.escape||Ya).source,(t.interpolate||Ya).source,(t.evaluate||Ya).source].join("|")+"|$","g");var L=0,P="__p+='";k.replace(D,function(aa,ha,la,na,ma){P+=k.slice(L,ma).replace(lc,ja);L=ma+aa.length;ha?P+="'+\n((__t=("+ha+"))==null?'':_.escape(__t))+\n'":la?P+="'+\n((__t=("+la+"))==null?'':__t)+\n'":na&&(P+="';\n"+na+"\n__p+='");return aa});P+="';\n";if(t=t.variable){if(!mc.test(t))throw Error("variable is not a bare identifier: "+t);}else P=
"with(obj||{}){\n"+P+"}\n",t="obj";P="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+P+"return __p;\n";try{var U=new Function(t,"_",P)}catch(aa){throw aa.source=P,aa;}D=function(aa){return U.call(this,aa,f)};D.source="function("+t+"){\n"+P+"}";return D},result:function(k,t,D){t=f.toPath(t);var L=t.length;if(!L)return oa(D)?D.call(k):D;for(var P=0;P<L;P++){var U=null==k?void 0:k[t[P]];void 0===U&&(U=D,P=L);k=oa(U)?U.call(k):U}return k},uniqueId:function(k){var t=
++nc+"";return k?k+t:t},chain:function(k){k=f(k);k._chain=!0;return k},iteratee:K,partial:ya,bind:Fb,bindAll:oc,memoize:function(k,t){var D=function(L){var P=D.cache,U=""+(t?t.apply(this,arguments):L);E(P,U)||(P[U]=k.apply(this,arguments));return P[U]};D.cache={};return D},delay:Gb,defer:pc,throttle:function(k,t,D){var L,P,U,aa,ha=0;D||(D={});var la=function(){ha=!1===D.leading?0:Da();L=null;aa=k.apply(P,U);L||(P=U=null)},na=function(){var ma=Da();ha||!1!==D.leading||(ha=ma);var $a=t-(ma-ha);P=this;
U=arguments;0>=$a||$a>t?(L&&(clearTimeout(L),L=null),ha=ma,aa=k.apply(P,U),L||(P=U=null)):L||!1===D.trailing||(L=setTimeout(la,$a));return aa};na.cancel=function(){clearTimeout(L);ha=0;L=P=U=null};return na},debounce:function(k,t,D){var L,P,U,aa,ha,la=function(){var ma=Da()-P;t>ma?L=setTimeout(la,t-ma):(L=null,D||(aa=k.apply(ha,U)),L||(U=ha=null))},na=m(function(ma){ha=this;U=ma;P=Da();L||(L=setTimeout(la,t),D&&(aa=k.apply(ha,U)));return aa});na.cancel=function(){clearTimeout(L);L=U=ha=null};return na},
wrap:function(k,t){return ya(t,k)},negate:wa,compose:function(){var k=arguments,t=k.length-1;return function(){for(var D=t,L=k[t].apply(this,arguments);D--;)L=k[D].call(this,L);return L}},after:function(k,t){return function(){if(1>--k)return t.apply(this,arguments)}},before:Ba,once:qc,findKey:Ga,findIndex:Oa,findLastIndex:Hb,sortedIndex:nb,indexOf:sb,lastIndexOf:rc,find:Na,detect:Na,findWhere:function(k,t){return Na(k,ea(t))},each:sa,forEach:sa,map:va,collect:va,reduce:Za,foldl:Za,inject:Za,reduceRight:Ib,
foldr:Ib,filter:xa,select:xa,reject:function(k,t,D){return xa(k,wa(Q(t)),D)},every:qb,all:qb,some:rb,any:rb,contains:ta,includes:ta,include:ta,invoke:sc,pluck:Pa,where:function(k,t){return xa(k,ea(t))},max:tb,min:function(k,t,D){var L=Infinity,P=Infinity,U;if(null==t||"number"==typeof t&&"object"!=typeof k[0]&&null!=k){k=ra(k)?k:C(k);for(var aa=0,ha=k.length;aa<ha;aa++)D=k[aa],null!=D&&D<L&&(L=D)}else t=Q(t,D),sa(k,function(la,na,ma){U=t(la,na,ma);if(U<P||Infinity===U&&Infinity===L)L=la,P=U});return L},
shuffle:function(k){return ub(k,Infinity)},sample:ub,sortBy:function(k,t,D){var L=0;t=Q(t,D);return Pa(va(k,function(P,U,aa){return{value:P,index:L++,criteria:t(P,U,aa)}}).sort(function(P,U){var aa=P.criteria,ha=U.criteria;if(aa!==ha){if(aa>ha||void 0===aa)return 1;if(aa<ha||void 0===ha)return-1}return P.index-U.index}),"value")},groupBy:tc,indexBy:uc,countBy:vc,partition:wc,toArray:function(k){return k?ua(k)?Ca.call(k):Ua(k)?k.match(xc):ra(k)?va(k,ba):C(k):[]},size:function(k){return null==k?0:ra(k)?
k.length:b(k).length},pick:Jb,omit:yc,first:Qa,head:Qa,take:Qa,initial:vb,last:function(k,t,D){return null==k||1>k.length?null==t||D?void 0:[]:null==t||D?k[k.length-1]:Ia(k,Math.max(0,k.length-t))},rest:Ia,tail:Ia,drop:Ia,compact:function(k){return xa(k,Boolean)},flatten:function(k,t){return pa(k,t,!1)},without:zc,uniq:Ra,unique:Ra,union:Ac,intersection:function(k){for(var t=[],D=arguments.length,L=0,P=qa(k);L<P;L++){var U=k[L];if(!ta(t,U)){var aa;for(aa=1;aa<D&&ta(arguments[aa],U);aa++);aa===D&&
t.push(U)}}return t},difference:Kb,unzip:Sa,transpose:Sa,zip:Bc,object:function(k,t){for(var D={},L=0,P=qa(k);L<P;L++)t?D[k[L]]=t[L]:D[k[L][0]]=k[L][1];return D},range:function(k,t,D){null==t&&(t=k||0,k=0);D||(D=t<k?-1:1);t=Math.max(Math.ceil((t-k)/D),0);for(var L=Array(t),P=0;P<t;P++,k+=D)L[P]=k;return L},chunk:function(k,t){if(null==t||1>t)return[];for(var D=[],L=0,P=k.length;L<P;)D.push(Ca.call(k,L,L+=t));return D},mixin:wb,"default":f});return Lb._=Lb})}).call(this)}).call(this,"undefined"!==
typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],25:[function(e,n,H){n.exports=function(){throw Error("ws does not work in the browser. Browser clients must use the native WebSocket object");}},{}]},{},[13])(13)});var CindyLeap=function(e){function n(r,p){var G,v;for(G in r)(v=p[G])?v(u(r[G])):console.log("Modifier "+G+" not supported")}var H=e.nada,u=e.evaluate,m=e.defineFunction;m("initleapmotion",0,function(r,p){var G=!1;n(p,{enablegestures:function(v){return G=coerce.toBool(v,!1)},usehandtransformcdy3d:function(v){return setManipulateSceneTransformActive(coerce.toBool(v,!1))},rotationfactor:function(v){return setLeapMotionRotationFactor(coerce.toReal(v,2))},translationfactor:function(v){return setLeapMotionTranslationFactor(coerce.toReal(v,
1))}});initLeapMotion(e,G);return H});m("leapdebugprinthands",0,function(r,p){r=getLeapHandsData();0<r.length&&console.log(r);return H});m("leapdebugprintgestures",0,function(r,p){r=getLeapGestureData();0<r.length&&console.log(r);return H});m("leapnormalizeposition",1,function(r,p){r=e.evaluate(r[0]).value;r=leapNormalizePosition([r[0].value.real,r[1].value.real,r[2].value.real]);return nestedArrayToCSList(r)});m("getleaphandsdata",0,function(r,p){r=new Set(["frame"]);p=getLeapHandsData();return convertObjectToCindyDict(p,
r,new Map)});m("getleapgesturedata",0,function(r,p){r=new Set(["frame"]);p=getLeapGestureData();return convertObjectToCindyDict(p,r,new Map)});m("getleapmotionmodelmatrix",0,function(r,p){r=getLeapMotionModelMatrix();return nestedArrayToCSList([[r[0],r[1],r[2],r[3]],[r[4],r[5],r[6],r[7]],[r[8],r[9],r[10],r[11]],[r[12],r[13],r[14],r[15]]])});m("getleapmotionrotationmatrix",0,function(r,p){r=getLeapMotionModelMatrix();return nestedArrayToCSList([[r[0],r[1],r[2]],[r[4],r[5],r[6]],[r[8],r[9],r[10]]])});
m("getleapmotiontranslationvector",0,function(r,p){r=getLeapMotionModelMatrix();return nestedArrayToCSList([r[3]+1E-6,r[7],r[11]])});m("getleapmotiontransformhaschanged",0,function(r,p){return{ctype:"boolean",value:getLeapMotionTransformHasChanged()}})};CindyLeap.leapPreRender=leapPreRender;CindyLeap.leapPostRender=leapPostRender;CindyJS.registerPlugin(1,"CindyLeap",CindyLeap);var modelMatrixTmp,mvMatrixTmp,leapMotionModelMatrixInternal=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],leapMotionRotationMatrixInternal=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],leapMotionTransformHasChanged=!1,leapMotionRotationFactor=2,leapMotionTranslationFactor=1,lastLeapFrame=null,manipulateSceneTransformActive=!1,gesturesEnabled=!1;
function leapPreRender(e){if(manipulateSceneTransformActive){modelMatrixTmp=e.modelMatrix.slice();mvMatrixTmp=e.mvMatrix.slice();var n=getLeapMotionModelMatrix();e.modelMatrix=mul4mm(n,e.modelMatrix);e.mvMatrix=mul4mm(e.viewMatrix,e.modelMatrix)}}function leapPostRender(e){manipulateSceneTransformActive&&(e.modelMatrix=modelMatrixTmp.slice(),e.mvMatrix=mvMatrixTmp.slice())}
function initLeapMotion(e,n){gesturesEnabled=n;var H=new Leap.Controller({enableGestures:n});H.on("frame",function(u){onLeapMotionControllerFrame(e,H,u)});H.connect()}
function onLeapMotionControllerFrame(e,n,H){if(0<H.hands.length){lastLeapFrame=H;var u=H.hands[0];n=n.frame(1);u.rotationMatrix(n);H=H.interactionBox.normalizePoint(u.palmPosition,!0);n=u.palmNormal;var m=u.direction;n=[n[1]*m[2]-n[2]*m[1],n[2]*m[0]-n[0]*m[2],n[0]*m[1]-n[1]*m[0]];leapMotionRotationMatrixInternal=[n[0],n[1],n[2],0,u.palmNormal[0],u.palmNormal[1],u.palmNormal[2],0,u.direction[0],u.direction[1],u.direction[2],0,0,0,0,1];leapMotionRotationMatrixInternal=transpose4(mul4mm([1,0,0,0,0,-1,
0,0,0,0,-1,0,0,0,0,1],leapMotionRotationMatrixInternal));2==leapMotionRotationFactor?leapMotionRotationMatrixInternal=mul4mm(leapMotionRotationMatrixInternal,leapMotionRotationMatrixInternal):1!=leapMotionRotationFactor&&(u=axisAngleFromRotationMatrix(leapMotionRotationMatrixInternal),leapMotionRotationMatrixInternal=rotationMatrixFromAxisAngle(u[0],leapMotionRotationFactor*u[1]));leapMotionModelMatrixInternal=leapMotionRotationMatrixInternal.slice();leapMotionModelMatrixInternal[3]=leapMotionTranslationFactor*
(2*H[0]-1);leapMotionModelMatrixInternal[7]=leapMotionTranslationFactor*(2*H[1]-1);leapMotionModelMatrixInternal[11]=leapMotionTranslationFactor*(2*H[2]-1);leapMotionTransformHasChanged=!0;e.scheduleUpdate()}}function setManipulateSceneTransformActive(e){manipulateSceneTransformActive=e}function getLeapHandsData(){return null!=lastLeapFrame?lastLeapFrame.hands:[]}function getLeapGestureData(){return null!=lastLeapFrame&&gesturesEnabled?lastLeapFrame.gestures:[]}
function leapNormalizePosition(e){return null!=lastLeapFrame?(e=lastLeapFrame.interactionBox.normalizePoint(e,!0),[leapMotionTranslationFactor*(2*e[0]-1),leapMotionTranslationFactor*(2*e[1]-1),leapMotionTranslationFactor*(2*e[2]-1)]):e}function rotationMatrixFromAxisAngle(e,n){var H=Math.sin(n);n=Math.cos(n);var u=1-n;return[n+e[0]*e[0]*u,e[0]*e[1]*u-e[2]*H,e[0]*e[2]*u+e[1]*H,0,e[1]*e[0]*u+e[2]*H,n+e[1]*e[1]*u,e[1]*e[2]*u-e[0]*H,0,e[2]*e[0]*u-e[1]*H,e[2]*e[1]*u+e[0]*H,n+e[2]*e[2]*u,0,0,0,0,1]}
function axisAngleFromRotationMatrix(e){var n=function(G){return G*G};if(.001>Math.abs(e[1]-e[4])&&.001>Math.abs(e[2]-e[8])&&.001>Math.abs(e[6]-e[9])){if(.001>Math.abs(e[1]+e[4])&&.01>Math.abs(e[2]+e[8])&&.01>Math.abs(e[6]+e[9])&&.01>Math.abs(e[0]+e[5]+e[10]-3))return[[1,0,0],0];n=(e[0]+1)/2;var H=(e[5]+1)/2,u=(e[10]+1)/2,m=(e[1]+e[4])/4,r=(e[2]+e[8])/4;e=(e[6]+e[9])/4;var p=1/Math.sqrt(2);n>H&&n>u?.001>n?(x=0,z=y=p):(x=Math.sqrt(n),y=m/x,z=r/x):H>u?.001>H?(x=p,y=0,z=p):(y=Math.sqrt(H),x=m/y,z=e/
y):.001>u?(y=x=p,z=0):(z=Math.sqrt(u),x=r/z,y=e/z);return[[0,0,0],Math.PI]}n=Math.sqrt(n(e[9]-e[6])+n(e[2]-e[8])+n(e[4]-e[1]));return[[(e[9]-e[6])/n,(e[2]-e[8])/n,(e[4]-e[1])/n],Math.acos((e[0]+e[5]+e[10]-1)/2)]}function getLeapMotionModelMatrix(){return leapMotionModelMatrixInternal}function getLeapMotionTransformHasChanged(){return leapMotionTransformHasChanged?(leapMotionTransformHasChanged=!1,!0):!1}function setLeapMotionRotationFactor(e){leapMotionRotationFactor=e}
function setLeapMotionTranslationFactor(e){leapMotionTranslationFactor=e};/*
 LeapJS v0.6.4                                                  
 http://github.com/leapmotion/leapjs/                                        

 Copyright 2013 LeapMotion, Inc. and other contributors                      
 Released under the Apache-2.0 license                                     
 http://github.com/leapmotion/leapjs/blob/master/LICENSE.txt                 
*/
(function(e,n,H){function u(p,G){if(!n[p]){if(!e[p]){var v="function"==typeof require&&require;if(!G&&v)return v(p,!0);if(m)return m(p,!0);throw Error("Cannot find module '"+p+"'");}G=n[p]={exports:{}};e[p][0].call(G.exports,function(M){var E=e[p][1][M];return u(E?E:M)},G,G.exports)}return n[p].exports}for(var m="function"==typeof require&&require,r=0;r<H.length;r++)u(H[r]);return u})({1:[function(e,n,H){e("./pointable");H=e("gl-matrix");var u=H.vec3,m=H.mat3,r=H.mat4;e("underscore");e=n.exports=
function(p,G){this.finger=p;this._matrix=this._center=null;this.type=G.type;this.prevJoint=G.prevJoint;this.nextJoint=G.nextJoint;this.width=G.width;p=Array(3);u.sub(p,G.nextJoint,G.prevJoint);this.length=u.length(p);this.basis=G.basis};e.prototype.left=function(){return this._left?this._left:this._left=0>m.determinant(this.basis[0].concat(this.basis[1]).concat(this.basis[2]))};e.prototype.matrix=function(){if(this._matrix)return this._matrix;var p=this.basis,G=this._matrix=r.create();G[0]=p[0][0];
G[1]=p[0][1];G[2]=p[0][2];G[4]=p[1][0];G[5]=p[1][1];G[6]=p[1][2];G[8]=p[2][0];G[9]=p[2][1];G[10]=p[2][2];G[3]=this.center()[0];G[7]=this.center()[1];G[11]=this.center()[2];this.left()&&(G[0]*=-1,G[1]*=-1,G[2]*=-1);return this._matrix};e.prototype.lerp=function(p,G){u.lerp(p,this.prevJoint,this.nextJoint,G)};e.prototype.center=function(){if(this._center)return this._center;var p=u.create();this.lerp(p,.5);return this._center=p};e.prototype.direction=function(){return[-1*this.basis[2][0],-1*this.basis[2][1],
-1*this.basis[2][2]]}},{"./pointable":14,"gl-matrix":23,underscore:24}],2:[function(e,n,H){e=n.exports=function(u){this.pos=0;this._buf=[];this.size=u};e.prototype.get=function(u){void 0==u&&(u=0);if(!(u>=this.size||u>=this._buf.length))return this._buf[(this.pos-u-1)%this.size]};e.prototype.push=function(u){this._buf[this.pos%this.size]=u;return this.pos++}},{}],3:[function(e,n,H){var u=e("../protocol").chooseProtocol;H=e("events").EventEmitter;var m=e("underscore"),r=n.exports=function(p){this.opts=
m.defaults(p||{},{host:"127.0.0.1",enableGestures:!1,scheme:this.getScheme(),port:this.getPort(),background:!1,optimizeHMD:!1,requestProtocolVersion:r.defaultProtocolVersion});this.host=this.opts.host;this.port=this.opts.port;this.scheme=this.opts.scheme;this.protocolVersionVerified=!1;this.optimizeHMD=this.background=null;this.on("ready",function(){this.enableGestures(this.opts.enableGestures);this.setBackground(this.opts.background);this.setOptimizeHMD(this.opts.optimizeHMD);this.opts.optimizeHMD?
console.log("Optimized for head mounted display usage."):console.log("Optimized for desktop usage.")})};r.defaultProtocolVersion=6;r.prototype.getUrl=function(){return this.scheme+"//"+this.host+":"+this.port+"/v"+this.opts.requestProtocolVersion+".json"};r.prototype.getScheme=function(){return"ws:"};r.prototype.getPort=function(){return 6437};r.prototype.setBackground=function(p){this.opts.background=p;this.protocol&&this.protocol.sendBackground&&this.background!==this.opts.background&&(this.background=
this.opts.background,this.protocol.sendBackground(this,this.opts.background))};r.prototype.setOptimizeHMD=function(p){this.opts.optimizeHMD=p;this.protocol&&this.protocol.sendOptimizeHMD&&this.optimizeHMD!==this.opts.optimizeHMD&&(this.optimizeHMD=this.opts.optimizeHMD,this.protocol.sendOptimizeHMD(this,this.opts.optimizeHMD))};r.prototype.handleOpen=function(){this.connected||(this.connected=!0,this.emit("connect"))};r.prototype.enableGestures=function(p){this.gesturesEnabled=p?!0:!1;this.send(this.protocol.encode({enableGestures:this.gesturesEnabled}))};
r.prototype.handleClose=function(p,G){this.connected&&(this.disconnect(),1001===p&&1<this.opts.requestProtocolVersion&&(this.protocolVersionVerified?this.protocolVersionVerified=!1:this.opts.requestProtocolVersion--),this.startReconnection())};r.prototype.startReconnection=function(){var p=this;this.reconnectionTimer||(this.reconnectionTimer=setInterval(function(){p.reconnect()},500))};r.prototype.stopReconnection=function(){this.reconnectionTimer=clearInterval(this.reconnectionTimer)};r.prototype.disconnect=
function(p){p||this.stopReconnection();if(this.socket)return this.socket.close(),delete this.socket,delete this.protocol,delete this.background,delete this.optimizeHMD,delete this.focusedState,this.connected&&(this.connected=!1,this.emit("disconnect")),!0};r.prototype.reconnect=function(){this.connected?this.stopReconnection():(this.disconnect(!0),this.connect())};r.prototype.handleData=function(p){p=JSON.parse(p);void 0===this.protocol?(p=this.protocol=u(p),this.protocolVersionVerified=!0,this.emit("ready")):
p=this.protocol(p);this.emit(p.type,p)};r.prototype.connect=function(){if(!this.socket)return this.socket=this.setupSocket(),!0};r.prototype.send=function(p){this.socket.send(p)};r.prototype.reportFocus=function(p){this.connected&&this.focusedState!==p&&(this.focusedState=p,this.emit(this.focusedState?"focus":"blur"),this.protocol&&this.protocol.sendFocused&&this.protocol.sendFocused(this,this.focusedState))};m.extend(r.prototype,H.prototype)},{"../protocol":15,events:21,underscore:24}],4:[function(e,
n,H){var u=n.exports=e("./base");e=e("underscore");n=n.exports=function(m){u.call(this,m);var r=this;this.on("ready",function(){r.startFocusLoop()});this.on("disconnect",function(){r.stopFocusLoop()})};e.extend(n.prototype,u.prototype);n.__proto__=u;n.prototype.useSecure=function(){return"https:"===location.protocol};n.prototype.getScheme=function(){return this.useSecure()?"wss:":"ws:"};n.prototype.getPort=function(){return this.useSecure()?6436:6437};n.prototype.setupSocket=function(){var m=this,
r=new WebSocket(this.getUrl());r.onopen=function(){m.handleOpen()};r.onclose=function(p){m.handleClose(p.code,p.reason)};r.onmessage=function(p){m.handleData(p.data)};r.onerror=function(p){m.useSecure()&&"wss:"===m.scheme?(m.scheme="ws:",m.port=6437,m.disconnect(),m.connect()):confirm("Leap Motion controller driver (V2) not found. Please download the driver from the following website and check that the port 6437 is open.")&&(window.location.href="https://developer.leapmotion.com/sdk/v2")};return r};
n.prototype.startFocusLoop=function(){if(!this.focusDetectorTimer){var m=this,r=null;r="undefined"!==typeof document.hidden?"hidden":"undefined"!==typeof document.mozHidden?"mozHidden":"undefined"!==typeof document.msHidden?"msHidden":"undefined"!==typeof document.webkitHidden?"webkitHidden":void 0;void 0===m.windowVisible&&(m.windowVisible=void 0===r?!0:!1===document[r]);var p=window.addEventListener("focus",function(M){m.windowVisible=!0;v()}),G=window.addEventListener("blur",function(M){m.windowVisible=
!1;v()});this.on("disconnect",function(){window.removeEventListener("focus",p);window.removeEventListener("blur",G)});var v=function(){m.reportFocus((void 0===r?!0:!1===document[r])&&m.windowVisible)};v();this.focusDetectorTimer=setInterval(v,100)}};n.prototype.stopFocusLoop=function(){this.focusDetectorTimer&&(clearTimeout(this.focusDetectorTimer),delete this.focusDetectorTimer)}},{"./base":3,underscore:24}],5:[function(e,n,H){var u=e("__browserify_process"),m=e("./frame"),r=e("./hand"),p=e("./pointable"),
G=e("./finger"),v=e("./circular_buffer"),M=e("./pipeline");H=e("events").EventEmitter;var E=e("./gesture").gestureListener,w=e("./dialog"),N=e("underscore"),R=n.exports=function(I){var B=this;I=N.defaults(I||{},{inNode:"undefined"!==typeof u&&u.versions&&u.versions.node});this.inNode=I.inNode;I=N.defaults(I||{},{frameEventName:this.useAnimationLoop()?"animationFrame":"deviceFrame",suppressAnimationLoop:!this.useAnimationLoop(),loopWhileDisconnected:!0,useAllPlugins:!1,checkVersion:!0});this.animationFrameRequested=
!1;this.onAnimationFrame=function(c){B.lastConnectionFrame.valid&&B.emit("animationFrame",B.lastConnectionFrame);B.emit("frameEnd",c);B.loopWhileDisconnected&&(!1!==B.connection.focusedState||B.connection.opts.background)?window.requestAnimationFrame(B.onAnimationFrame):B.animationFrameRequested=!1};this.suppressAnimationLoop=I.suppressAnimationLoop;this.loopWhileDisconnected=I.loopWhileDisconnected;this.frameEventName=I.frameEventName;this.useAllPlugins=I.useAllPlugins;this.history=new v(200);this.lastConnectionFrame=
this.lastValidFrame=this.lastFrame=m.Invalid;this.accumulatedGestures=[];this.checkVersion=I.checkVersion;this.connectionType=void 0===I.connectionType?this.inBrowser()?e("./connection/browser"):e("./connection/node"):I.connectionType;this.connection=new this.connectionType(I);this.streamingCount=0;this.devices={};this.plugins={};this._pluginPipelineSteps={};this._pluginExtendedMethods={};I.useAllPlugins&&this.useRegisteredPlugins();this.setupFrameEvents(I);this.setupConnectionEvents();this.startAnimationLoop()};
R.prototype.gesture=function(I,B){I=E(this,I);void 0!==B&&I.stop(B);return I};R.prototype.setBackground=function(I){this.connection.setBackground(I);return this};R.prototype.setOptimizeHMD=function(I){this.connection.setOptimizeHMD(I);return this};R.prototype.inBrowser=function(){return!this.inNode};R.prototype.useAnimationLoop=function(){return this.inBrowser()&&!this.inBackgroundPage()};R.prototype.inBackgroundPage=function(){return"undefined"!==typeof chrome&&chrome.extension&&chrome.extension.getBackgroundPage&&
chrome.extension.getBackgroundPage()===window};R.prototype.connect=function(){this.connection.connect();return this};R.prototype.streaming=function(){return 0<this.streamingCount};R.prototype.connected=function(){return!!this.connection.connected};R.prototype.startAnimationLoop=function(){this.suppressAnimationLoop||this.animationFrameRequested||(this.animationFrameRequested=!0,window.requestAnimationFrame(this.onAnimationFrame))};R.prototype.disconnect=function(){this.connection.disconnect();return this};
R.prototype.frame=function(I){return this.history.get(I)||m.Invalid};R.prototype.loop=function(I){if(I)if("function"===typeof I)this.on(this.frameEventName,I);else this.setupFrameEvents(I);return this.connect()};R.prototype.addStep=function(I){this.pipeline||(this.pipeline=new M(this));this.pipeline.addStep(I)};R.prototype.processFrame=function(I){I.gestures&&(this.accumulatedGestures=this.accumulatedGestures.concat(I.gestures));this.lastConnectionFrame=I;this.startAnimationLoop();this.emit("deviceFrame",
I)};R.prototype.processFinishedFrame=function(I){this.lastFrame=I;I.valid&&(this.lastValidFrame=I);I.controller=this;I.historyIdx=this.history.push(I);if(I.gestures){I.gestures=this.accumulatedGestures;this.accumulatedGestures=[];for(var B=0;B!=I.gestures.length;B++)this.emit("gesture",I.gestures[B],I)}this.pipeline&&(I=this.pipeline.run(I),I||(I=m.Invalid));this.emit("frame",I);this.emitHandEvents(I)};R.prototype.emitHandEvents=function(I){for(var B=0;B<I.hands.length;B++)this.emit("hand",I.hands[B])};
R.prototype.setupFrameEvents=function(I){if(I.frame)this.on("frame",I.frame);if(I.hand)this.on("hand",I.hand)};R.prototype.setupConnectionEvents=function(){var I=this;this.connection.on("frame",function(a){I.processFrame(a)});this.on(this.frameEventName,function(a){I.processFinishedFrame(a)});var B=function(){if(5>I.connection.opts.requestProtocolVersion&&0==I.streamingCount){I.streamingCount=1;var a={attached:!0,streaming:!0,type:"unknown",id:"Lx00000000000"};I.devices[a.id]=a;I.emit("deviceAttached",
a);I.emit("deviceStreaming",a);I.emit("streamingStarted",a);I.connection.removeListener("frame",B)}},c=function(){if(0<I.streamingCount){for(var a in I.devices)I.emit("deviceStopped",I.devices[a]),I.emit("deviceRemoved",I.devices[a]);I.emit("streamingStopped",I.devices[a]);I.streamingCount=0;for(a in I.devices)delete I.devices[a]}};this.connection.on("focus",function(){I.loopWhileDisconnected&&I.startAnimationLoop();I.emit("focus")});this.connection.on("blur",function(){I.emit("blur")});this.connection.on("protocol",
function(a){a.on("beforeFrameCreated",function(b){I.emit("beforeFrameCreated",b)});a.on("afterFrameCreated",function(b,d){I.emit("afterFrameCreated",b,d)});I.emit("protocol",a)});this.connection.on("ready",function(){I.checkVersion&&!I.inNode&&I.checkOutOfDate();I.emit("ready")});this.connection.on("connect",function(){I.emit("connect");I.connection.removeListener("frame",B);I.connection.on("frame",B)});this.connection.on("disconnect",function(){I.emit("disconnect");c()});this.connection.on("deviceConnect",
function(a){a.state?(I.emit("deviceConnected"),I.connection.removeListener("frame",B),I.connection.on("frame",B)):(I.emit("deviceDisconnected"),c())});this.connection.on("deviceEvent",function(a){a=a.state;var b=I.devices[a.id],d={},f;for(f in a)b&&b.hasOwnProperty(f)&&b[f]==a[f]||(d[f]=!0);I.devices[a.id]=a;d.attached&&I.emit(a.attached?"deviceAttached":"deviceRemoved",a);d.streaming&&(a.streaming?(I.streamingCount++,I.emit("deviceStreaming",a),1==I.streamingCount&&I.emit("streamingStarted",a),d.attached||
I.emit("deviceConnected")):d.attached&&a.attached||(I.streamingCount--,I.emit("deviceStopped",a),0==I.streamingCount&&I.emit("streamingStopped",a),I.emit("deviceDisconnected")))});this.on("newListener",function(a,b){"deviceConnected"!=a&&"deviceDisconnected"!=a||console.warn(a+" events are depricated.  Consider using 'streamingStarted/streamingStopped' or 'deviceStreaming/deviceStopped' instead")})};R.prototype.checkOutOfDate=function(){console.assert(this.connection&&this.connection.protocol);var I=
this.connection.protocol.serviceVersion,B=this.connection.protocol.version,c=this.connectionType.defaultProtocolVersion;return c>B?(console.warn("Your Protocol Version is v"+B+", this app was designed for v"+c),w.warnOutOfDate({sV:I,pV:B}),!0):!1};R._pluginFactories={};R.plugin=function(I,B){this._pluginFactories[I]&&console.warn('Plugin "'+I+'" already registered');return this._pluginFactories[I]=B};R.plugins=function(){return N.keys(this._pluginFactories)};R.prototype.use=function(I,B){var c;var a=
"function"==typeof I?I:R._pluginFactories[I];if(!a)throw"Leap Plugin "+I+" not found.";B||(B={});if(this.plugins[I])return N.extend(this.plugins[I],B),this;this.plugins[I]=B;B=a.call(this,B);for(c in B)if(a=B[c],"function"===typeof a){var b=I,d=c;if(-1!==["beforeFrameCreated","afterFrameCreated"].indexOf(d))this.on(d,a);else this.pipeline||(this.pipeline=new M(this)),this._pluginPipelineSteps[b]||(this._pluginPipelineSteps[b]=[]),this._pluginPipelineSteps[b].push(this.pipeline.addWrappedStep(d,a))}else{b=
I;d=c;this._pluginExtendedMethods[b]||(this._pluginExtendedMethods[b]=[]);switch(d){case "frame":d=m;break;case "hand":d=r;break;case "pointable":d=p;N.extend(G.prototype,a);N.extend(G.Invalid,a);break;case "finger":d=G;break;default:throw b+' specifies invalid object type "'+d+'" for prototypical extension';}N.extend(d.prototype,a);N.extend(d.Invalid,a);this._pluginExtendedMethods[b].push([d,a])}return this};R.prototype.stopUsing=function(I){var B=this._pluginPipelineSteps[I],c=this._pluginExtendedMethods[I],
a;if(this.plugins[I]){if(B)for(a=0;a<B.length;a++)this.pipeline.removeStep(B[a]);if(c)for(a=0;a<c.length;a++){B=c[a][0];var b=c[a][1];for(var d in b)delete B.prototype[d],delete B.Invalid[d]}delete this.plugins[I];return this}};R.prototype.useRegisteredPlugins=function(){for(var I in R._pluginFactories)this.use(I)};N.extend(R.prototype,H.prototype)},{"./circular_buffer":2,"./connection/browser":4,"./connection/node":20,"./dialog":6,"./finger":7,"./frame":8,"./gesture":9,"./hand":10,"./pipeline":13,
"./pointable":14,__browserify_process:22,events:21,underscore:24}],6:[function(e,n,H){var u=e("__browserify_process"),m=n.exports=function(r,p){this.options=p||{};this.message=r;this.createElement()};m.prototype.createElement=function(){this.element=document.createElement("div");this.element.className="leapjs-dialog";this.element.style.position="fixed";this.element.style.top="8px";this.element.style.left=0;this.element.style.right=0;this.element.style.textAlign="center";this.element.style.zIndex=
1E3;var r=document.createElement("div");this.element.appendChild(r);r.style.className="leapjs-dialog";r.style.display="inline-block";r.style.margin="auto";r.style.padding="8px";r.style.color="#222";r.style.background="#eee";r.style.borderRadius="4px";r.style.border="1px solid #999";r.style.textAlign="left";r.style.cursor="pointer";r.style.whiteSpace="nowrap";r.style.transition="box-shadow 1s linear";r.innerHTML=this.message;this.options.onclick&&r.addEventListener("click",this.options.onclick);this.options.onmouseover&&
r.addEventListener("mouseover",this.options.onmouseover);this.options.onmouseout&&r.addEventListener("mouseout",this.options.onmouseout);this.options.onmousemove&&r.addEventListener("mousemove",this.options.onmousemove)};m.prototype.show=function(){document.body.appendChild(this.element);return this};m.prototype.hide=function(){document.body.removeChild(this.element);return this};m.warnOutOfDate=function(r){r||(r={});var p="http://developer.leapmotion.com?";r.returnTo=window.location.href;for(var G in r)p+=
G+"="+encodeURIComponent(r[G])+"&";var v=new m("This site requires Leap Motion Tracking V2.<button id='leapjs-accept-upgrade'  style='color: #444; transition: box-shadow 100ms linear; cursor: pointer; vertical-align: baseline; margin-left: 16px;'>Upgrade</button><button id='leapjs-decline-upgrade' style='color: #444; transition: box-shadow 100ms linear; cursor: pointer; vertical-align: baseline; margin-left: 8px; '>Not Now</button>",{onclick:function(M){"leapjs-decline-upgrade"!=M.target.id&&(M=window.open(p,
"_blank","height=800,width=1000,location=1,menubar=1,resizable=1,status=1,toolbar=1,scrollbars=1"),window.focus&&M.focus());v.hide();return!0},onmousemove:function(M){M.target==document.getElementById("leapjs-decline-upgrade")?(document.getElementById("leapjs-decline-upgrade").style.color="#000",document.getElementById("leapjs-decline-upgrade").style.boxShadow="0px 0px 2px #5daa00",document.getElementById("leapjs-accept-upgrade").style.color="#444",document.getElementById("leapjs-accept-upgrade").style.boxShadow=
"none"):(document.getElementById("leapjs-accept-upgrade").style.color="#000",document.getElementById("leapjs-accept-upgrade").style.boxShadow="0px 0px 2px #5daa00",document.getElementById("leapjs-decline-upgrade").style.color="#444",document.getElementById("leapjs-decline-upgrade").style.boxShadow="none")},onmouseout:function(){document.getElementById("leapjs-decline-upgrade").style.color="#444";document.getElementById("leapjs-decline-upgrade").style.boxShadow="none";document.getElementById("leapjs-accept-upgrade").style.color=
"#444";document.getElementById("leapjs-accept-upgrade").style.boxShadow="none"}});return v.show()};m.hasWarnedBones=!1;m.warnBones=function(){this.hasWarnedBones||(this.hasWarnedBones=!0,console.warn("Your Leap Service is out of date"),"undefined"!==typeof u&&u.versions&&u.versions.node||this.warnOutOfDate({reason:"bones"}))}},{__browserify_process:22}],7:[function(e,n,H){var u=e("./pointable"),m=e("./bone"),r=e("./dialog");e=e("underscore");n=n.exports=function(p){u.call(this,p);this.dipPosition=
p.dipPosition;this.pipPosition=p.pipPosition;this.mcpPosition=p.mcpPosition;this.carpPosition=p.carpPosition;this.extended=p.extended;this.type=p.type;this.finger=!0;this.positions=[this.carpPosition,this.mcpPosition,this.pipPosition,this.dipPosition,this.tipPosition];p.bases?this.addBones(p):r.warnBones()};e.extend(n.prototype,u.prototype);n.prototype.addBones=function(p){this.metacarpal=new m(this,{type:0,width:this.width,prevJoint:this.carpPosition,nextJoint:this.mcpPosition,basis:p.bases[0]});
this.proximal=new m(this,{type:1,width:this.width,prevJoint:this.mcpPosition,nextJoint:this.pipPosition,basis:p.bases[1]});this.medial=new m(this,{type:2,width:this.width,prevJoint:this.pipPosition,nextJoint:this.dipPosition,basis:p.bases[2]});this.distal=new m(this,{type:3,width:this.width,prevJoint:this.dipPosition,nextJoint:p.btipPosition,basis:p.bases[3]});this.bones=[this.metacarpal,this.proximal,this.medial,this.distal]};n.prototype.toString=function(){return"Finger [ id:"+this.id+" "+this.length+
"mmx | width:"+this.width+"mm | direction:"+this.direction+" ]"};n.Invalid={valid:!1}},{"./bone":1,"./dialog":6,"./pointable":14,underscore:24}],8:[function(e,n,H){var u=e("./hand"),m=e("./pointable"),r=e("./gesture").createGesture;H=e("gl-matrix");var p=H.mat3,G=H.vec3,v=e("./interaction_box"),M=e("./finger"),E=e("underscore");e=n.exports=function(w){this.valid=!0;this.id=w.id;this.timestamp=w.timestamp;this.hands=[];this.handsMap={};this.pointables=[];this.tools=[];this.fingers=[];w.interactionBox&&
(this.interactionBox=new v(w.interactionBox));this.gestures=[];this.pointablesMap={};this._translation=w.t;this._rotation=E.flatten(w.r);this._scaleFactor=w.s;this.data=w;this.type="frame";this.currentFrameRate=w.currentFrameRate;if(w.gestures)for(var N=0,R=w.gestures.length;N!=R;N++)this.gestures.push(r(w.gestures[N]));this.postprocessData(w)};e.prototype.postprocessData=function(w){w||(w=this.data);for(var N=0,R=w.hands.length;N!=R;N++){var I=new u(w.hands[N]);I.frame=this;this.hands.push(I);this.handsMap[I.id]=
I}w.pointables=E.sortBy(w.pointables,function(B){return B.id});N=0;for(R=w.pointables.length;N!=R;N++)I=w.pointables[N],I=I.dipPosition?new M(I):new m(I),I.frame=this,this.addPointable(I)};e.prototype.addPointable=function(w){this.pointables.push(w);this.pointablesMap[w.id]=w;(w.tool?this.tools:this.fingers).push(w);if(void 0!==w.handId&&this.handsMap.hasOwnProperty(w.handId)){var N=this.handsMap[w.handId];N.pointables.push(w);(w.tool?N.tools:N.fingers).push(w);switch(w.type){case 0:N.thumb=w;break;
case 1:N.indexFinger=w;break;case 2:N.middleFinger=w;break;case 3:N.ringFinger=w;break;case 4:N.pinky=w}}};e.prototype.tool=function(w){w=this.pointable(w);return w.tool?w:m.Invalid};e.prototype.pointable=function(w){return this.pointablesMap[w]||m.Invalid};e.prototype.finger=function(w){w=this.pointable(w);return w.tool?m.Invalid:w};e.prototype.hand=function(w){return this.handsMap[w]||u.Invalid};e.prototype.rotationAngle=function(w,N){if(!this.valid||!w.valid)return 0;var R=this.rotationMatrix(w);
R=Math.acos(.5*(R[0]+R[4]+R[8]-1));R=isNaN(R)?0:R;void 0!==N&&(w=this.rotationAxis(w),R*=G.dot(w,G.normalize(G.create(),N)));return R};e.prototype.rotationAxis=function(w){return this.valid&&w.valid?G.normalize(G.create(),[this._rotation[7]-w._rotation[5],this._rotation[2]-w._rotation[6],this._rotation[3]-w._rotation[1]]):G.create()};e.prototype.rotationMatrix=function(w){if(!this.valid||!w.valid)return p.create();var N=p.transpose(p.create(),this._rotation);return p.multiply(p.create(),w._rotation,
N)};e.prototype.scaleFactor=function(w){return this.valid&&w.valid?Math.exp(this._scaleFactor-w._scaleFactor):1};e.prototype.translation=function(w){return this.valid&&w.valid?G.subtract(G.create(),this._translation,w._translation):G.create()};e.prototype.toString=function(){var w="Frame [ id:"+this.id+" | timestamp:"+this.timestamp+" | Hand count:("+this.hands.length+") | Pointable count:("+this.pointables.length+")";this.gestures&&(w+=" | Gesture count:("+this.gestures.length+")");return w+" ]"};
e.prototype.dump=function(){var w="Frame Info:<br/>"+this.toString();w+="<br/><br/>Hands:<br/>";for(var N=0,R=this.hands.length;N!=R;N++)w+="  "+this.hands[N].toString()+"<br/>";w+="<br/><br/>Pointables:<br/>";N=0;for(R=this.pointables.length;N!=R;N++)w+="  "+this.pointables[N].toString()+"<br/>";if(this.gestures)for(w+="<br/><br/>Gestures:<br/>",N=0,R=this.gestures.length;N!=R;N++)w+="  "+this.gestures[N].toString()+"<br/>";return w=w+"<br/><br/>Raw JSON:<br/>"+JSON.stringify(this.data)};e.Invalid=
{valid:!1,hands:[],fingers:[],tools:[],gestures:[],pointables:[],pointable:function(){return m.Invalid},finger:function(){return m.Invalid},hand:function(){return u.Invalid},toString:function(){return"invalid frame"},dump:function(){return this.toString()},rotationAngle:function(){return 0},rotationMatrix:function(){return p.create()},rotationAxis:function(){return G.create()},scaleFactor:function(){return 1},translation:function(){return G.create()}}},{"./finger":7,"./gesture":9,"./hand":10,"./interaction_box":12,
"./pointable":14,"gl-matrix":23,underscore:24}],9:[function(e,n,H){var u=e("gl-matrix").vec3;n=e("events").EventEmitter;var m=e("underscore");H.createGesture=function(E){switch(E.type){case "circle":var w=new p(E);break;case "swipe":w=new G(E);break;case "screenTap":w=new v(E);break;case "keyTap":w=new M(E);break;default:throw"unknown gesture type";}w.id=E.id;w.handIds=E.handIds.slice();w.pointableIds=E.pointableIds.slice();w.duration=E.duration;w.state=E.state;w.type=E.type;return w};H.gestureListener=
function(E,w){var N={},R={};E.on("gesture",function(B,c){if(B.type==w){if(("start"==B.state||"stop"==B.state)&&void 0===R[B.id]){var a=new r(B,c);R[B.id]=a;m.each(N,function(b,d){a.on(d,b)})}R[B.id].update(B,c);"stop"==B.state&&delete R[B.id]}});var I={start:function(B){N.start=B;return I},stop:function(B){N.stop=B;return I},complete:function(B){N.stop=B;return I},update:function(B){N.update=B;return I}};return I};var r=H.Gesture=function(E,w){this.gestures=[E];this.frames=[w]};r.prototype.update=
function(E,w){this.lastGesture=E;this.lastFrame=w;this.gestures.push(E);this.frames.push(w);this.emit(E.state,this)};r.prototype.translation=function(){return u.subtract(u.create(),this.lastGesture.startPosition,this.lastGesture.position)};m.extend(r.prototype,n.prototype);var p=function(E){this.center=E.center;this.normal=E.normal;this.progress=E.progress;this.radius=E.radius};p.prototype.toString=function(){return"CircleGesture ["+JSON.stringify(this)+"]"};var G=function(E){this.startPosition=E.startPosition;
this.position=E.position;this.direction=E.direction;this.speed=E.speed};G.prototype.toString=function(){return"SwipeGesture ["+JSON.stringify(this)+"]"};var v=function(E){this.position=E.position;this.direction=E.direction;this.progress=E.progress};v.prototype.toString=function(){return"ScreenTapGesture ["+JSON.stringify(this)+"]"};var M=function(E){this.position=E.position;this.direction=E.direction;this.progress=E.progress};M.prototype.toString=function(){return"KeyTapGesture ["+JSON.stringify(this)+
"]"}},{events:21,"gl-matrix":23,underscore:24}],10:[function(e,n,H){var u=e("./pointable"),m=e("./bone");H=e("gl-matrix");var r=H.mat3,p=H.vec3,G=e("underscore");e=n.exports=function(v){this.id=v.id;this.palmPosition=v.palmPosition;this.direction=v.direction;this.palmVelocity=v.palmVelocity;this.palmNormal=v.palmNormal;this.sphereCenter=v.sphereCenter;this.sphereRadius=v.sphereRadius;this.valid=!0;this.pointables=[];this.fingers=[];this.arm=v.armBasis?new m(this,{type:4,width:v.armWidth,prevJoint:v.elbow,
nextJoint:v.wrist,basis:v.armBasis}):null;this.tools=[];this._translation=v.t;this._rotation=G.flatten(v.r);this._scaleFactor=v.s;this.timeVisible=v.timeVisible;this.stabilizedPalmPosition=v.stabilizedPalmPosition;this.type=v.type;this.grabStrength=v.grabStrength;this.pinchStrength=v.pinchStrength;this.confidence=v.confidence};e.prototype.finger=function(v){return(v=this.frame.finger(v))&&v.handId==this.id?v:u.Invalid};e.prototype.rotationAngle=function(v,M){if(!this.valid||!v.valid||!v.hand(this.id).valid)return 0;
var E=this.rotationMatrix(v);E=Math.acos(.5*(E[0]+E[4]+E[8]-1));E=isNaN(E)?0:E;void 0!==M&&(v=this.rotationAxis(v),E*=p.dot(v,p.normalize(p.create(),M)));return E};e.prototype.rotationAxis=function(v){if(!this.valid||!v.valid)return p.create();v=v.hand(this.id);return v.valid?p.normalize(p.create(),[this._rotation[7]-v._rotation[5],this._rotation[2]-v._rotation[6],this._rotation[3]-v._rotation[1]]):p.create()};e.prototype.rotationMatrix=function(v){if(!this.valid||!v.valid)return r.create();v=v.hand(this.id);
if(!v.valid)return r.create();var M=r.transpose(r.create(),this._rotation);return r.multiply(r.create(),v._rotation,M)};e.prototype.scaleFactor=function(v){if(!this.valid||!v.valid)return 1;v=v.hand(this.id);return v.valid?Math.exp(this._scaleFactor-v._scaleFactor):1};e.prototype.translation=function(v){if(!this.valid||!v.valid)return p.create();v=v.hand(this.id);return v.valid?[this._translation[0]-v._translation[0],this._translation[1]-v._translation[1],this._translation[2]-v._translation[2]]:p.create()};
e.prototype.toString=function(){return"Hand ("+this.type+") [ id: "+this.id+" | palm velocity:"+this.palmVelocity+" | sphere center:"+this.sphereCenter+" ] "};e.prototype.pitch=function(){return Math.atan2(this.direction[1],-this.direction[2])};e.prototype.yaw=function(){return Math.atan2(this.direction[0],-this.direction[2])};e.prototype.roll=function(){return Math.atan2(this.palmNormal[0],-this.palmNormal[1])};e.Invalid={valid:!1,fingers:[],tools:[],pointables:[],left:!1,pointable:function(){return u.Invalid},
finger:function(){return u.Invalid},toString:function(){return"invalid frame"},dump:function(){return this.toString()},rotationAngle:function(){return 0},rotationMatrix:function(){return r.create()},rotationAxis:function(){return p.create()},scaleFactor:function(){return 1},translation:function(){return p.create()}}},{"./bone":1,"./pointable":14,"gl-matrix":23,underscore:24}],11:[function(e,n,H){n.exports={Controller:e("./controller"),Frame:e("./frame"),Gesture:e("./gesture"),Hand:e("./hand"),Pointable:e("./pointable"),
Finger:e("./finger"),InteractionBox:e("./interaction_box"),CircularBuffer:e("./circular_buffer"),UI:e("./ui"),JSONProtocol:e("./protocol").JSONProtocol,glMatrix:e("gl-matrix"),mat3:e("gl-matrix").mat3,vec3:e("gl-matrix").vec3,loopController:void 0,version:e("./version.js"),_:e("underscore"),EventEmitter:e("events").EventEmitter,loop:function(u,m){u&&void 0===m&&"[object Function]"==={}.toString.call(u)&&(m=u,u={});this.loopController?u&&this.loopController.setupFrameEvents(u):this.loopController=
new this.Controller(u);this.loopController.loop(m);return this.loopController},plugin:function(u,m){this.Controller.plugin(u,m)}}},{"./circular_buffer":2,"./controller":5,"./finger":7,"./frame":8,"./gesture":9,"./hand":10,"./interaction_box":12,"./pointable":14,"./protocol":15,"./ui":16,"./version.js":19,events:21,"gl-matrix":23,underscore:24}],12:[function(e,n,H){var u=e("gl-matrix").vec3;e=n.exports=function(m){this.valid=!0;this.center=m.center;this.size=m.size;this.width=m.size[0];this.height=
m.size[1];this.depth=m.size[2]};e.prototype.denormalizePoint=function(m){return u.fromValues((m[0]-.5)*this.size[0]+this.center[0],(m[1]-.5)*this.size[1]+this.center[1],(m[2]-.5)*this.size[2]+this.center[2])};e.prototype.normalizePoint=function(m,r){m=u.fromValues((m[0]-this.center[0])/this.size[0]+.5,(m[1]-this.center[1])/this.size[1]+.5,(m[2]-this.center[2])/this.size[2]+.5);r&&(m[0]=Math.min(Math.max(m[0],0),1),m[1]=Math.min(Math.max(m[1],0),1),m[2]=Math.min(Math.max(m[2],0),1));return m};e.prototype.toString=
function(){return"InteractionBox [ width:"+this.width+" | height:"+this.height+" | depth:"+this.depth+" ]"};e.Invalid={valid:!1}},{"gl-matrix":23}],13:[function(e,n,H){e=n.exports=function(u){this.steps=[];this.controller=u};e.prototype.addStep=function(u){this.steps.push(u)};e.prototype.run=function(u){for(var m=this.steps.length,r=0;r!=m&&u;r++)u=this.steps[r](u);return u};e.prototype.removeStep=function(u){u=this.steps.indexOf(u);if(-1===u)throw"Step not found in pipeline";this.steps.splice(u,
1)};e.prototype.addWrappedStep=function(u,m){var r=this.controller,p=function(G){var v;var M="frame"==u?[G]:G[u+"s"]||[];var E=0;for(v=M.length;E<v;E++)m.call(r,M[E]);return G};this.addStep(p);return p}},{}],14:[function(e,n,H){e("gl-matrix");e=n.exports=function(u){this.valid=!0;this.id=u.id;this.handId=u.handId;this.length=u.length;this.tool=u.tool;this.width=u.width;this.direction=u.direction;this.stabilizedTipPosition=u.stabilizedTipPosition;this.tipPosition=u.tipPosition;this.tipVelocity=u.tipVelocity;
this.touchZone=u.touchZone;this.touchDistance=u.touchDistance;this.timeVisible=u.timeVisible};e.prototype.toString=function(){return"Pointable [ id:"+this.id+" "+this.length+"mmx | width:"+this.width+"mm | direction:"+this.direction+" ]"};e.prototype.hand=function(){return this.frame.hand(this.handId)};e.Invalid={valid:!1}},{"gl-matrix":23}],15:[function(e,n,H){var u=e("./frame");e("./hand");e("./pointable");e("./finger");var m=e("underscore"),r=e("events").EventEmitter,p=function(v){this.type=v.type;
this.state=v.state};H.chooseProtocol=function(v){switch(v.version){case 1:case 2:case 3:case 4:case 5:case 6:var M=G(v);M.sendBackground=function(E,w){E.send(M.encode({background:w}))};M.sendFocused=function(E,w){E.send(M.encode({focused:w}))};M.sendOptimizeHMD=function(E,w){E.send(M.encode({optimizeHMD:w}))};break;default:throw"unrecognized version";}return M};var G=H.JSONProtocol=function(v){var M=function(E){if(E.event)return new p(E.event);M.emit("beforeFrameCreated",E);var w=new u(E);M.emit("afterFrameCreated",
w,E);return w};M.encode=function(E){return JSON.stringify(E)};M.version=v.version;M.serviceVersion=v.serviceVersion;M.versionLong="Version "+v.version;M.type="protocol";m.extend(M,r.prototype);return M}},{"./finger":7,"./frame":8,"./hand":10,"./pointable":14,events:21,underscore:24}],16:[function(e,n,H){H.UI={Region:e("./ui/region"),Cursor:e("./ui/cursor")}},{"./ui/cursor":17,"./ui/region":18}],17:[function(e,n,H){n.exports=function(){return function(u){var m=u.pointables.sort(function(r,p){return r.z-
p.z})[0];m&&m.valid&&(u.cursorPosition=m.tipPosition);return u}}},{}],18:[function(e,n,H){H=e("events").EventEmitter;e=e("underscore");var u=n.exports=function(m,r){this.start=new Vector(m);this.end=new Vector(r);this.enteredFrame=null};u.prototype.hasPointables=function(m){for(var r=0;r!=m.pointables.length;r++){var p=m.pointables[r].tipPosition;if(p.x>=this.start.x&&p.x<=this.end.x&&p.y>=this.start.y&&p.y<=this.end.y&&p.z>=this.start.z&&p.z<=this.end.z)return!0}return!1};u.prototype.listener=function(m){var r=
this;m&&m.nearThreshold&&this.setupNearRegion(m.nearThreshold);return function(p){return r.updatePosition(p)}};u.prototype.clipper=function(){var m=this;return function(r){m.updatePosition(r);return m.enteredFrame?r:null}};u.prototype.setupNearRegion=function(m){m=this.nearRegion=new u([this.start.x-m,this.start.y-m,this.start.z-m],[this.end.x+m,this.end.y+m,this.end.z+m]);var r=this;m.on("enter",function(p){r.emit("near",p)});m.on("exit",function(p){r.emit("far",p)});r.on("exit",function(p){r.emit("near",
p)})};u.prototype.updatePosition=function(m){this.nearRegion&&this.nearRegion.updatePosition(m);this.hasPointables(m)&&null==this.enteredFrame?(this.enteredFrame=m,this.emit("enter",this.enteredFrame)):this.hasPointables(m)||null==this.enteredFrame||(this.enteredFrame=null,this.emit("exit",this.enteredFrame));return m};u.prototype.normalize=function(m){return new Vector([(m.x-this.start.x)/(this.end.x-this.start.x),(m.y-this.start.y)/(this.end.y-this.start.y),(m.z-this.start.z)/(this.end.z-this.start.z)])};
u.prototype.mapToXY=function(m,r,p){m=this.normalize(m);var G=m.x,v=m.y;1<G?G=1:-1>G&&(G=-1);1<v?v=1:-1>v&&(v=-1);return[(G+1)/2*r,(1-v)/2*p,m.z]};e.extend(u.prototype,H.prototype)},{events:21,underscore:24}],19:[function(e,n,H){n.exports={full:"0.6.4",major:0,minor:6,dot:4}},{}],20:[function(e,n,H){},{}],21:[function(e,n,H){e=e("__browserify_process");e.EventEmitter||(e.EventEmitter=function(){});H=H.EventEmitter=e.EventEmitter;var u="function"===typeof Array.isArray?Array.isArray:function(m){return"[object Array]"===
Object.prototype.toString.call(m)};H.prototype.setMaxListeners=function(m){this._events||(this._events={});this._events.maxListeners=m};H.prototype.emit=function(m){if("error"===m&&(!this._events||!this._events.error||u(this._events.error)&&!this._events.error.length)){if(arguments[1]instanceof Error)throw arguments[1];throw Error("Uncaught, unspecified 'error' event.");}if(!this._events)return!1;var r=this._events[m];if(!r)return!1;if("function"==typeof r){switch(arguments.length){case 1:r.call(this);
break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:var p=Array.prototype.slice.call(arguments,1);r.apply(this,p)}return!0}if(u(r)){p=Array.prototype.slice.call(arguments,1);r=r.slice();for(var G=0,v=r.length;G<v;G++)r[G].apply(this,p);return!0}return!1};H.prototype.addListener=function(m,r){if("function"!==typeof r)throw Error("addListener only takes instances of Function");this._events||(this._events={});this.emit("newListener",m,r);if(this._events[m])if(u(this._events[m])){if(!this._events[m].warned){var p;
(p=void 0!==this._events.maxListeners?this._events.maxListeners:10)&&0<p&&this._events[m].length>p&&(this._events[m].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[m].length),console.trace())}this._events[m].push(r)}else this._events[m]=[this._events[m],r];else this._events[m]=r;return this};H.prototype.on=H.prototype.addListener;H.prototype.once=function(m,r){var p=this;p.on(m,
function v(){p.removeListener(m,v);r.apply(this,arguments)});return this};H.prototype.removeListener=function(m,r){if("function"!==typeof r)throw Error("removeListener only takes instances of Function");if(!this._events||!this._events[m])return this;var p=this._events[m];if(u(p)){a:if(p.indexOf)r=p.indexOf(r);else{for(var G=0;G<p.length;G++)if(r===p[G]){r=G;break a}r=-1}if(0>r)return this;p.splice(r,1);0==p.length&&delete this._events[m]}else this._events[m]===r&&delete this._events[m];return this};
H.prototype.removeAllListeners=function(m){if(0===arguments.length)return this._events={},this;m&&this._events&&this._events[m]&&(this._events[m]=null);return this};H.prototype.listeners=function(m){this._events||(this._events={});this._events[m]||(this._events[m]=[]);u(this._events[m])||(this._events[m]=[this._events[m]]);return this._events[m]};H.listenerCount=function(m,r){return m._events&&m._events[r]?"function"===typeof m._events[r]?1:m._events[r].length:0}},{__browserify_process:22}],22:[function(e,
n,H){e=n.exports={};e.nextTick=function(){if("undefined"!==typeof window&&window.setImmediate)return function(m){return window.setImmediate(m)};if("undefined"!==typeof window&&window.postMessage&&window.addEventListener){var u=[];window.addEventListener("message",function(m){var r=m.source;r!==window&&null!==r||"process-tick"!==m.data||(m.stopPropagation(),0<u.length&&u.shift()())},!0);return function(m){u.push(m);window.postMessage("process-tick","*")}}return function(m){setTimeout(m,0)}}();e.title=
"browser";e.browser=!0;e.env={};e.argv=[];e.binding=function(u){throw Error("process.binding is not supported");};e.cwd=function(){return"/"};e.chdir=function(u){throw Error("process.chdir is not supported");}},{}],23:[function(e,n,H){(function(u){if("undefined"===typeof H)if("function"==typeof define&&"object"==typeof define.amd&&define.amd){var m={};define(function(){return m})}else m="undefined"!==typeof window?window:u;else m=H;(function(r){if(!p)var p=1E-6;if(!G)var G="undefined"!==typeof Float32Array?
Float32Array:Array;if(!v)var v=Math.random;var M={setMatrixArrayType:function(a){G=a}};"undefined"!==typeof r&&(r.glMatrix=M);var E=Math.PI/180;M.toRadian=function(a){return a*E};var w={create:function(){var a=new G(2);a[0]=0;a[1]=0;return a},clone:function(a){var b=new G(2);b[0]=a[0];b[1]=a[1];return b},fromValues:function(a,b){var d=new G(2);d[0]=a;d[1]=b;return d},copy:function(a,b){a[0]=b[0];a[1]=b[1];return a},set:function(a,b,d){a[0]=b;a[1]=d;return a},add:function(a,b,d){a[0]=b[0]+d[0];a[1]=
b[1]+d[1];return a},subtract:function(a,b,d){a[0]=b[0]-d[0];a[1]=b[1]-d[1];return a}};w.sub=w.subtract;w.multiply=function(a,b,d){a[0]=b[0]*d[0];a[1]=b[1]*d[1];return a};w.mul=w.multiply;w.divide=function(a,b,d){a[0]=b[0]/d[0];a[1]=b[1]/d[1];return a};w.div=w.divide;w.min=function(a,b,d){a[0]=Math.min(b[0],d[0]);a[1]=Math.min(b[1],d[1]);return a};w.max=function(a,b,d){a[0]=Math.max(b[0],d[0]);a[1]=Math.max(b[1],d[1]);return a};w.scale=function(a,b,d){a[0]=b[0]*d;a[1]=b[1]*d;return a};w.scaleAndAdd=
function(a,b,d,f){a[0]=b[0]+d[0]*f;a[1]=b[1]+d[1]*f;return a};w.distance=function(a,b){var d=b[0]-a[0];a=b[1]-a[1];return Math.sqrt(d*d+a*a)};w.dist=w.distance;w.squaredDistance=function(a,b){var d=b[0]-a[0];a=b[1]-a[1];return d*d+a*a};w.sqrDist=w.squaredDistance;w.length=function(a){var b=a[0];a=a[1];return Math.sqrt(b*b+a*a)};w.len=w.length;w.squaredLength=function(a){var b=a[0];a=a[1];return b*b+a*a};w.sqrLen=w.squaredLength;w.negate=function(a,b){a[0]=-b[0];a[1]=-b[1];return a};w.normalize=function(a,
b){var d=b[0],f=b[1];d=d*d+f*f;0<d&&(d=1/Math.sqrt(d),a[0]=b[0]*d,a[1]=b[1]*d);return a};w.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]};w.cross=function(a,b,d){b=b[0]*d[1]-b[1]*d[0];a[0]=a[1]=0;a[2]=b;return a};w.lerp=function(a,b,d,f){var g=b[0];b=b[1];a[0]=g+f*(d[0]-g);a[1]=b+f*(d[1]-b);return a};w.random=function(a,b){b=b||1;var d=2*v()*Math.PI;a[0]=Math.cos(d)*b;a[1]=Math.sin(d)*b;return a};w.transformMat2=function(a,b,d){var f=b[0];b=b[1];a[0]=d[0]*f+d[2]*b;a[1]=d[1]*f+d[3]*b;return a};w.transformMat2d=
function(a,b,d){var f=b[0];b=b[1];a[0]=d[0]*f+d[2]*b+d[4];a[1]=d[1]*f+d[3]*b+d[5];return a};w.transformMat3=function(a,b,d){var f=b[0];b=b[1];a[0]=d[0]*f+d[3]*b+d[6];a[1]=d[1]*f+d[4]*b+d[7];return a};w.transformMat4=function(a,b,d){var f=b[0];b=b[1];a[0]=d[0]*f+d[4]*b+d[12];a[1]=d[1]*f+d[5]*b+d[13];return a};w.forEach=function(){var a=w.create();return function(b,d,f,g,l,A){d||(d=2);f||(f=0);for(g=g?Math.min(g*d+f,b.length):b.length;f<g;f+=d)a[0]=b[f],a[1]=b[f+1],l(a,a,A),b[f]=a[0],b[f+1]=a[1];return b}}();
w.str=function(a){return"vec2("+a[0]+", "+a[1]+")"};"undefined"!==typeof r&&(r.vec2=w);var N={create:function(){var a=new G(3);a[0]=0;a[1]=0;a[2]=0;return a},clone:function(a){var b=new G(3);b[0]=a[0];b[1]=a[1];b[2]=a[2];return b},fromValues:function(a,b,d){var f=new G(3);f[0]=a;f[1]=b;f[2]=d;return f},copy:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];return a},set:function(a,b,d,f){a[0]=b;a[1]=d;a[2]=f;return a},add:function(a,b,d){a[0]=b[0]+d[0];a[1]=b[1]+d[1];a[2]=b[2]+d[2];return a},subtract:function(a,
b,d){a[0]=b[0]-d[0];a[1]=b[1]-d[1];a[2]=b[2]-d[2];return a}};N.sub=N.subtract;N.multiply=function(a,b,d){a[0]=b[0]*d[0];a[1]=b[1]*d[1];a[2]=b[2]*d[2];return a};N.mul=N.multiply;N.divide=function(a,b,d){a[0]=b[0]/d[0];a[1]=b[1]/d[1];a[2]=b[2]/d[2];return a};N.div=N.divide;N.min=function(a,b,d){a[0]=Math.min(b[0],d[0]);a[1]=Math.min(b[1],d[1]);a[2]=Math.min(b[2],d[2]);return a};N.max=function(a,b,d){a[0]=Math.max(b[0],d[0]);a[1]=Math.max(b[1],d[1]);a[2]=Math.max(b[2],d[2]);return a};N.scale=function(a,
b,d){a[0]=b[0]*d;a[1]=b[1]*d;a[2]=b[2]*d;return a};N.scaleAndAdd=function(a,b,d,f){a[0]=b[0]+d[0]*f;a[1]=b[1]+d[1]*f;a[2]=b[2]+d[2]*f;return a};N.distance=function(a,b){var d=b[0]-a[0],f=b[1]-a[1];a=b[2]-a[2];return Math.sqrt(d*d+f*f+a*a)};N.dist=N.distance;N.squaredDistance=function(a,b){var d=b[0]-a[0],f=b[1]-a[1];a=b[2]-a[2];return d*d+f*f+a*a};N.sqrDist=N.squaredDistance;N.length=function(a){var b=a[0],d=a[1];a=a[2];return Math.sqrt(b*b+d*d+a*a)};N.len=N.length;N.squaredLength=function(a){var b=
a[0],d=a[1];a=a[2];return b*b+d*d+a*a};N.sqrLen=N.squaredLength;N.negate=function(a,b){a[0]=-b[0];a[1]=-b[1];a[2]=-b[2];return a};N.normalize=function(a,b){var d=b[0],f=b[1],g=b[2];d=d*d+f*f+g*g;0<d&&(d=1/Math.sqrt(d),a[0]=b[0]*d,a[1]=b[1]*d,a[2]=b[2]*d);return a};N.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]};N.cross=function(a,b,d){var f=b[0],g=b[1];b=b[2];var l=d[0],A=d[1];d=d[2];a[0]=g*d-b*A;a[1]=b*l-f*d;a[2]=f*A-g*l;return a};N.lerp=function(a,b,d,f){var g=b[0],l=b[1];b=b[2];a[0]=
g+f*(d[0]-g);a[1]=l+f*(d[1]-l);a[2]=b+f*(d[2]-b);return a};N.random=function(a,b){b=b||1;var d=2*v()*Math.PI,f=2*v()-1,g=Math.sqrt(1-f*f)*b;a[0]=Math.cos(d)*g;a[1]=Math.sin(d)*g;a[2]=f*b;return a};N.transformMat4=function(a,b,d){var f=b[0],g=b[1];b=b[2];a[0]=d[0]*f+d[4]*g+d[8]*b+d[12];a[1]=d[1]*f+d[5]*g+d[9]*b+d[13];a[2]=d[2]*f+d[6]*g+d[10]*b+d[14];return a};N.transformMat3=function(a,b,d){var f=b[0],g=b[1];b=b[2];a[0]=f*d[0]+g*d[3]+b*d[6];a[1]=f*d[1]+g*d[4]+b*d[7];a[2]=f*d[2]+g*d[5]+b*d[8];return a};
N.transformQuat=function(a,b,d){var f=b[0],g=b[1],l=b[2];b=d[0];var A=d[1],h=d[2];d=d[3];var C=d*f+A*l-h*g,J=d*g+h*f-b*l,O=d*l+b*g-A*f;f=-b*f-A*g-h*l;a[0]=C*d+f*-b+J*-h-O*-A;a[1]=J*d+f*-A+O*-b-C*-h;a[2]=O*d+f*-h+C*-A-J*-b;return a};N.rotateX=function(a,b,d,f){var g=[],l=[];g[0]=b[0]-d[0];g[1]=b[1]-d[1];g[2]=b[2]-d[2];l[0]=g[0];l[1]=g[1]*Math.cos(f)-g[2]*Math.sin(f);l[2]=g[1]*Math.sin(f)+g[2]*Math.cos(f);a[0]=l[0]+d[0];a[1]=l[1]+d[1];a[2]=l[2]+d[2];return a};N.rotateY=function(a,b,d,f){var g=[],l=
[];g[0]=b[0]-d[0];g[1]=b[1]-d[1];g[2]=b[2]-d[2];l[0]=g[2]*Math.sin(f)+g[0]*Math.cos(f);l[1]=g[1];l[2]=g[2]*Math.cos(f)-g[0]*Math.sin(f);a[0]=l[0]+d[0];a[1]=l[1]+d[1];a[2]=l[2]+d[2];return a};N.rotateZ=function(a,b,d,f){var g=[],l=[];g[0]=b[0]-d[0];g[1]=b[1]-d[1];g[2]=b[2]-d[2];l[0]=g[0]*Math.cos(f)-g[1]*Math.sin(f);l[1]=g[0]*Math.sin(f)+g[1]*Math.cos(f);l[2]=g[2];a[0]=l[0]+d[0];a[1]=l[1]+d[1];a[2]=l[2]+d[2];return a};N.forEach=function(){var a=N.create();return function(b,d,f,g,l,A){d||(d=3);f||(f=
0);for(g=g?Math.min(g*d+f,b.length):b.length;f<g;f+=d)a[0]=b[f],a[1]=b[f+1],a[2]=b[f+2],l(a,a,A),b[f]=a[0],b[f+1]=a[1],b[f+2]=a[2];return b}}();N.str=function(a){return"vec3("+a[0]+", "+a[1]+", "+a[2]+")"};"undefined"!==typeof r&&(r.vec3=N);var R={create:function(){var a=new G(4);a[0]=0;a[1]=0;a[2]=0;a[3]=0;return a},clone:function(a){var b=new G(4);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b},fromValues:function(a,b,d,f){var g=new G(4);g[0]=a;g[1]=b;g[2]=d;g[3]=f;return g},copy:function(a,b){a[0]=
b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];return a},set:function(a,b,d,f,g){a[0]=b;a[1]=d;a[2]=f;a[3]=g;return a},add:function(a,b,d){a[0]=b[0]+d[0];a[1]=b[1]+d[1];a[2]=b[2]+d[2];a[3]=b[3]+d[3];return a},subtract:function(a,b,d){a[0]=b[0]-d[0];a[1]=b[1]-d[1];a[2]=b[2]-d[2];a[3]=b[3]-d[3];return a}};R.sub=R.subtract;R.multiply=function(a,b,d){a[0]=b[0]*d[0];a[1]=b[1]*d[1];a[2]=b[2]*d[2];a[3]=b[3]*d[3];return a};R.mul=R.multiply;R.divide=function(a,b,d){a[0]=b[0]/d[0];a[1]=b[1]/d[1];a[2]=b[2]/d[2];a[3]=b[3]/
d[3];return a};R.div=R.divide;R.min=function(a,b,d){a[0]=Math.min(b[0],d[0]);a[1]=Math.min(b[1],d[1]);a[2]=Math.min(b[2],d[2]);a[3]=Math.min(b[3],d[3]);return a};R.max=function(a,b,d){a[0]=Math.max(b[0],d[0]);a[1]=Math.max(b[1],d[1]);a[2]=Math.max(b[2],d[2]);a[3]=Math.max(b[3],d[3]);return a};R.scale=function(a,b,d){a[0]=b[0]*d;a[1]=b[1]*d;a[2]=b[2]*d;a[3]=b[3]*d;return a};R.scaleAndAdd=function(a,b,d,f){a[0]=b[0]+d[0]*f;a[1]=b[1]+d[1]*f;a[2]=b[2]+d[2]*f;a[3]=b[3]+d[3]*f;return a};R.distance=function(a,
b){var d=b[0]-a[0],f=b[1]-a[1],g=b[2]-a[2];a=b[3]-a[3];return Math.sqrt(d*d+f*f+g*g+a*a)};R.dist=R.distance;R.squaredDistance=function(a,b){var d=b[0]-a[0],f=b[1]-a[1],g=b[2]-a[2];a=b[3]-a[3];return d*d+f*f+g*g+a*a};R.sqrDist=R.squaredDistance;R.length=function(a){var b=a[0],d=a[1],f=a[2];a=a[3];return Math.sqrt(b*b+d*d+f*f+a*a)};R.len=R.length;R.squaredLength=function(a){var b=a[0],d=a[1],f=a[2];a=a[3];return b*b+d*d+f*f+a*a};R.sqrLen=R.squaredLength;R.negate=function(a,b){a[0]=-b[0];a[1]=-b[1];
a[2]=-b[2];a[3]=-b[3];return a};R.normalize=function(a,b){var d=b[0],f=b[1],g=b[2],l=b[3];d=d*d+f*f+g*g+l*l;0<d&&(d=1/Math.sqrt(d),a[0]=b[0]*d,a[1]=b[1]*d,a[2]=b[2]*d,a[3]=b[3]*d);return a};R.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]};R.lerp=function(a,b,d,f){var g=b[0],l=b[1],A=b[2];b=b[3];a[0]=g+f*(d[0]-g);a[1]=l+f*(d[1]-l);a[2]=A+f*(d[2]-A);a[3]=b+f*(d[3]-b);return a};R.random=function(a,b){b=b||1;a[0]=v();a[1]=v();a[2]=v();a[3]=v();R.normalize(a,a);R.scale(a,a,b);return a};
R.transformMat4=function(a,b,d){var f=b[0],g=b[1],l=b[2];b=b[3];a[0]=d[0]*f+d[4]*g+d[8]*l+d[12]*b;a[1]=d[1]*f+d[5]*g+d[9]*l+d[13]*b;a[2]=d[2]*f+d[6]*g+d[10]*l+d[14]*b;a[3]=d[3]*f+d[7]*g+d[11]*l+d[15]*b;return a};R.transformQuat=function(a,b,d){var f=b[0],g=b[1],l=b[2];b=d[0];var A=d[1],h=d[2];d=d[3];var C=d*f+A*l-h*g,J=d*g+h*f-b*l,O=d*l+b*g-A*f;f=-b*f-A*g-h*l;a[0]=C*d+f*-b+J*-h-O*-A;a[1]=J*d+f*-A+O*-b-C*-h;a[2]=O*d+f*-h+C*-A-J*-b;return a};R.forEach=function(){var a=R.create();return function(b,d,
f,g,l,A){d||(d=4);f||(f=0);for(g=g?Math.min(g*d+f,b.length):b.length;f<g;f+=d)a[0]=b[f],a[1]=b[f+1],a[2]=b[f+2],a[3]=b[f+3],l(a,a,A),b[f]=a[0],b[f+1]=a[1],b[f+2]=a[2],b[f+3]=a[3];return b}}();R.str=function(a){return"vec4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"};"undefined"!==typeof r&&(r.vec4=R);M={create:function(){var a=new G(4);a[0]=1;a[1]=0;a[2]=0;a[3]=1;return a},clone:function(a){var b=new G(4);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b},copy:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];
a[3]=b[3];return a},identity:function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=1;return a},transpose:function(a,b){if(a===b){var d=b[1];a[1]=b[2];a[2]=d}else a[0]=b[0],a[1]=b[2],a[2]=b[1],a[3]=b[3];return a},invert:function(a,b){var d=b[0],f=b[1],g=b[2];b=b[3];var l=d*b-g*f;if(!l)return null;l=1/l;a[0]=b*l;a[1]=-f*l;a[2]=-g*l;a[3]=d*l;return a},adjoint:function(a,b){var d=b[0];a[0]=b[3];a[1]=-b[1];a[2]=-b[2];a[3]=d;return a},determinant:function(a){return a[0]*a[3]-a[2]*a[1]},multiply:function(a,b,d){var f=b[0],
g=b[1],l=b[2];b=b[3];var A=d[0],h=d[1],C=d[2];d=d[3];a[0]=f*A+l*h;a[1]=g*A+b*h;a[2]=f*C+l*d;a[3]=g*C+b*d;return a}};M.mul=M.multiply;M.rotate=function(a,b,d){var f=b[0],g=b[1],l=b[2];b=b[3];var A=Math.sin(d);d=Math.cos(d);a[0]=f*d+l*A;a[1]=g*d+b*A;a[2]=f*-A+l*d;a[3]=g*-A+b*d;return a};M.scale=function(a,b,d){var f=b[1],g=b[2],l=b[3],A=d[0];d=d[1];a[0]=b[0]*A;a[1]=f*A;a[2]=g*d;a[3]=l*d;return a};M.str=function(a){return"mat2("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"};M.frob=function(a){return Math.sqrt(Math.pow(a[0],
2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2))};M.LDU=function(a,b,d,f){a[2]=f[2]/f[0];d[0]=f[0];d[1]=f[1];d[3]=f[3]-a[2]*d[1];return[a,b,d]};"undefined"!==typeof r&&(r.mat2=M);M={create:function(){var a=new G(6);a[0]=1;a[1]=0;a[2]=0;a[3]=1;a[4]=0;a[5]=0;return a},clone:function(a){var b=new G(6);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];return b},copy:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];return a},identity:function(a){a[0]=1;a[1]=0;a[2]=
0;a[3]=1;a[4]=0;a[5]=0;return a},invert:function(a,b){var d=b[0],f=b[1],g=b[2],l=b[3],A=b[4];b=b[5];var h=d*l-f*g;if(!h)return null;h=1/h;a[0]=l*h;a[1]=-f*h;a[2]=-g*h;a[3]=d*h;a[4]=(g*b-l*A)*h;a[5]=(f*A-d*b)*h;return a},determinant:function(a){return a[0]*a[3]-a[1]*a[2]},multiply:function(a,b,d){var f=b[0],g=b[1],l=b[2],A=b[3],h=b[4];b=b[5];var C=d[0],J=d[1],O=d[2],S=d[3],T=d[4];d=d[5];a[0]=f*C+l*J;a[1]=g*C+A*J;a[2]=f*O+l*S;a[3]=g*O+A*S;a[4]=f*T+l*d+h;a[5]=g*T+A*d+b;return a}};M.mul=M.multiply;M.rotate=
function(a,b,d){var f=b[0],g=b[1],l=b[2],A=b[3],h=b[4];b=b[5];var C=Math.sin(d);d=Math.cos(d);a[0]=f*d+l*C;a[1]=g*d+A*C;a[2]=f*-C+l*d;a[3]=g*-C+A*d;a[4]=h;a[5]=b;return a};M.scale=function(a,b,d){var f=b[1],g=b[2],l=b[3],A=b[4],h=b[5],C=d[0];d=d[1];a[0]=b[0]*C;a[1]=f*C;a[2]=g*d;a[3]=l*d;a[4]=A;a[5]=h;return a};M.translate=function(a,b,d){var f=b[0],g=b[1],l=b[2],A=b[3],h=b[4];b=b[5];var C=d[0];d=d[1];a[0]=f;a[1]=g;a[2]=l;a[3]=A;a[4]=f*C+l*d+h;a[5]=g*C+A*d+b;return a};M.str=function(a){return"mat2d("+
a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+")"};M.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+1)};"undefined"!==typeof r&&(r.mat2d=M);var I={create:function(){var a=new G(9);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a},fromMat4:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[4];a[4]=b[5];a[5]=b[6];a[6]=b[8];a[7]=b[9];a[8]=b[10];return a},clone:function(a){var b=new G(9);
b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b},copy:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];return a},identity:function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a},transpose:function(a,b){if(a===b){var d=b[1],f=b[2],g=b[5];a[1]=b[3];a[2]=b[6];a[3]=d;a[5]=b[7];a[6]=f;a[7]=g}else a[0]=b[0],a[1]=b[3],a[2]=b[6],a[3]=b[1],a[4]=b[4],a[5]=b[7],a[6]=b[2],a[7]=
b[5],a[8]=b[8];return a},invert:function(a,b){var d=b[0],f=b[1],g=b[2],l=b[3],A=b[4],h=b[5],C=b[6],J=b[7];b=b[8];var O=b*A-h*J,S=-b*l+h*C,T=J*l-A*C,V=d*O+f*S+g*T;if(!V)return null;V=1/V;a[0]=O*V;a[1]=(-b*f+g*J)*V;a[2]=(h*f-g*A)*V;a[3]=S*V;a[4]=(b*d-g*C)*V;a[5]=(-h*d+g*l)*V;a[6]=T*V;a[7]=(-J*d+f*C)*V;a[8]=(A*d-f*l)*V;return a},adjoint:function(a,b){var d=b[0],f=b[1],g=b[2],l=b[3],A=b[4],h=b[5],C=b[6],J=b[7];b=b[8];a[0]=A*b-h*J;a[1]=g*J-f*b;a[2]=f*h-g*A;a[3]=h*C-l*b;a[4]=d*b-g*C;a[5]=g*l-d*h;a[6]=l*
J-A*C;a[7]=f*C-d*J;a[8]=d*A-f*l;return a},determinant:function(a){var b=a[3],d=a[4],f=a[5],g=a[6],l=a[7],A=a[8];return a[0]*(A*d-f*l)+a[1]*(-A*b+f*g)+a[2]*(l*b-d*g)},multiply:function(a,b,d){var f=b[0],g=b[1],l=b[2],A=b[3],h=b[4],C=b[5],J=b[6],O=b[7];b=b[8];var S=d[0],T=d[1],V=d[2],Z=d[3],Y=d[4],da=d[5],ia=d[6],ba=d[7];d=d[8];a[0]=S*f+T*A+V*J;a[1]=S*g+T*h+V*O;a[2]=S*l+T*C+V*b;a[3]=Z*f+Y*A+da*J;a[4]=Z*g+Y*h+da*O;a[5]=Z*l+Y*C+da*b;a[6]=ia*f+ba*A+d*J;a[7]=ia*g+ba*h+d*O;a[8]=ia*l+ba*C+d*b;return a}};
I.mul=I.multiply;I.translate=function(a,b,d){var f=b[0],g=b[1],l=b[2],A=b[3],h=b[4],C=b[5],J=b[6],O=b[7];b=b[8];var S=d[0];d=d[1];a[0]=f;a[1]=g;a[2]=l;a[3]=A;a[4]=h;a[5]=C;a[6]=S*f+d*A+J;a[7]=S*g+d*h+O;a[8]=S*l+d*C+b;return a};I.rotate=function(a,b,d){var f=b[0],g=b[1],l=b[2],A=b[3],h=b[4],C=b[5],J=b[6],O=b[7];b=b[8];var S=Math.sin(d);d=Math.cos(d);a[0]=d*f+S*A;a[1]=d*g+S*h;a[2]=d*l+S*C;a[3]=d*A-S*f;a[4]=d*h-S*g;a[5]=d*C-S*l;a[6]=J;a[7]=O;a[8]=b;return a};I.scale=function(a,b,d){var f=d[0];d=d[1];
a[0]=f*b[0];a[1]=f*b[1];a[2]=f*b[2];a[3]=d*b[3];a[4]=d*b[4];a[5]=d*b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];return a};I.fromMat2d=function(a,b){a[0]=b[0];a[1]=b[1];a[2]=0;a[3]=b[2];a[4]=b[3];a[5]=0;a[6]=b[4];a[7]=b[5];a[8]=1;return a};I.fromQuat=function(a,b){var d=b[0],f=b[1],g=b[2];b=b[3];var l=d+d,A=f+f,h=g+g;d*=l;var C=f*l;f*=A;var J=g*l,O=g*A;g*=h;l*=b;A*=b;b*=h;a[0]=1-f-g;a[3]=C-b;a[6]=J+A;a[1]=C+b;a[4]=1-d-g;a[7]=O-l;a[2]=J-A;a[5]=O+l;a[8]=1-d-f;return a};I.normalFromMat4=function(a,b){var d=b[0],
f=b[1],g=b[2],l=b[3],A=b[4],h=b[5],C=b[6],J=b[7],O=b[8],S=b[9],T=b[10],V=b[11],Z=b[12],Y=b[13],da=b[14];b=b[15];var ia=d*h-f*A,ba=d*C-g*A,ea=d*J-l*A,ca=f*C-g*h,q=f*J-l*h,F=g*J-l*C,K=O*Y-S*Z,Q=O*da-T*Z;O=O*b-V*Z;var W=S*da-T*Y;S=S*b-V*Y;T=T*b-V*da;V=ia*T-ba*S+ea*W+ca*O-q*Q+F*K;if(!V)return null;V=1/V;a[0]=(h*T-C*S+J*W)*V;a[1]=(C*O-A*T-J*Q)*V;a[2]=(A*S-h*O+J*K)*V;a[3]=(g*S-f*T-l*W)*V;a[4]=(d*T-g*O+l*Q)*V;a[5]=(f*O-d*S-l*K)*V;a[6]=(Y*F-da*q+b*ca)*V;a[7]=(da*ea-Z*F-b*ba)*V;a[8]=(Z*q-Y*ea+b*ia)*V;return a};
I.str=function(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"};I.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2))};"undefined"!==typeof r&&(r.mat3=I);var B={create:function(){var a=new G(16);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=
1;return a},clone:function(a){var b=new G(16);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b},copy:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];a[9]=b[9];a[10]=b[10];a[11]=b[11];a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a},identity:function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=
0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a},transpose:function(a,b){if(a===b){var d=b[1],f=b[2],g=b[3],l=b[6],A=b[7],h=b[11];a[1]=b[4];a[2]=b[8];a[3]=b[12];a[4]=d;a[6]=b[9];a[7]=b[13];a[8]=f;a[9]=l;a[11]=b[14];a[12]=g;a[13]=A;a[14]=h}else a[0]=b[0],a[1]=b[4],a[2]=b[8],a[3]=b[12],a[4]=b[1],a[5]=b[5],a[6]=b[9],a[7]=b[13],a[8]=b[2],a[9]=b[6],a[10]=b[10],a[11]=b[14],a[12]=b[3],a[13]=b[7],a[14]=b[11],a[15]=b[15];return a},invert:function(a,b){var d=b[0],f=b[1],g=b[2],l=b[3],
A=b[4],h=b[5],C=b[6],J=b[7],O=b[8],S=b[9],T=b[10],V=b[11],Z=b[12],Y=b[13],da=b[14];b=b[15];var ia=d*h-f*A,ba=d*C-g*A,ea=d*J-l*A,ca=f*C-g*h,q=f*J-l*h,F=g*J-l*C,K=O*Y-S*Z,Q=O*da-T*Z,W=O*b-V*Z,X=S*da-T*Y,fa=S*b-V*Y,ja=T*b-V*da,ka=ia*ja-ba*fa+ea*X+ca*W-q*Q+F*K;if(!ka)return null;ka=1/ka;a[0]=(h*ja-C*fa+J*X)*ka;a[1]=(g*fa-f*ja-l*X)*ka;a[2]=(Y*F-da*q+b*ca)*ka;a[3]=(T*q-S*F-V*ca)*ka;a[4]=(C*W-A*ja-J*Q)*ka;a[5]=(d*ja-g*W+l*Q)*ka;a[6]=(da*ea-Z*F-b*ba)*ka;a[7]=(O*F-T*ea+V*ba)*ka;a[8]=(A*fa-h*W+J*K)*ka;a[9]=
(f*W-d*fa-l*K)*ka;a[10]=(Z*q-Y*ea+b*ia)*ka;a[11]=(S*ea-O*q-V*ia)*ka;a[12]=(h*Q-A*X-C*K)*ka;a[13]=(d*X-f*Q+g*K)*ka;a[14]=(Y*ba-Z*ca-da*ia)*ka;a[15]=(O*ca-S*ba+T*ia)*ka;return a},adjoint:function(a,b){var d=b[0],f=b[1],g=b[2],l=b[3],A=b[4],h=b[5],C=b[6],J=b[7],O=b[8],S=b[9],T=b[10],V=b[11],Z=b[12],Y=b[13],da=b[14];b=b[15];a[0]=h*(T*b-V*da)-S*(C*b-J*da)+Y*(C*V-J*T);a[1]=-(f*(T*b-V*da)-S*(g*b-l*da)+Y*(g*V-l*T));a[2]=f*(C*b-J*da)-h*(g*b-l*da)+Y*(g*J-l*C);a[3]=-(f*(C*V-J*T)-h*(g*V-l*T)+S*(g*J-l*C));a[4]=
-(A*(T*b-V*da)-O*(C*b-J*da)+Z*(C*V-J*T));a[5]=d*(T*b-V*da)-O*(g*b-l*da)+Z*(g*V-l*T);a[6]=-(d*(C*b-J*da)-A*(g*b-l*da)+Z*(g*J-l*C));a[7]=d*(C*V-J*T)-A*(g*V-l*T)+O*(g*J-l*C);a[8]=A*(S*b-V*Y)-O*(h*b-J*Y)+Z*(h*V-J*S);a[9]=-(d*(S*b-V*Y)-O*(f*b-l*Y)+Z*(f*V-l*S));a[10]=d*(h*b-J*Y)-A*(f*b-l*Y)+Z*(f*J-l*h);a[11]=-(d*(h*V-J*S)-A*(f*V-l*S)+O*(f*J-l*h));a[12]=-(A*(S*da-T*Y)-O*(h*da-C*Y)+Z*(h*T-C*S));a[13]=d*(S*da-T*Y)-O*(f*da-g*Y)+Z*(f*T-g*S);a[14]=-(d*(h*da-C*Y)-A*(f*da-g*Y)+Z*(f*C-g*h));a[15]=d*(h*T-C*S)-A*
(f*T-g*S)+O*(f*C-g*h);return a},determinant:function(a){var b=a[0],d=a[1],f=a[2],g=a[3],l=a[4],A=a[5],h=a[6],C=a[7],J=a[8],O=a[9],S=a[10],T=a[11],V=a[12],Z=a[13],Y=a[14];a=a[15];return(b*A-d*l)*(S*a-T*Y)-(b*h-f*l)*(O*a-T*Z)+(b*C-g*l)*(O*Y-S*Z)+(d*h-f*A)*(J*a-T*V)-(d*C-g*A)*(J*Y-S*V)+(f*C-g*h)*(J*Z-O*V)},multiply:function(a,b,d){var f=b[0],g=b[1],l=b[2],A=b[3],h=b[4],C=b[5],J=b[6],O=b[7],S=b[8],T=b[9],V=b[10],Z=b[11],Y=b[12],da=b[13],ia=b[14];b=b[15];var ba=d[0],ea=d[1],ca=d[2],q=d[3];a[0]=ba*f+ea*
h+ca*S+q*Y;a[1]=ba*g+ea*C+ca*T+q*da;a[2]=ba*l+ea*J+ca*V+q*ia;a[3]=ba*A+ea*O+ca*Z+q*b;ba=d[4];ea=d[5];ca=d[6];q=d[7];a[4]=ba*f+ea*h+ca*S+q*Y;a[5]=ba*g+ea*C+ca*T+q*da;a[6]=ba*l+ea*J+ca*V+q*ia;a[7]=ba*A+ea*O+ca*Z+q*b;ba=d[8];ea=d[9];ca=d[10];q=d[11];a[8]=ba*f+ea*h+ca*S+q*Y;a[9]=ba*g+ea*C+ca*T+q*da;a[10]=ba*l+ea*J+ca*V+q*ia;a[11]=ba*A+ea*O+ca*Z+q*b;ba=d[12];ea=d[13];ca=d[14];q=d[15];a[12]=ba*f+ea*h+ca*S+q*Y;a[13]=ba*g+ea*C+ca*T+q*da;a[14]=ba*l+ea*J+ca*V+q*ia;a[15]=ba*A+ea*O+ca*Z+q*b;return a}};B.mul=
B.multiply;B.translate=function(a,b,d){var f=d[0],g=d[1];d=d[2];if(b===a)a[12]=b[0]*f+b[4]*g+b[8]*d+b[12],a[13]=b[1]*f+b[5]*g+b[9]*d+b[13],a[14]=b[2]*f+b[6]*g+b[10]*d+b[14],a[15]=b[3]*f+b[7]*g+b[11]*d+b[15];else{var l=b[0];var A=b[1];var h=b[2];var C=b[3];var J=b[4];var O=b[5];var S=b[6];var T=b[7];var V=b[8];var Z=b[9];var Y=b[10];var da=b[11];a[0]=l;a[1]=A;a[2]=h;a[3]=C;a[4]=J;a[5]=O;a[6]=S;a[7]=T;a[8]=V;a[9]=Z;a[10]=Y;a[11]=da;a[12]=l*f+J*g+V*d+b[12];a[13]=A*f+O*g+Z*d+b[13];a[14]=h*f+S*g+Y*d+b[14];
a[15]=C*f+T*g+da*d+b[15]}return a};B.scale=function(a,b,d){var f=d[0],g=d[1];d=d[2];a[0]=b[0]*f;a[1]=b[1]*f;a[2]=b[2]*f;a[3]=b[3]*f;a[4]=b[4]*g;a[5]=b[5]*g;a[6]=b[6]*g;a[7]=b[7]*g;a[8]=b[8]*d;a[9]=b[9]*d;a[10]=b[10]*d;a[11]=b[11]*d;a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a};B.rotate=function(a,b,d,f){var g=f[0],l=f[1];f=f[2];var A=Math.sqrt(g*g+l*l+f*f);if(Math.abs(A)<p)return null;A=1/A;g*=A;l*=A;f*=A;var h=Math.sin(d);var C=Math.cos(d);var J=1-C;d=b[0];A=b[1];var O=b[2];var S=b[3];
var T=b[4];var V=b[5];var Z=b[6];var Y=b[7];var da=b[8];var ia=b[9];var ba=b[10];var ea=b[11];var ca=g*g*J+C;var q=l*g*J+f*h;var F=f*g*J-l*h;var K=g*l*J-f*h;var Q=l*l*J+C;var W=f*l*J+g*h;var X=g*f*J+l*h;g=l*f*J-g*h;l=f*f*J+C;a[0]=d*ca+T*q+da*F;a[1]=A*ca+V*q+ia*F;a[2]=O*ca+Z*q+ba*F;a[3]=S*ca+Y*q+ea*F;a[4]=d*K+T*Q+da*W;a[5]=A*K+V*Q+ia*W;a[6]=O*K+Z*Q+ba*W;a[7]=S*K+Y*Q+ea*W;a[8]=d*X+T*g+da*l;a[9]=A*X+V*g+ia*l;a[10]=O*X+Z*g+ba*l;a[11]=S*X+Y*g+ea*l;b!==a&&(a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);
return a};B.rotateX=function(a,b,d){var f=Math.sin(d);d=Math.cos(d);var g=b[4],l=b[5],A=b[6],h=b[7],C=b[8],J=b[9],O=b[10],S=b[11];b!==a&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[4]=g*d+C*f;a[5]=l*d+J*f;a[6]=A*d+O*f;a[7]=h*d+S*f;a[8]=C*d-g*f;a[9]=J*d-l*f;a[10]=O*d-A*f;a[11]=S*d-h*f;return a};B.rotateY=function(a,b,d){var f=Math.sin(d);d=Math.cos(d);var g=b[0],l=b[1],A=b[2],h=b[3],C=b[8],J=b[9],O=b[10],S=b[11];b!==a&&(a[4]=b[4],a[5]=b[5],a[6]=b[6],
a[7]=b[7],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[0]=g*d-C*f;a[1]=l*d-J*f;a[2]=A*d-O*f;a[3]=h*d-S*f;a[8]=g*f+C*d;a[9]=l*f+J*d;a[10]=A*f+O*d;a[11]=h*f+S*d;return a};B.rotateZ=function(a,b,d){var f=Math.sin(d);d=Math.cos(d);var g=b[0],l=b[1],A=b[2],h=b[3],C=b[4],J=b[5],O=b[6],S=b[7];b!==a&&(a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[0]=g*d+C*f;a[1]=l*d+J*f;a[2]=A*d+O*f;a[3]=h*d+S*f;a[4]=C*d-g*f;a[5]=J*d-l*f;a[6]=O*d-A*f;a[7]=S*d-h*f;return a};
B.fromRotationTranslation=function(a,b,d){var f=b[0],g=b[1],l=b[2],A=b[3],h=f+f,C=g+g,J=l+l;b=f*h;var O=f*C;f*=J;var S=g*C;g*=J;l*=J;h*=A;C*=A;A*=J;a[0]=1-(S+l);a[1]=O+A;a[2]=f-C;a[3]=0;a[4]=O-A;a[5]=1-(b+l);a[6]=g+h;a[7]=0;a[8]=f+C;a[9]=g-h;a[10]=1-(b+S);a[11]=0;a[12]=d[0];a[13]=d[1];a[14]=d[2];a[15]=1;return a};B.fromQuat=function(a,b){var d=b[0],f=b[1],g=b[2];b=b[3];var l=d+d,A=f+f,h=g+g;d*=l;var C=f*l;f*=A;var J=g*l,O=g*A;g*=h;l*=b;A*=b;b*=h;a[0]=1-f-g;a[1]=C+b;a[2]=J-A;a[3]=0;a[4]=C-b;a[5]=1-
d-g;a[6]=O+l;a[7]=0;a[8]=J+A;a[9]=O-l;a[10]=1-d-f;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};B.frustum=function(a,b,d,f,g,l,A){var h=1/(d-b),C=1/(g-f),J=1/(l-A);a[0]=2*l*h;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=2*l*C;a[6]=0;a[7]=0;a[8]=(d+b)*h;a[9]=(g+f)*C;a[10]=(A+l)*J;a[11]=-1;a[12]=0;a[13]=0;a[14]=A*l*2*J;a[15]=0;return a};B.perspective=function(a,b,d,f,g){b=1/Math.tan(b/2);var l=1/(f-g);a[0]=b/d;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=b;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=(g+f)*l;a[11]=-1;a[12]=0;a[13]=
0;a[14]=2*g*f*l;a[15]=0;return a};B.ortho=function(a,b,d,f,g,l,A){var h=1/(b-d),C=1/(f-g),J=1/(l-A);a[0]=-2*h;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=-2*C;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=2*J;a[11]=0;a[12]=(b+d)*h;a[13]=(g+f)*C;a[14]=(A+l)*J;a[15]=1;return a};B.lookAt=function(a,b,d,f){var g=b[0],l=b[1];b=b[2];var A=f[0];var h=f[1];var C=f[2];var J=d[0];f=d[1];var O=d[2];if(Math.abs(g-J)<p&&Math.abs(l-f)<p&&Math.abs(b-O)<p)return B.identity(a);d=g-J;f=l-f;J=b-O;var S=1/Math.sqrt(d*d+f*f+J*J);d*=S;f*=S;
J*=S;O=h*J-C*f;C=C*d-A*J;A=A*f-h*d;(S=Math.sqrt(O*O+C*C+A*A))?(S=1/S,O*=S,C*=S,A*=S):A=C=O=0;h=f*A-J*C;var T=J*O-d*A;var V=d*C-f*O;(S=Math.sqrt(h*h+T*T+V*V))?(S=1/S,h*=S,T*=S,V*=S):V=T=h=0;a[0]=O;a[1]=h;a[2]=d;a[3]=0;a[4]=C;a[5]=T;a[6]=f;a[7]=0;a[8]=A;a[9]=V;a[10]=J;a[11]=0;a[12]=-(O*g+C*l+A*b);a[13]=-(h*g+T*l+V*b);a[14]=-(d*g+f*l+J*b);a[15]=1;return a};B.str=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+
", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"};B.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],2)+Math.pow(a[15],2))};"undefined"!==typeof r&&(r.mat4=B);var c={create:function(){var a=new G(4);a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a}};c.rotationTo=
function(){var a=N.create(),b=N.fromValues(1,0,0),d=N.fromValues(0,1,0);return function(f,g,l){var A=N.dot(g,l);if(-.999999>A)return N.cross(a,b,g),1E-6>N.length(a)&&N.cross(a,d,g),N.normalize(a,a),c.setAxisAngle(f,a,Math.PI),f;if(.999999<A)return f[0]=0,f[1]=0,f[2]=0,f[3]=1,f;N.cross(a,g,l);f[0]=a[0];f[1]=a[1];f[2]=a[2];f[3]=1+A;return c.normalize(f,f)}}();c.setAxes=function(){var a=I.create();return function(b,d,f,g){a[0]=f[0];a[3]=f[1];a[6]=f[2];a[1]=g[0];a[4]=g[1];a[7]=g[2];a[2]=-d[0];a[5]=-d[1];
a[8]=-d[2];return c.normalize(b,c.fromMat3(b,a))}}();c.clone=R.clone;c.fromValues=R.fromValues;c.copy=R.copy;c.set=R.set;c.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};c.setAxisAngle=function(a,b,d){d*=.5;var f=Math.sin(d);a[0]=f*b[0];a[1]=f*b[1];a[2]=f*b[2];a[3]=Math.cos(d);return a};c.add=R.add;c.multiply=function(a,b,d){var f=b[0],g=b[1],l=b[2];b=b[3];var A=d[0],h=d[1],C=d[2];d=d[3];a[0]=f*d+b*A+g*C-l*h;a[1]=g*d+b*h+l*A-f*C;a[2]=l*d+b*C+f*h-g*A;a[3]=b*d-f*A-g*h-l*C;return a};c.mul=
c.multiply;c.scale=R.scale;c.rotateX=function(a,b,d){d*=.5;var f=b[0],g=b[1],l=b[2];b=b[3];var A=Math.sin(d);d=Math.cos(d);a[0]=f*d+b*A;a[1]=g*d+l*A;a[2]=l*d-g*A;a[3]=b*d-f*A;return a};c.rotateY=function(a,b,d){d*=.5;var f=b[0],g=b[1],l=b[2];b=b[3];var A=Math.sin(d);d=Math.cos(d);a[0]=f*d-l*A;a[1]=g*d+b*A;a[2]=l*d+f*A;a[3]=b*d-g*A;return a};c.rotateZ=function(a,b,d){d*=.5;var f=b[0],g=b[1],l=b[2];b=b[3];var A=Math.sin(d);d=Math.cos(d);a[0]=f*d+g*A;a[1]=g*d-f*A;a[2]=l*d+b*A;a[3]=b*d-l*A;return a};
c.calculateW=function(a,b){var d=b[0],f=b[1];b=b[2];a[0]=d;a[1]=f;a[2]=b;a[3]=-Math.sqrt(Math.abs(1-d*d-f*f-b*b));return a};c.dot=R.dot;c.lerp=R.lerp;c.slerp=function(a,b,d,f){var g=b[0],l=b[1],A=b[2];b=b[3];var h=d[0],C=d[1],J=d[2];d=d[3];var O=g*h+l*C+A*J+b*d;0>O&&(O=-O,h=-h,C=-C,J=-J,d=-d);if(1E-6<1-O){var S=Math.acos(O);var T=Math.sin(S);O=Math.sin((1-f)*S)/T;f=Math.sin(f*S)/T}else O=1-f;a[0]=O*g+f*h;a[1]=O*l+f*C;a[2]=O*A+f*J;a[3]=O*b+f*d;return a};c.invert=function(a,b){var d=b[0],f=b[1],g=b[2];
b=b[3];var l=d*d+f*f+g*g+b*b;l=l?1/l:0;a[0]=-d*l;a[1]=-f*l;a[2]=-g*l;a[3]=b*l;return a};c.conjugate=function(a,b){a[0]=-b[0];a[1]=-b[1];a[2]=-b[2];a[3]=b[3];return a};c.length=R.length;c.len=c.length;c.squaredLength=R.squaredLength;c.sqrLen=c.squaredLength;c.normalize=R.normalize;c.fromMat3=function(a,b){var d=b[0]+b[4]+b[8];if(0<d)d=Math.sqrt(d+1),a[3]=.5*d,d=.5/d,a[0]=(b[7]-b[5])*d,a[1]=(b[2]-b[6])*d,a[2]=(b[3]-b[1])*d;else{var f=0;b[4]>b[0]&&(f=1);b[8]>b[3*f+f]&&(f=2);var g=(f+1)%3,l=(f+2)%3;d=
Math.sqrt(b[3*f+f]-b[3*g+g]-b[3*l+l]+1);a[f]=.5*d;d=.5/d;a[3]=(b[3*l+g]-b[3*g+l])*d;a[g]=(b[3*g+f]+b[3*f+g])*d;a[l]=(b[3*l+f]+b[3*f+l])*d}return a};c.str=function(a){return"quat("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"};"undefined"!==typeof r&&(r.quat=c)})(m)})(this)},{}],24:[function(e,n,H){(function(){var u=this,m=u._,r={},p=Array.prototype,G=Object.prototype,v=p.push,M=p.slice,E=p.concat,w=G.toString,N=G.hasOwnProperty,R=p.forEach,I=p.map,B=p.reduce,c=p.reduceRight,a=p.filter,b=p.every,d=p.some,
f=p.indexOf,g=p.lastIndexOf;G=Array.isArray;var l=Object.keys,A=Function.prototype.bind,h=function(q){if(q instanceof h)return q;if(!(this instanceof h))return new h(q);this._wrapped=q};"undefined"!==typeof H?("undefined"!==typeof n&&n.exports&&(H=n.exports=h),H._=h):u._=h;h.VERSION="1.4.4";var C=h.each=h.forEach=function(q,F,K){if(null!=q)if(R&&q.forEach===R)q.forEach(F,K);else if(q.length===+q.length)for(var Q=0,W=q.length;Q<W&&F.call(K,q[Q],Q,q)!==r;Q++);else for(Q in q)if(h.has(q,Q)&&F.call(K,
q[Q],Q,q)===r)break};h.map=h.collect=function(q,F,K){var Q=[];if(null==q)return Q;if(I&&q.map===I)return q.map(F,K);C(q,function(W,X,fa){Q[Q.length]=F.call(K,W,X,fa)});return Q};h.reduce=h.foldl=h.inject=function(q,F,K,Q){var W=2<arguments.length;null==q&&(q=[]);if(B&&q.reduce===B)return Q&&(F=h.bind(F,Q)),W?q.reduce(F,K):q.reduce(F);C(q,function(X,fa,ja){W?K=F.call(Q,K,X,fa,ja):(K=X,W=!0)});if(!W)throw new TypeError("Reduce of empty array with no initial value");return K};h.reduceRight=h.foldr=function(q,
F,K,Q){var W=2<arguments.length;null==q&&(q=[]);if(c&&q.reduceRight===c)return Q&&(F=h.bind(F,Q)),W?q.reduceRight(F,K):q.reduceRight(F);var X=q.length;if(X!==+X){var fa=h.keys(q);X=fa.length}C(q,function(ja,ka,pa){ka=fa?fa[--X]:--X;W?K=F.call(Q,K,q[ka],ka,pa):(K=q[ka],W=!0)});if(!W)throw new TypeError("Reduce of empty array with no initial value");return K};h.find=h.detect=function(q,F,K){var Q;J(q,function(W,X,fa){if(F.call(K,W,X,fa))return Q=W,!0});return Q};h.filter=h.select=function(q,F,K){var Q=
[];if(null==q)return Q;if(a&&q.filter===a)return q.filter(F,K);C(q,function(W,X,fa){F.call(K,W,X,fa)&&(Q[Q.length]=W)});return Q};h.reject=function(q,F,K){return h.filter(q,function(Q,W,X){return!F.call(K,Q,W,X)},K)};h.every=h.all=function(q,F,K){F||(F=h.identity);var Q=!0;if(null==q)return Q;if(b&&q.every===b)return q.every(F,K);C(q,function(W,X,fa){if(!(Q=Q&&F.call(K,W,X,fa)))return r});return!!Q};var J=h.some=h.any=function(q,F,K){F||(F=h.identity);var Q=!1;if(null==q)return Q;if(d&&q.some===d)return q.some(F,
K);C(q,function(W,X,fa){if(Q||(Q=F.call(K,W,X,fa)))return r});return!!Q};h.contains=h.include=function(q,F){return null==q?!1:f&&q.indexOf===f?-1!==q.indexOf(F):J(q,function(K){return K===F})};h.invoke=function(q,F){var K=M.call(arguments,2),Q=h.isFunction(F);return h.map(q,function(W){return(Q?F:W[F]).apply(W,K)})};h.pluck=function(q,F){return h.map(q,function(K){return K[F]})};h.where=function(q,F,K){return h.isEmpty(F)?K?null:[]:h[K?"find":"filter"](q,function(Q){for(var W in F)if(F[W]!==Q[W])return!1;
return!0})};h.findWhere=function(q,F){return h.where(q,F,!0)};h.max=function(q,F,K){if(!F&&h.isArray(q)&&q[0]===+q[0]&&65535>q.length)return Math.max.apply(Math,q);if(!F&&h.isEmpty(q))return-Infinity;var Q={computed:-Infinity,value:-Infinity};C(q,function(W,X,fa){X=F?F.call(K,W,X,fa):W;X>=Q.computed&&(Q={value:W,computed:X})});return Q.value};h.min=function(q,F,K){if(!F&&h.isArray(q)&&q[0]===+q[0]&&65535>q.length)return Math.min.apply(Math,q);if(!F&&h.isEmpty(q))return Infinity;var Q={computed:Infinity,
value:Infinity};C(q,function(W,X,fa){X=F?F.call(K,W,X,fa):W;X<Q.computed&&(Q={value:W,computed:X})});return Q.value};h.shuffle=function(q){var F,K=0,Q=[];C(q,function(W){F=h.random(K++);Q[K-1]=Q[F];Q[F]=W});return Q};var O=function(q){return h.isFunction(q)?q:function(F){return F[q]}};h.sortBy=function(q,F,K){var Q=O(F);return h.pluck(h.map(q,function(W,X,fa){return{value:W,index:X,criteria:Q.call(K,W,X,fa)}}).sort(function(W,X){var fa=W.criteria,ja=X.criteria;if(fa!==ja){if(fa>ja||void 0===fa)return 1;
if(fa<ja||void 0===ja)return-1}return W.index<X.index?-1:1}),"value")};var S=function(q,F,K,Q){var W={},X=O(F||h.identity);C(q,function(fa,ja){ja=X.call(K,fa,ja,q);Q(W,ja,fa)});return W};h.groupBy=function(q,F,K){return S(q,F,K,function(Q,W,X){(h.has(Q,W)?Q[W]:Q[W]=[]).push(X)})};h.countBy=function(q,F,K){return S(q,F,K,function(Q,W){h.has(Q,W)||(Q[W]=0);Q[W]++})};h.sortedIndex=function(q,F,K,Q){K=null==K?h.identity:O(K);F=K.call(Q,F);for(var W=0,X=q.length;W<X;){var fa=W+X>>>1;K.call(Q,q[fa])<F?
W=fa+1:X=fa}return W};h.toArray=function(q){return q?h.isArray(q)?M.call(q):q.length===+q.length?h.map(q,h.identity):h.values(q):[]};h.size=function(q){return null==q?0:q.length===+q.length?q.length:h.keys(q).length};h.first=h.head=h.take=function(q,F,K){if(null!=q)return null==F||K?q[0]:M.call(q,0,F)};h.initial=function(q,F,K){return M.call(q,0,q.length-(null==F||K?1:F))};h.last=function(q,F,K){if(null!=q)return null==F||K?q[q.length-1]:M.call(q,Math.max(q.length-F,0))};h.rest=h.tail=h.drop=function(q,
F,K){return M.call(q,null==F||K?1:F)};h.compact=function(q){return h.filter(q,h.identity)};var T=function(q,F,K){C(q,function(Q){h.isArray(Q)?F?v.apply(K,Q):T(Q,F,K):K.push(Q)});return K};h.flatten=function(q,F){return T(q,F,[])};h.without=function(q){return h.difference(q,M.call(arguments,1))};h.uniq=h.unique=function(q,F,K,Q){h.isFunction(F)&&(Q=K,K=F,F=!1);K=K?h.map(q,K,Q):q;var W=[],X=[];C(K,function(fa,ja){(F?ja&&X[X.length-1]===fa:h.contains(X,fa))||(X.push(fa),W.push(q[ja]))});return W};h.union=
function(){return h.uniq(E.apply(p,arguments))};h.intersection=function(q){var F=M.call(arguments,1);return h.filter(h.uniq(q),function(K){return h.every(F,function(Q){return 0<=h.indexOf(Q,K)})})};h.difference=function(q){var F=E.apply(p,M.call(arguments,1));return h.filter(q,function(K){return!h.contains(F,K)})};h.zip=function(){for(var q=M.call(arguments),F=h.max(h.pluck(q,"length")),K=Array(F),Q=0;Q<F;Q++)K[Q]=h.pluck(q,""+Q);return K};h.object=function(q,F){if(null==q)return{};for(var K={},Q=
0,W=q.length;Q<W;Q++)F?K[q[Q]]=F[Q]:K[q[Q][0]]=q[Q][1];return K};h.indexOf=function(q,F,K){if(null==q)return-1;var Q=0,W=q.length;if(K)if("number"==typeof K)Q=0>K?Math.max(0,W+K):K;else return Q=h.sortedIndex(q,F),q[Q]===F?Q:-1;if(f&&q.indexOf===f)return q.indexOf(F,K);for(;Q<W;Q++)if(q[Q]===F)return Q;return-1};h.lastIndexOf=function(q,F,K){if(null==q)return-1;var Q=null!=K;if(g&&q.lastIndexOf===g)return Q?q.lastIndexOf(F,K):q.lastIndexOf(F);for(K=Q?K:q.length;K--;)if(q[K]===F)return K;return-1};
h.range=function(q,F,K){1>=arguments.length&&(F=q||0,q=0);K=arguments[2]||1;for(var Q=Math.max(Math.ceil((F-q)/K),0),W=0,X=Array(Q);W<Q;)X[W++]=q,q+=K;return X};h.bind=function(q,F){if(q.bind===A&&A)return A.apply(q,M.call(arguments,1));var K=M.call(arguments,2);return function(){return q.apply(F,K.concat(M.call(arguments)))}};h.partial=function(q){var F=M.call(arguments,1);return function(){return q.apply(this,F.concat(M.call(arguments)))}};h.bindAll=function(q){var F=M.call(arguments,1);0===F.length&&
(F=h.functions(q));C(F,function(K){q[K]=h.bind(q[K],q)});return q};h.memoize=function(q,F){var K={};F||(F=h.identity);return function(){var Q=F.apply(this,arguments);return h.has(K,Q)?K[Q]:K[Q]=q.apply(this,arguments)}};h.delay=function(q,F){var K=M.call(arguments,2);return setTimeout(function(){return q.apply(null,K)},F)};h.defer=function(q){return h.delay.apply(h,[q,1].concat(M.call(arguments,1)))};h.throttle=function(q,F){var K,Q,W,X,fa=0,ja=function(){fa=new Date;W=null;X=q.apply(K,Q)};return function(){var ka=
new Date,pa=F-(ka-fa);K=this;Q=arguments;0>=pa?(clearTimeout(W),W=null,fa=ka,X=q.apply(K,Q)):W||(W=setTimeout(ja,pa));return X}};h.debounce=function(q,F,K){var Q,W;return function(){var X=this,fa=arguments,ja=K&&!Q;clearTimeout(Q);Q=setTimeout(function(){Q=null;K||(W=q.apply(X,fa))},F);ja&&(W=q.apply(X,fa));return W}};h.once=function(q){var F=!1,K;return function(){if(F)return K;F=!0;K=q.apply(this,arguments);q=null;return K}};h.wrap=function(q,F){return function(){var K=[q];v.apply(K,arguments);
return F.apply(this,K)}};h.compose=function(){var q=arguments;return function(){for(var F=arguments,K=q.length-1;0<=K;K--)F=[q[K].apply(this,F)];return F[0]}};h.after=function(q,F){return 0>=q?F():function(){if(1>--q)return F.apply(this,arguments)}};h.keys=l||function(q){if(q!==Object(q))throw new TypeError("Invalid object");var F=[],K;for(K in q)h.has(q,K)&&(F[F.length]=K);return F};h.values=function(q){var F=[],K;for(K in q)h.has(q,K)&&F.push(q[K]);return F};h.pairs=function(q){var F=[],K;for(K in q)h.has(q,
K)&&F.push([K,q[K]]);return F};h.invert=function(q){var F={},K;for(K in q)h.has(q,K)&&(F[q[K]]=K);return F};h.functions=h.methods=function(q){var F=[],K;for(K in q)h.isFunction(q[K])&&F.push(K);return F.sort()};h.extend=function(q){C(M.call(arguments,1),function(F){if(F)for(var K in F)q[K]=F[K]});return q};h.pick=function(q){var F={},K=E.apply(p,M.call(arguments,1));C(K,function(Q){Q in q&&(F[Q]=q[Q])});return F};h.omit=function(q){var F={},K=E.apply(p,M.call(arguments,1)),Q;for(Q in q)h.contains(K,
Q)||(F[Q]=q[Q]);return F};h.defaults=function(q){C(M.call(arguments,1),function(F){if(F)for(var K in F)null==q[K]&&(q[K]=F[K])});return q};h.clone=function(q){return h.isObject(q)?h.isArray(q)?q.slice():h.extend({},q):q};h.tap=function(q,F){F(q);return q};var V=function(q,F,K,Q){if(q===F)return 0!==q||1/q==1/F;if(null==q||null==F)return q===F;q instanceof h&&(q=q._wrapped);F instanceof h&&(F=F._wrapped);var W=w.call(q);if(W!=w.call(F))return!1;switch(W){case "[object String]":return q==String(F);
case "[object Number]":return q!=+q?F!=+F:0==q?1/q==1/F:q==+F;case "[object Date]":case "[object Boolean]":return+q==+F;case "[object RegExp]":return q.source==F.source&&q.global==F.global&&q.multiline==F.multiline&&q.ignoreCase==F.ignoreCase}if("object"!=typeof q||"object"!=typeof F)return!1;for(var X=K.length;X--;)if(K[X]==q)return Q[X]==F;K.push(q);Q.push(F);X=0;var fa=!0;if("[object Array]"==W){if(X=q.length,fa=X==F.length)for(;X--&&(fa=V(q[X],F[X],K,Q)););}else{W=q.constructor;var ja=F.constructor;
if(W!==ja&&!(h.isFunction(W)&&W instanceof W&&h.isFunction(ja)&&ja instanceof ja))return!1;for(var ka in q)if(h.has(q,ka)&&(X++,!(fa=h.has(F,ka)&&V(q[ka],F[ka],K,Q))))break;if(fa){for(ka in F)if(h.has(F,ka)&&!X--)break;fa=!X}}K.pop();Q.pop();return fa};h.isEqual=function(q,F){return V(q,F,[],[])};h.isEmpty=function(q){if(null==q)return!0;if(h.isArray(q)||h.isString(q))return 0===q.length;for(var F in q)if(h.has(q,F))return!1;return!0};h.isElement=function(q){return!(!q||1!==q.nodeType)};h.isArray=
G||function(q){return"[object Array]"==w.call(q)};h.isObject=function(q){return q===Object(q)};C("Arguments Function String Number Date RegExp".split(" "),function(q){h["is"+q]=function(F){return w.call(F)=="[object "+q+"]"}});h.isArguments(arguments)||(h.isArguments=function(q){return!(!q||!h.has(q,"callee"))});"function"!==typeof/./&&(h.isFunction=function(q){return"function"===typeof q});h.isFinite=function(q){return isFinite(q)&&!isNaN(parseFloat(q))};h.isNaN=function(q){return h.isNumber(q)&&
q!=+q};h.isBoolean=function(q){return!0===q||!1===q||"[object Boolean]"==w.call(q)};h.isNull=function(q){return null===q};h.isUndefined=function(q){return void 0===q};h.has=function(q,F){return N.call(q,F)};h.noConflict=function(){u._=m;return this};h.identity=function(q){return q};h.times=function(q,F,K){for(var Q=Array(q),W=0;W<q;W++)Q[W]=F.call(K,W);return Q};h.random=function(q,F){null==F&&(F=q,q=0);return q+Math.floor(Math.random()*(F-q+1))};var Z={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;",
"'":"&#x27;","/":"&#x2F;"}};Z.unescape=h.invert(Z.escape);var Y={escape:new RegExp("["+h.keys(Z.escape).join("")+"]","g"),unescape:new RegExp("("+h.keys(Z.unescape).join("|")+")","g")};h.each(["escape","unescape"],function(q){h[q]=function(F){return null==F?"":(""+F).replace(Y[q],function(K){return Z[q][K]})}});h.result=function(q,F){if(null==q)return null;F=q[F];return h.isFunction(F)?F.call(q):F};h.mixin=function(q){C(h.functions(q),function(F){var K=h[F]=q[F];h.prototype[F]=function(){var Q=[this._wrapped];
v.apply(Q,arguments);return ca.call(this,K.apply(h,Q))}})};var da=0;h.uniqueId=function(q){var F=++da+"";return q?q+F:F};h.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var ia=/(.)^/,ba={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},ea=/\\|'|\r|\n|\t|\u2028|\u2029/g;h.template=function(q,F,K){K=h.defaults({},K,h.templateSettings);var Q=new RegExp([(K.escape||ia).source,(K.interpolate||ia).source,(K.evaluate||
ia).source].join("|")+"|$","g"),W=0,X="__p+='";q.replace(Q,function(ja,ka,pa,wa,Ba){X+=q.slice(W,Ba).replace(ea,function(Ga){return"\\"+ba[Ga]});ka&&(X+="'+\n((__t=("+ka+"))==null?'':_.escape(__t))+\n'");pa&&(X+="'+\n((__t=("+pa+"))==null?'':__t)+\n'");wa&&(X+="';\n"+wa+"\n__p+='");W=Ba+ja.length;return ja});X+="';\n";K.variable||(X="with(obj||{}){\n"+X+"}\n");X="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+X+"return __p;\n";try{var fa=new Function(K.variable||
"obj","_",X)}catch(ja){throw ja.source=X,ja;}if(F)return fa(F,h);F=function(ja){return fa.call(this,ja,h)};F.source="function("+(K.variable||"obj")+"){\n"+X+"}";return F};h.chain=function(q){return h(q).chain()};var ca=function(q){return this._chain?h(q).chain():q};h.mixin(h);C("pop push reverse shift sort splice unshift".split(" "),function(q){var F=p[q];h.prototype[q]=function(){var K=this._wrapped;F.apply(K,arguments);"shift"!=q&&"splice"!=q||0!==K.length||delete K[0];return ca.call(this,K)}});
C(["concat","join","slice"],function(q){var F=p[q];h.prototype[q]=function(){return ca.call(this,F.apply(this._wrapped,arguments))}});h.extend(h.prototype,{chain:function(){this._chain=!0;return this},value:function(){return this._wrapped}})}).call(this)},{}],25:[function(e,n,H){"undefined"!==typeof window&&"function"!==typeof window.requestAnimationFrame&&(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||
function(u){setTimeout(u,1E3/60)});Leap=e("../lib/index")},{"../lib/index":11}]},{},[25]);
}).call(this);//# sourceMappingURL=CindyLeap.js.map

